

============================== 2022-05-09 17:08:29.974946 | 80990d03-8f3e-42a4-a48e-69d481358458 ==============================
17:08:29.974946 [info ] [MainThread]: Running with dbt=1.1.0
17:08:29.985787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:08:29.986289 [debug] [MainThread]: Tracking: tracking
17:08:29.987656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD36C08B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD36C0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD36C08E0>]}
17:08:29.991819 [debug] [MainThread]: Set downloads directory='C:\Users\a833122\AppData\Local\Temp\dbt-downloads-7t23nodk'
17:08:29.991819 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:08:30.212708 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:08:30.212708 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
17:08:30.325952 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
17:08:30.341455 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:08:30.466221 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:08:30.513596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD370C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD370C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD370C100>]}


============================== 2022-05-09 17:09:52.612256 | 20ca3ea5-546d-48c3-9ed9-ff3a185400f3 ==============================
17:09:52.612256 [info ] [MainThread]: Running with dbt=1.1.0
17:09:52.612256 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:09:52.612256 [debug] [MainThread]: Tracking: tracking
17:09:52.618097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAC08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAC09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAC0970>]}
17:09:52.620868 [debug] [MainThread]: Set downloads directory='C:\Users\a833122\AppData\Local\Temp\dbt-downloads-wiarr8on'
17:09:52.620868 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:09:52.803639 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:09:52.803639 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
17:09:52.943758 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
17:09:52.952330 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:09:53.082848 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:09:53.129639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAFE100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAFE130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518CAFE190>]}


============================== 2022-05-09 17:18:48.187958 | 46b50234-4fed-48d0-9630-98f753dc6dd9 ==============================
17:18:48.187958 [info ] [MainThread]: Running with dbt=1.1.0
17:18:48.187958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'datavault', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
17:18:48.187958 [debug] [MainThread]: Tracking: tracking
17:18:48.187958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3D640>]}
17:18:48.187958 [info ] [MainThread]: Setting up your profile.
17:18:48.187958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC3DD90>]}


============================== 2022-05-09 17:31:01.097718 | e3b8085c-4dca-4d7d-b318-b87e8bf1ca13 ==============================
17:31:01.097718 [info ] [MainThread]: Running with dbt=1.1.0
17:31:01.097718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:31:01.105746 [debug] [MainThread]: Tracking: tracking
17:31:01.105746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E0F9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E0F9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E0F9A90>]}
17:31:01.105746 [debug] [MainThread]: Set downloads directory='C:\Users\a833122\AppData\Local\Temp\dbt-downloads-lcwl4pex'
17:31:01.105746 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:31:01.541038 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:31:01.541038 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
17:31:01.662184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
17:31:01.662184 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:31:01.778535 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:31:01.851008 [info ] [MainThread]: Installing Datavault-UK/dbtvault
17:31:02.434598 [info ] [MainThread]:   Installed from version 0.8.2
17:31:02.434598 [info ] [MainThread]:   Up to date!
17:31:02.445446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3b8085c-4dca-4d7d-b318-b87e8bf1ca13', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E0F9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E0F9CD0>]}
17:31:02.445446 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:31:03.245388 [info ] [MainThread]:   Installed from version 0.8.4
17:31:03.245388 [info ] [MainThread]:   Up to date!
17:31:03.260348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3b8085c-4dca-4d7d-b318-b87e8bf1ca13', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E107DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E1078E0>]}
17:31:03.262157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E080CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E03AE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22E022F70>]}


============================== 2022-05-09 17:31:42.898546 | 8a182d1c-3b91-4924-b004-aa057f712b9f ==============================
17:31:42.898546 [info ] [MainThread]: Running with dbt=1.1.0
17:31:42.898546 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:31:42.898546 [debug] [MainThread]: Tracking: tracking
17:31:42.898546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C6F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C6F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C6FF10>]}
17:31:42.969423 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
17:31:42.977473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C57580>]}
17:31:44.610090 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
17:31:44.610090 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
17:31:44.610090 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
17:31:44.625857 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
17:31:44.625857 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
17:31:44.625857 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
17:31:44.625857 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
17:31:44.625857 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
17:31:44.641683 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
17:31:44.641683 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
17:31:44.641683 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
17:31:44.658222 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
17:31:44.658222 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
17:31:44.658222 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
17:31:44.658222 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
17:31:44.674612 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
17:31:44.674612 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
17:31:44.693130 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
17:31:44.712288 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
17:31:44.728052 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
17:31:44.728052 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
17:31:44.728052 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
17:31:44.728052 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
17:31:44.743793 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
17:31:44.743793 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
17:31:44.760072 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
17:31:44.760072 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
17:31:44.760072 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
17:31:44.760072 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
17:31:44.776614 [debug] [MainThread]: Parsing macros\staging\stage.sql
17:31:44.776614 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
17:31:44.776614 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
17:31:44.776614 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
17:31:44.776614 [debug] [MainThread]: Parsing macros\supporting\hash.sql
17:31:44.792880 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
17:31:44.792880 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
17:31:44.808624 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
17:31:44.808624 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
17:31:44.824148 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
17:31:44.824148 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
17:31:44.840415 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
17:31:44.856225 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
17:31:44.856225 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
17:31:44.856225 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
17:31:44.856225 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
17:31:44.856225 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
17:31:44.887465 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
17:31:44.887465 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
17:31:44.903091 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
17:31:44.919929 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
17:31:44.928049 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
17:31:44.944033 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
17:31:44.951942 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
17:31:44.951942 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
17:31:44.971412 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
17:31:44.971412 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
17:31:44.987207 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
17:31:44.987207 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
17:31:45.034097 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
17:31:45.034097 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
17:31:45.034097 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
17:31:45.034097 [debug] [MainThread]: Parsing macros\adapters.sql
17:31:45.065560 [debug] [MainThread]: Parsing macros\catalog.sql
17:31:45.065560 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\materializations\merge.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\materializations\seed.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\materializations\table.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\materializations\view.sql
17:31:45.081190 [debug] [MainThread]: Parsing macros\adapters\columns.sql
17:31:45.096814 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
17:31:45.096814 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
17:31:45.096814 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
17:31:45.096814 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
17:31:45.112446 [debug] [MainThread]: Parsing macros\adapters\relation.sql
17:31:45.112446 [debug] [MainThread]: Parsing macros\adapters\schema.sql
17:31:45.112446 [debug] [MainThread]: Parsing macros\etc\datetime.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\etc\statement.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\materializations\configs.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
17:31:45.128064 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
17:31:45.143816 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
17:31:45.143816 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
17:31:45.143816 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
17:31:45.159550 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
17:31:45.159550 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
17:31:45.175171 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
17:31:45.175171 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
17:31:45.175171 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
17:31:45.175171 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
17:31:45.190800 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
17:31:45.190800 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
17:31:45.206425 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
17:31:45.206425 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
17:31:45.222050 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
17:31:45.222050 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
17:31:45.222050 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
17:31:45.237699 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
17:31:45.237699 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
17:31:45.237699 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
17:31:45.237699 [debug] [MainThread]: Parsing tests\generic\builtin.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
17:31:45.253583 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
17:31:45.269257 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
17:31:45.269257 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
17:31:45.269257 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
17:31:45.269257 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
17:31:45.269257 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
17:31:45.285382 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
17:31:45.285382 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
17:31:45.285382 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
17:31:45.285382 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
17:31:45.301411 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
17:31:45.301411 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
17:31:45.317440 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
17:31:45.317440 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
17:31:45.333570 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
17:31:45.333570 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
17:31:45.333570 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
17:31:45.333570 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
17:31:45.350236 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
17:31:45.350236 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
17:31:45.350236 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
17:31:45.350236 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
17:31:45.350236 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
17:31:45.366288 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
17:31:45.366288 [debug] [MainThread]: Parsing macros\staging\stage.sql
17:31:45.366288 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
17:31:45.381904 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
17:31:45.381904 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
17:31:45.381904 [debug] [MainThread]: Parsing macros\supporting\hash.sql
17:31:45.397527 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
17:31:45.397527 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
17:31:45.397527 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
17:31:45.413151 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
17:31:45.413151 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
17:31:45.428772 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
17:31:45.428772 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
17:31:45.445586 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
17:31:45.453733 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
17:31:45.453733 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
17:31:45.453733 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
17:31:45.453733 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
17:31:45.486788 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
17:31:45.498908 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
17:31:45.508028 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
17:31:45.518353 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
17:31:45.519463 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
17:31:45.535230 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
17:31:45.550732 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
17:31:45.550732 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
17:31:45.566458 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
17:31:45.566458 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
17:31:45.582458 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
17:31:45.582458 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
17:31:45.598226 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
17:31:45.614680 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
17:31:45.614680 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
17:31:45.614680 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
17:31:45.614680 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
17:31:45.614680 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
17:31:45.630346 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
17:31:45.630346 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
17:31:45.630346 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
17:31:45.630346 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
17:31:45.630346 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
17:31:45.646447 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
17:31:45.663465 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
17:31:45.679256 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
17:31:45.679754 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
17:31:45.695581 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
17:31:45.711197 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
17:31:45.711197 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
17:31:45.711197 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
17:31:45.731011 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
17:31:45.735750 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
17:31:45.739088 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
17:31:45.743382 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
17:31:45.747767 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
17:31:45.750031 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
17:31:45.752311 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\groupby.sql
17:31:45.755626 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\pivot.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\star.sql
17:31:45.772170 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
17:31:45.785654 [debug] [MainThread]: Parsing macros\sql\union.sql
17:31:45.788349 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
17:31:45.788349 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
17:31:45.788349 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
17:31:45.788349 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
17:31:46.672296 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\raw_inventory.sql
17:31:46.688434 [debug] [MainThread]: 1603: static parser failed on raw_stage\raw_orders.sql
17:31:46.688434 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage\raw_orders.sql
17:31:46.688434 [debug] [MainThread]: 1603: static parser failed on raw_stage\raw_transactions.sql
17:31:46.688434 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_stage\raw_transactions.sql
17:31:46.688434 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
17:31:46.768501 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
17:31:46.768501 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_lineitem.sql
17:31:46.784137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_lineitem.sql
17:31:46.784137 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_nation.sql
17:31:46.784137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_nation.sql
17:31:46.784137 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
17:31:46.801559 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
17:31:46.801559 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_part.sql
17:31:46.810351 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_part.sql
17:31:46.810351 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_region.sql
17:31:46.810351 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_region.sql
17:31:46.810351 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_supplier.sql
17:31:46.826463 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_supplier.sql
17:31:46.826463 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_nation.sql
17:31:46.858053 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_nation.sql
17:31:46.858053 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
17:31:46.874052 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
17:31:46.874052 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_inventory.sql
17:31:46.874052 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_inventory.sql
17:31:46.874052 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_inventory_allocation.sql
17:31:46.890005 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_inventory_allocation.sql
17:31:46.890005 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_nation_region.sql
17:31:46.890005 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_nation_region.sql
17:31:46.890005 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_order_lineitem.sql
17:31:46.906258 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_order_lineitem.sql
17:31:46.906258 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_supplier_nation.sql
17:31:46.906258 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_supplier_nation.sql
17:31:46.906258 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_inv_inventory_details.sql
17:31:46.937919 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_inv_inventory_details.sql
17:31:46.937919 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_inv_part_details.sql
17:31:46.953662 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_inv_part_details.sql
17:31:46.953662 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_inv_supplier_details.sql
17:31:46.969295 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_inv_supplier_details.sql
17:31:46.969295 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_inv_supp_nation_details.sql
17:31:46.984915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_inv_supp_nation_details.sql
17:31:46.984915 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_inv_supp_region_details.sql
17:31:46.984915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_inv_supp_region_details.sql
17:31:46.984915 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order_customer_details.sql
17:31:47.000541 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order_customer_details.sql
17:31:47.000541 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order_cust_nation_details.sql
17:31:47.060999 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order_cust_nation_details.sql
17:31:47.062141 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order_cust_region_details.sql
17:31:47.069006 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order_cust_region_details.sql
17:31:47.069006 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order_lineitem_details.sql
17:31:47.085207 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order_lineitem_details.sql
17:31:47.085207 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order_order_details.sql
17:31:47.101209 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order_order_details.sql
17:31:47.101209 [debug] [MainThread]: 1603: static parser failed on raw_vault\t_links\t_link_transactions.sql
17:31:47.116995 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\t_links\t_link_transactions.sql
17:31:47.116995 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_inventory.sql
17:31:47.227213 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_inventory.sql
17:31:47.227213 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_orders.sql
17:31:47.324958 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_orders.sql
17:31:47.332957 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_transactions.sql
17:31:47.360319 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_transactions.sql
17:31:47.464895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B50A9FD0>]}
17:31:47.486284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C6F940>]}
17:31:47.486284 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
17:31:47.486284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B4C575E0>]}
17:31:47.493233 [info ] [MainThread]: 
17:31:47.493233 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:31:47.497333 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
17:31:47.511698 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
17:31:47.511698 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
17:31:47.511698 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:31:48.700980 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.19 seconds
17:31:48.716659 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
17:31:48.858959 [debug] [ThreadPool]: Acquiring new snowflake connection "create_DV_PROTOTYPE_DB_DEMO"
17:31:48.858959 [debug] [ThreadPool]: Acquiring new snowflake connection "create_DV_PROTOTYPE_DB_DEMO"
17:31:48.858959 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dv_prototype_db', schema='demo', identifier=None)"
17:31:48.874439 [debug] [ThreadPool]: Using snowflake connection "create_DV_PROTOTYPE_DB_DEMO"
17:31:48.874439 [debug] [ThreadPool]: On create_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "create_DV_PROTOTYPE_DB_DEMO"} */
create schema if not exists DV_PROTOTYPE_DB.DEMO
17:31:48.874439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:31:49.436256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.56 seconds
17:31:49.436256 [debug] [ThreadPool]: On create_DV_PROTOTYPE_DB_DEMO: Close
17:31:49.598659 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
17:31:49.598659 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
17:31:49.598659 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
17:31:49.598659 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:31:50.045635 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.45 seconds
17:31:50.045635 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
17:31:50.258801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B6379850>]}
17:31:50.258801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
17:31:50.258801 [info ] [MainThread]: 
17:31:50.308838 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
17:31:50.308838 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
17:31:50.308838 [info ] [Thread-1  ]: 1 of 3 START view model DEMO.raw_orders ........................................ [RUN]
17:31:50.308838 [info ] [Thread-2  ]: 2 of 3 START view model DEMO.raw_transactions .................................. [RUN]
17:31:50.308838 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
17:31:50.308838 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
17:31:50.308838 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
17:31:50.316953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
17:31:50.325343 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
17:31:50.325343 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
17:31:50.325343 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
17:31:50.325343 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
17:31:50.333994 [debug] [Thread-1  ]: finished collecting timing info
17:31:50.333994 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
17:31:50.367004 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
17:31:50.367004 [debug] [Thread-2  ]: finished collecting timing info
17:31:50.367004 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
17:31:50.375736 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
17:31:50.380691 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
17:31:50.380691 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
17:31:50.380691 [debug] [Thread-1  ]: Opening a new connection, currently in state init
17:31:50.380691 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
17:31:50.380691 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
17:31:50.380691 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:31:51.176454 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.8 seconds
17:31:51.192039 [debug] [Thread-2  ]: finished collecting timing info
17:31:51.192039 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
17:31:51.238825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
17:31:51.238825 [debug] [Thread-1  ]: finished collecting timing info
17:31:51.238825 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
17:31:51.335894 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B63CD790>]}
17:31:51.335894 [info ] [Thread-2  ]: 2 of 3 OK created view model DEMO.raw_transactions ............................. [[32mSUCCESS 1[0m in 1.01s]
17:31:51.335894 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
17:31:51.387580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B6411D00>]}
17:31:51.387580 [info ] [Thread-1  ]: 1 of 3 OK created view model DEMO.raw_orders ................................... [[32mSUCCESS 1[0m in 1.08s]
17:31:51.395527 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
17:31:51.395527 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
17:31:51.395527 [info ] [Thread-4  ]: 3 of 3 START view model DEMO.raw_inventory ..................................... [RUN]
17:31:51.395527 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
17:31:51.395527 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
17:31:51.395527 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
17:31:51.403471 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
17:31:51.442273 [debug] [Thread-4  ]: finished collecting timing info
17:31:51.442273 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
17:31:51.442273 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
17:31:51.450745 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
17:31:51.450745 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
17:31:51.450745 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:31:52.315714 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.86 seconds
17:31:52.326521 [debug] [Thread-4  ]: finished collecting timing info
17:31:52.326521 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
17:31:52.482827 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a182d1c-3b91-4924-b004-aa057f712b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B64151F0>]}
17:31:52.482827 [info ] [Thread-4  ]: 3 of 3 OK created view model DEMO.raw_inventory ................................ [[32mSUCCESS 1[0m in 1.09s]
17:31:52.482827 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
17:31:52.497732 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:31:52.497732 [info ] [MainThread]: 
17:31:52.497732 [info ] [MainThread]: Finished running 3 view models in 5.00s.
17:31:52.497732 [debug] [MainThread]: Connection 'master' was properly closed.
17:31:52.497732 [debug] [MainThread]: Connection 'create_DV_PROTOTYPE_DB_DEMO' was properly closed.
17:31:52.501705 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
17:31:52.501926 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_orders' was properly closed.
17:31:52.501926 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_transactions' was properly closed.
17:31:52.501926 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_inventory' was properly closed.
17:31:52.502807 [info ] [MainThread]: 
17:31:52.516956 [info ] [MainThread]: [32mCompleted successfully[0m
17:31:52.516956 [info ] [MainThread]: 
17:31:52.519812 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:31:52.519812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B6391E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B63B6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146B64080D0>]}


============================== 2022-05-10 02:29:08.521748 | b18a7cf8-c8d6-4872-bd14-58e1cda8565a ==============================
02:29:08.521748 [info ] [MainThread]: Running with dbt=1.1.0
02:29:08.522767 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['+tag:stage'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:29:08.523661 [debug] [MainThread]: Tracking: tracking
02:29:08.524664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA340F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA340F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA340E50>]}
02:29:10.752364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:29:10.752364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:29:10.767997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA3DEF70>]}
02:29:10.814814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA2C7550>]}
02:29:10.814814 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
02:29:10.814814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA2DC970>]}
02:29:10.821849 [info ] [MainThread]: 
02:29:10.822405 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:29:10.823885 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
02:29:10.829063 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
02:29:10.829063 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
02:29:10.829063 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:29:11.834292 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.01 seconds
02:29:11.839310 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
02:29:12.004125 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
02:29:12.004125 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
02:29:12.004125 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
02:29:12.004125 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:29:12.546387 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.54 seconds
02:29:12.546387 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
02:29:12.672826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA3DF5E0>]}
02:29:12.688334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
02:29:12.688334 [info ] [MainThread]: 
02:29:12.711023 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
02:29:12.712036 [info ] [Thread-1  ]: 1 of 6 START view model DEMO.raw_orders ........................................ [RUN]
02:29:12.712036 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
02:29:12.712036 [info ] [Thread-2  ]: 2 of 6 START view model DEMO.raw_transactions .................................. [RUN]
02:29:12.713022 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
02:29:12.714021 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
02:29:12.714021 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
02:29:12.720047 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
02:29:12.720047 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
02:29:12.720047 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
02:29:12.721020 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
02:29:12.726020 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
02:29:12.727021 [debug] [Thread-1  ]: finished collecting timing info
02:29:12.728023 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
02:29:12.750118 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
02:29:12.750118 [debug] [Thread-2  ]: finished collecting timing info
02:29:12.751019 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
02:29:12.753019 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
02:29:12.757019 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
02:29:12.758019 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
02:29:12.758703 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
02:29:12.758703 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
02:29:12.759713 [debug] [Thread-1  ]: Opening a new connection, currently in state init
02:29:12.759713 [debug] [Thread-2  ]: Opening a new connection, currently in state init
02:29:13.321524 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
02:29:13.321524 [debug] [Thread-2  ]: finished collecting timing info
02:29:13.321524 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
02:29:13.321524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
02:29:13.337254 [debug] [Thread-1  ]: finished collecting timing info
02:29:13.337254 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
02:29:13.491029 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA8E5310>]}
02:29:13.491530 [info ] [Thread-1  ]: 1 of 6 OK created view model DEMO.raw_orders ................................... [[32mSUCCESS 1[0m in 0.76s]
02:29:13.491530 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA918730>]}
02:29:13.491530 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
02:29:13.491530 [info ] [Thread-2  ]: 2 of 6 OK created view model DEMO.raw_transactions ............................. [[32mSUCCESS 1[0m in 0.77s]
02:29:13.495236 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
02:29:13.495236 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
02:29:13.496118 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
02:29:13.496321 [info ] [Thread-4  ]: 3 of 6 START view model DEMO.raw_inventory ..................................... [RUN]
02:29:13.496727 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
02:29:13.496727 [info ] [Thread-3  ]: 4 of 6 START view model DEMO.v_stg_orders ...................................... [RUN]
02:29:13.497741 [info ] [Thread-1  ]: 5 of 6 START view model DEMO.v_stg_transactions ................................ [RUN]
02:29:13.497741 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
02:29:13.498742 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:13.498742 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
02:29:13.498742 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
02:29:13.499742 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:13.499742 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
02:29:13.499742 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
02:29:13.500745 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
02:29:13.531976 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
02:29:13.531976 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
02:29:13.539031 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:13.546948 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:13.546948 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
02:29:13.547955 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
02:29:13.547955 [debug] [Thread-3  ]: Opening a new connection, currently in state init
02:29:13.547955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:29:13.550946 [debug] [Thread-4  ]: finished collecting timing info
02:29:13.550946 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
02:29:13.554049 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
02:29:13.557962 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
02:29:13.558950 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
02:29:13.558950 [debug] [Thread-4  ]: Opening a new connection, currently in state init
02:29:14.009806 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.46 seconds
02:29:14.042846 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.49 seconds
02:29:14.074762 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:14.074762 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
02:29:14.090395 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:14.090395 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
02:29:14.201897 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.11 seconds
02:29:14.207259 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.13 seconds
02:29:14.277488 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:14.340320 [debug] [Thread-1  ]: finished collecting timing info
02:29:14.361571 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.8 seconds
02:29:14.361571 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:14.361571 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
02:29:14.361571 [debug] [Thread-4  ]: finished collecting timing info
02:29:14.377735 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:14.377735 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
02:29:14.377735 [debug] [Thread-3  ]: finished collecting timing info
02:29:14.377735 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
02:29:14.377735 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:14.393494 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
02:29:14.393494 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
02:29:14.393494 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
02:29:14.393494 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
02:29:14.523553 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA9557F0>]}
02:29:14.524578 [info ] [Thread-4  ]: 3 of 6 OK created view model DEMO.raw_inventory ................................ [[32mSUCCESS 1[0m in 1.03s]
02:29:14.524578 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
02:29:14.524578 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
02:29:14.526383 [info ] [Thread-2  ]: 6 of 6 START view model DEMO.v_stg_inventory ................................... [RUN]
02:29:14.527698 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:14.527803 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
02:29:14.528176 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
02:29:14.538283 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:14.538283 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
02:29:14.538283 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
02:29:14.596963 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
02:29:14.598020 [debug] [Thread-1  ]: finished collecting timing info
02:29:14.598020 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
02:29:14.693833 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.3 seconds
02:29:14.693833 [debug] [Thread-3  ]: finished collecting timing info
02:29:14.693833 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
02:29:14.740763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA97D7C0>]}
02:29:14.746802 [info ] [Thread-1  ]: 5 of 6 OK created view model DEMO.v_stg_transactions ........................... [[32mSUCCESS 1[0m in 1.24s]
02:29:14.746802 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
02:29:14.852669 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA97DDF0>]}
02:29:14.852669 [info ] [Thread-3  ]: 4 of 6 OK created view model DEMO.v_stg_orders ................................. [[32mSUCCESS 1[0m in 1.35s]
02:29:14.853694 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
02:29:15.210066 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.67 seconds
02:29:15.225679 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:15.225679 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
02:29:15.339113 [debug] [Thread-2  ]: SQL status: SUCCESS 24 in 0.11 seconds
02:29:15.447165 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:15.458600 [debug] [Thread-2  ]: finished collecting timing info
02:29:15.458600 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
02:29:15.458600 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:15.458600 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
02:29:15.458600 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
02:29:15.770229 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.31 seconds
02:29:15.771336 [debug] [Thread-2  ]: finished collecting timing info
02:29:15.772322 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
02:29:15.912807 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18a7cf8-c8d6-4872-bd14-58e1cda8565a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFBB043A0>]}
02:29:15.912807 [info ] [Thread-2  ]: 6 of 6 OK created view model DEMO.v_stg_inventory .............................. [[32mSUCCESS 1[0m in 1.39s]
02:29:15.912807 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
02:29:15.918084 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:29:15.918084 [info ] [MainThread]: 
02:29:15.919088 [info ] [MainThread]: Finished running 6 view models in 5.10s.
02:29:15.919475 [debug] [MainThread]: Connection 'master' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_transactions' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_inventory' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.raw_inventory' was properly closed.
02:29:15.919475 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.v_stg_orders' was properly closed.
02:29:15.939714 [info ] [MainThread]: 
02:29:15.940616 [info ] [MainThread]: [32mCompleted successfully[0m
02:29:15.941623 [info ] [MainThread]: 
02:29:15.942922 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
02:29:15.944252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFAA30FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFAA300D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFAA30DF0>]}


============================== 2022-05-10 05:06:13.222041 | 3937bc13-6712-441e-b55c-cfbace8da5ca ==============================
05:06:13.222041 [info ] [MainThread]: Running with dbt=1.1.0
05:06:13.222041 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:06:13.222041 [debug] [MainThread]: Tracking: tracking
05:06:13.222041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076877DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076877B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076877AF0>]}
05:06:14.968430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:06:14.968430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:06:14.974027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002407692DF40>]}
05:06:15.040018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076816610>]}
05:06:15.045326 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
05:06:15.045326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076820220>]}
05:06:15.048766 [info ] [MainThread]: 
05:06:15.049098 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:06:15.054857 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
05:06:15.061877 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
05:06:15.061877 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
05:06:15.061877 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:06:16.095590 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.03 seconds
05:06:16.111392 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
05:06:16.305620 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:06:16.321387 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:06:16.321387 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
05:06:16.321387 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:06:16.816629 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.5 seconds
05:06:16.816629 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
05:06:16.963145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076842D60>]}
05:06:16.963145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
05:06:16.963145 [info ] [MainThread]: 
05:06:16.976501 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
05:06:16.976501 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
05:06:16.976501 [info ] [Thread-1  ]: 1 of 7 START incremental model DEMO.hub_customer ............................... [RUN]
05:06:16.976501 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
05:06:16.976501 [info ] [Thread-2  ]: 2 of 7 START incremental model DEMO.hub_lineitem ............................... [RUN]
05:06:16.976501 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
05:06:16.976501 [info ] [Thread-3  ]: 3 of 7 START incremental model DEMO.hub_nation ................................. [RUN]
05:06:16.987360 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
05:06:16.988368 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
05:06:16.989566 [info ] [Thread-4  ]: 4 of 7 START incremental model DEMO.hub_order .................................. [RUN]
05:06:16.990854 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
05:06:16.992304 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
05:06:16.992304 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
05:06:16.993303 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
05:06:16.994513 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
05:06:16.994513 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
05:06:16.994513 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
05:06:17.031418 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
05:06:17.066693 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
05:06:17.066693 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_order
05:06:17.153426 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
05:06:17.167608 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
05:06:17.167608 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
05:06:17.178988 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
05:06:17.182045 [debug] [Thread-2  ]: finished collecting timing info
05:06:17.182045 [debug] [Thread-1  ]: finished collecting timing info
05:06:17.182545 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
05:06:17.183045 [debug] [Thread-4  ]: finished collecting timing info
05:06:17.183045 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
05:06:17.183545 [debug] [Thread-3  ]: finished collecting timing info
05:06:17.231827 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
05:06:17.232323 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
05:06:17.232323 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
05:06:17.232323 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
05:06:17.232323 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
05:06:17.232323 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
05:06:17.251643 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
05:06:17.251643 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:06:17.253427 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
05:06:17.254572 [debug] [Thread-2  ]: Opening a new connection, currently in state init
05:06:17.254572 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
05:06:17.254572 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:06:17.254572 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
05:06:17.254572 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:06:17.254572 [debug] [Thread-1  ]: Opening a new connection, currently in state init
05:06:17.254572 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:06:17.254572 [debug] [Thread-4  ]: Opening a new connection, currently in state init
05:06:17.254572 [debug] [Thread-3  ]: Opening a new connection, currently in state init
05:06:23.047606 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.79 seconds
05:06:23.063166 [debug] [Thread-4  ]: finished collecting timing info
05:06:23.063166 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.81 seconds
05:06:23.063166 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
05:06:23.078975 [debug] [Thread-1  ]: finished collecting timing info
05:06:23.081711 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
05:06:23.235183 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076E2FC70>]}
05:06:23.235183 [info ] [Thread-4  ]: 4 of 7 OK created incremental model DEMO.hub_order ............................. [[32mSUCCESS 1[0m in 6.24s]
05:06:23.235183 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
05:06:23.235183 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
05:06:23.242448 [info ] [Thread-4  ]: 5 of 7 START incremental model DEMO.hub_part ................................... [RUN]
05:06:23.244493 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
05:06:23.244493 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
05:06:23.245521 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_part
05:06:23.274864 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
05:06:23.277963 [debug] [Thread-4  ]: finished collecting timing info
05:06:23.277963 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
05:06:23.284756 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
05:06:23.288677 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
05:06:23.289677 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:06:23.289677 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:06:23.478071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076F737C0>]}
05:06:23.478071 [info ] [Thread-1  ]: 1 of 7 OK created incremental model DEMO.hub_customer .......................... [[32mSUCCESS 1[0m in 6.50s]
05:06:23.478071 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
05:06:23.478071 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
05:06:23.478071 [info ] [Thread-1  ]: 6 of 7 START incremental model DEMO.hub_region ................................. [RUN]
05:06:23.482682 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
05:06:23.482682 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
05:06:23.483189 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_region
05:06:23.501837 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
05:06:23.517464 [debug] [Thread-1  ]: finished collecting timing info
05:06:23.517464 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
05:06:23.517464 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
05:06:23.533460 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
05:06:23.533460 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:06:23.533460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:06:27.190663 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 9.94 seconds
05:06:27.190663 [debug] [Thread-2  ]: finished collecting timing info
05:06:27.190663 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
05:06:27.391343 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076E40C70>]}
05:06:27.391343 [info ] [Thread-2  ]: 2 of 7 OK created incremental model DEMO.hub_lineitem .......................... [[32mSUCCESS 1[0m in 10.40s]
05:06:27.391343 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
05:06:27.391343 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
05:06:27.399404 [info ] [Thread-2  ]: 7 of 7 START incremental model DEMO.hub_supplier ............................... [RUN]
05:06:27.400888 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
05:06:27.400888 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
05:06:27.402266 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
05:06:27.422547 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
05:06:27.422547 [debug] [Thread-2  ]: finished collecting timing info
05:06:27.422547 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
05:06:27.438952 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
05:06:27.438952 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
05:06:27.438952 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:06:27.438952 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:06:28.996795 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 11.74 seconds
05:06:28.996795 [debug] [Thread-3  ]: finished collecting timing info
05:06:28.996795 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
05:06:29.159504 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076E40EB0>]}
05:06:29.159504 [info ] [Thread-3  ]: 3 of 7 OK created incremental model DEMO.hub_nation ............................ [[32mSUCCESS 1[0m in 12.17s]
05:06:29.159504 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
05:06:29.412361 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.88 seconds
05:06:29.412361 [debug] [Thread-1  ]: finished collecting timing info
05:06:29.412361 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
05:06:29.576010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240780559D0>]}
05:06:29.576010 [info ] [Thread-1  ]: 6 of 7 OK created incremental model DEMO.hub_region ............................ [[32mSUCCESS 1[0m in 6.09s]
05:06:29.576010 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
05:06:29.813880 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 6.52 seconds
05:06:29.813880 [debug] [Thread-4  ]: finished collecting timing info
05:06:29.813880 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: Close
05:06:29.980935 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002407802C8E0>]}
05:06:29.980935 [info ] [Thread-4  ]: 5 of 7 OK created incremental model DEMO.hub_part .............................. [[32mSUCCESS 1[0m in 6.74s]
05:06:29.980935 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
05:06:31.653730 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.21 seconds
05:06:31.653730 [debug] [Thread-2  ]: finished collecting timing info
05:06:31.653730 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
05:06:31.827541 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3937bc13-6712-441e-b55c-cfbace8da5ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076E33DF0>]}
05:06:31.827541 [info ] [Thread-2  ]: 7 of 7 OK created incremental model DEMO.hub_supplier .......................... [[32mSUCCESS 1[0m in 4.43s]
05:06:31.827541 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
05:06:31.839190 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:06:31.840274 [info ] [MainThread]: 
05:06:31.840546 [info ] [MainThread]: Finished running 7 incremental models in 16.79s.
05:06:31.841837 [debug] [MainThread]: Connection 'master' was properly closed.
05:06:31.841837 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
05:06:31.842834 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
05:06:31.843591 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_region' was properly closed.
05:06:31.843591 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_supplier' was properly closed.
05:06:31.843591 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_nation' was properly closed.
05:06:31.843591 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_part' was properly closed.
05:06:31.872601 [info ] [MainThread]: 
05:06:31.873247 [info ] [MainThread]: [32mCompleted successfully[0m
05:06:31.873247 [info ] [MainThread]: 
05:06:31.874519 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
05:06:31.875348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076820100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024076820F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024078023A00>]}


============================== 2022-05-10 05:11:46.805188 | 888049a9-2d7a-435c-a767-5eda433b8d34 ==============================
05:11:46.805188 [info ] [MainThread]: Running with dbt=1.1.0
05:11:46.806186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:link'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:11:46.807202 [debug] [MainThread]: Tracking: tracking
05:11:46.807202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200610A7C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200610A7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200610A7040>]}
05:11:48.472617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:11:48.473688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:11:48.480599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002006115EF40>]}
05:11:48.531636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200610465E0>]}
05:11:48.531636 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
05:11:48.532579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200610501F0>]}
05:11:48.534576 [info ] [MainThread]: 
05:11:48.535577 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:11:48.537692 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
05:11:48.549575 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
05:11:48.549575 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
05:11:48.549575 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:11:49.443552 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.89 seconds
05:11:49.445553 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
05:11:49.601989 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:11:49.612092 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:11:49.612092 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
05:11:49.612092 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:11:50.084765 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.47 seconds
05:11:50.087818 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
05:11:50.227721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002006107C0D0>]}
05:11:50.227721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
05:11:50.228825 [info ] [MainThread]: 
05:11:50.235813 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
05:11:50.235813 [info ] [Thread-1  ]: 1 of 7 START incremental model DEMO.link_customer_nation ....................... [RUN]
05:11:50.236719 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
05:11:50.236719 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
05:11:50.237721 [info ] [Thread-3  ]: 3 of 7 START incremental model DEMO.link_inventory ............................. [RUN]
05:11:50.237721 [info ] [Thread-2  ]: 2 of 7 START incremental model DEMO.link_customer_order ........................ [RUN]
05:11:50.237721 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
05:11:50.238719 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
05:11:50.238719 [info ] [Thread-4  ]: 4 of 7 START incremental model DEMO.link_inventory_allocation .................. [RUN]
05:11:50.239724 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
05:11:50.240734 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
05:11:50.240734 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
05:11:50.241717 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
05:11:50.241717 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
05:11:50.241717 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:11:50.241717 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
05:11:50.241717 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
05:11:50.281085 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
05:11:50.281085 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
05:11:50.290073 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
05:11:50.344073 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
05:11:50.347072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
05:11:50.349158 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
05:11:50.352813 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:11:50.352813 [debug] [Thread-3  ]: finished collecting timing info
05:11:50.352813 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
05:11:50.383331 [debug] [Thread-2  ]: finished collecting timing info
05:11:50.383523 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
05:11:50.383523 [debug] [Thread-1  ]: finished collecting timing info
05:11:50.383523 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
05:11:50.383523 [debug] [Thread-4  ]: finished collecting timing info
05:11:50.383523 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
05:11:50.383523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
05:11:50.383523 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
05:11:50.383523 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
05:11:50.399158 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:11:50.402019 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
05:11:50.402019 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:50.403158 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
05:11:50.403158 [debug] [Thread-3  ]: Opening a new connection, currently in state init
05:11:50.403158 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
05:11:50.403158 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:50.403158 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:11:50.403158 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:50.403158 [debug] [Thread-2  ]: Opening a new connection, currently in state init
05:11:50.403158 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:50.403158 [debug] [Thread-1  ]: Opening a new connection, currently in state init
05:11:50.403158 [debug] [Thread-4  ]: Opening a new connection, currently in state init
05:11:55.691063 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.29 seconds
05:11:55.697162 [debug] [Thread-4  ]: finished collecting timing info
05:11:55.697162 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
05:11:55.860673 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020061663760>]}
05:11:55.860673 [info ] [Thread-4  ]: 4 of 7 OK created incremental model DEMO.link_inventory_allocation ............. [[32mSUCCESS 1[0m in 5.62s]
05:11:55.860673 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
05:11:55.860673 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
05:11:55.860673 [info ] [Thread-4  ]: 5 of 7 START incremental model DEMO.link_nation_region ......................... [RUN]
05:11:55.862517 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
05:11:55.862517 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
05:11:55.862517 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
05:11:55.874805 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
05:11:55.875789 [debug] [Thread-4  ]: finished collecting timing info
05:11:55.875789 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
05:11:55.878987 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
05:11:55.881076 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
05:11:55.881076 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:11:55.881076 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:11:55.926188 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.52 seconds
05:11:55.927799 [debug] [Thread-2  ]: finished collecting timing info
05:11:55.927799 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
05:11:56.071922 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002006107CE80>]}
05:11:56.071922 [info ] [Thread-2  ]: 2 of 7 OK created incremental model DEMO.link_customer_order ................... [[32mSUCCESS 1[0m in 5.83s]
05:11:56.071922 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
05:11:56.071922 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
05:11:56.071922 [info ] [Thread-2  ]: 6 of 7 START incremental model DEMO.link_order_lineitem ........................ [RUN]
05:11:56.096766 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
05:11:56.096766 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
05:11:56.096766 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
05:11:56.104766 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
05:11:56.106771 [debug] [Thread-2  ]: finished collecting timing info
05:11:56.107799 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
05:11:56.109852 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
05:11:56.111768 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
05:11:56.111768 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:56.111768 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:11:56.763156 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.36 seconds
05:11:56.763156 [debug] [Thread-3  ]: finished collecting timing info
05:11:56.763156 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
05:11:56.931855 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002006105D6A0>]}
05:11:56.931855 [info ] [Thread-3  ]: 3 of 7 OK created incremental model DEMO.link_inventory ........................ [[32mSUCCESS 1[0m in 6.69s]
05:11:56.931855 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
05:11:56.931855 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
05:11:56.942101 [info ] [Thread-3  ]: 7 of 7 START incremental model DEMO.link_supplier_nation ....................... [RUN]
05:11:56.943101 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
05:11:56.943395 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
05:11:56.943526 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
05:11:56.953163 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
05:11:56.954164 [debug] [Thread-3  ]: finished collecting timing info
05:11:56.955164 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
05:11:56.958260 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
05:11:56.959161 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
05:11:56.960257 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:11:56.960257 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:11:58.384036 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.27 seconds
05:11:58.384036 [debug] [Thread-2  ]: finished collecting timing info
05:11:58.384036 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
05:11:58.405946 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 8.0 seconds
05:11:58.405946 [debug] [Thread-1  ]: finished collecting timing info
05:11:58.405946 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
05:11:58.539837 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200616629D0>]}
05:11:58.539837 [info ] [Thread-2  ]: 6 of 7 OK created incremental model DEMO.link_order_lineitem ................... [[32mSUCCESS 1[0m in 2.44s]
05:11:58.539837 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
05:11:58.552447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002006105DA90>]}
05:11:58.568426 [info ] [Thread-1  ]: 1 of 7 OK created incremental model DEMO.link_customer_nation .................. [[32mSUCCESS 1[0m in 8.31s]
05:11:58.568426 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
05:11:59.836180 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.96 seconds
05:11:59.836180 [debug] [Thread-4  ]: finished collecting timing info
05:11:59.836180 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
05:11:59.988174 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200627FDE20>]}
05:11:59.988174 [info ] [Thread-4  ]: 5 of 7 OK created incremental model DEMO.link_nation_region .................... [[32mSUCCESS 1[0m in 4.13s]
05:11:59.988174 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
05:12:00.188283 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.23 seconds
05:12:00.203803 [debug] [Thread-3  ]: finished collecting timing info
05:12:00.204464 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
05:12:00.337941 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888049a9-2d7a-435c-a767-5eda433b8d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020061662BB0>]}
05:12:00.352217 [info ] [Thread-3  ]: 7 of 7 OK created incremental model DEMO.link_supplier_nation .................. [[32mSUCCESS 1[0m in 3.40s]
05:12:00.354527 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
05:12:00.356749 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:12:00.357104 [info ] [MainThread]: 
05:12:00.357104 [info ] [MainThread]: Finished running 7 incremental models in 11.82s.
05:12:00.357104 [debug] [MainThread]: Connection 'master' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.link_customer_nation' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.link_supplier_nation' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.link_order_lineitem' was properly closed.
05:12:00.360224 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.link_nation_region' was properly closed.
05:12:00.384745 [info ] [MainThread]: 
05:12:00.385567 [info ] [MainThread]: [32mCompleted successfully[0m
05:12:00.385567 [info ] [MainThread]: 
05:12:00.386703 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
05:12:00.387098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020061050400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020061050340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200617D0040>]}


============================== 2022-05-10 05:12:23.036225 | 81888765-3584-4a4f-89a0-be8d99f42492 ==============================
05:12:23.036225 [info ] [MainThread]: Running with dbt=1.1.0
05:12:23.036225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:satellite'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:12:23.036225 [debug] [MainThread]: Tracking: tracking
05:12:23.036225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB80EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB805B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB80D90>]}
05:12:23.168157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:12:23.168157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:12:23.168157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAC1DFD0>]}
05:12:23.215558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB065B0>]}
05:12:23.215558 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
05:12:23.215558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB10190>]}
05:12:23.224256 [info ] [MainThread]: 
05:12:23.225779 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:12:23.227443 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
05:12:23.236743 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
05:12:23.236836 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
05:12:23.236836 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:12:23.957107 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.72 seconds
05:12:23.957107 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
05:12:24.112420 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:12:24.119658 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:12:24.119658 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
05:12:24.119658 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:12:24.556243 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.44 seconds
05:12:24.558000 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
05:12:24.708534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAF80640>]}
05:12:24.708534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
05:12:24.708534 [info ] [MainThread]: 
05:12:24.716611 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:12:24.716611 [info ] [Thread-1  ]: 1 of 10 START incremental model DEMO.sat_inv_inventory_details ................. [RUN]
05:12:24.721178 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
05:12:24.721178 [info ] [Thread-2  ]: 2 of 10 START incremental model DEMO.sat_inv_part_details ...................... [RUN]
05:12:24.721178 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:12:24.722183 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:12:24.722183 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:12:24.723238 [info ] [Thread-3  ]: 3 of 10 START incremental model DEMO.sat_inv_supp_nation_details ............... [RUN]
05:12:24.723707 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:12:24.723707 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:12:24.723707 [info ] [Thread-4  ]: 4 of 10 START incremental model DEMO.sat_inv_supp_region_details ............... [RUN]
05:12:24.723707 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
05:12:24.725135 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:12:24.725701 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
05:12:24.738866 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:12:24.763426 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:12:24.763906 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:12:24.764796 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:12:24.764996 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:12:24.768003 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:12:24.823515 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:12:24.838009 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:12:24.843345 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:12:24.850346 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:12:24.851347 [debug] [Thread-1  ]: finished collecting timing info
05:12:24.851347 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:12:24.869715 [debug] [Thread-3  ]: finished collecting timing info
05:12:24.869964 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:12:24.892068 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:12:24.893042 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:12:24.894836 [debug] [Thread-4  ]: finished collecting timing info
05:12:24.894836 [debug] [Thread-2  ]: finished collecting timing info
05:12:24.894836 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:12:24.894836 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
05:12:24.898040 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:12:24.899042 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:12:24.901600 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:12:24.902601 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:12:24.902601 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:24.903598 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:24.903598 [debug] [Thread-1  ]: Opening a new connection, currently in state init
05:12:24.903598 [debug] [Thread-3  ]: Opening a new connection, currently in state init
05:12:24.907239 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:12:24.907500 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:12:24.908541 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:24.909596 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:24.910507 [debug] [Thread-2  ]: Opening a new connection, currently in state init
05:12:24.910507 [debug] [Thread-4  ]: Opening a new connection, currently in state init
05:12:29.361441 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.45 seconds
05:12:29.376199 [debug] [Thread-4  ]: finished collecting timing info
05:12:29.376199 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
05:12:29.538623 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB18B1C0>]}
05:12:29.539626 [info ] [Thread-4  ]: 4 of 10 OK created incremental model DEMO.sat_inv_supp_region_details .......... [[32mSUCCESS 1[0m in 4.76s]
05:12:29.541305 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:12:29.542325 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:12:29.542325 [info ] [Thread-4  ]: 5 of 10 START incremental model DEMO.sat_inv_supplier_details .................. [RUN]
05:12:29.544549 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:12:29.545511 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:12:29.545511 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:12:29.571149 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:12:29.573046 [debug] [Thread-4  ]: finished collecting timing info
05:12:29.573046 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:12:29.578048 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:12:29.582048 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:12:29.582048 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:29.583052 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:12:32.286222 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.7 seconds
05:12:32.286222 [debug] [Thread-4  ]: finished collecting timing info
05:12:32.286222 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
05:12:32.439726 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB1308E0>]}
05:12:32.440197 [info ] [Thread-4  ]: 5 of 10 OK created incremental model DEMO.sat_inv_supplier_details ............. [[32mSUCCESS 1[0m in 2.90s]
05:12:32.441436 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:12:32.441436 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:12:32.444007 [info ] [Thread-4  ]: 6 of 10 START incremental model DEMO.sat_order_cust_nation_details ............. [RUN]
05:12:32.445432 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:12:32.445432 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:12:32.446338 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:12:32.465311 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:12:32.481148 [debug] [Thread-4  ]: finished collecting timing info
05:12:32.481148 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:12:32.481148 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:12:32.481148 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:12:32.481148 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:32.481148 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:12:34.166681 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.69 seconds
05:12:34.166681 [debug] [Thread-4  ]: finished collecting timing info
05:12:34.166681 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
05:12:34.314256 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DC2F65B0>]}
05:12:34.314256 [info ] [Thread-4  ]: 6 of 10 OK created incremental model DEMO.sat_order_cust_nation_details ........ [[32mSUCCESS 1[0m in 1.87s]
05:12:34.314256 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:12:34.314256 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:12:34.323276 [info ] [Thread-4  ]: 7 of 10 START incremental model DEMO.sat_order_cust_region_details ............. [RUN]
05:12:34.324283 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:12:34.325004 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:12:34.325004 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:12:34.345077 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:12:34.345077 [debug] [Thread-4  ]: finished collecting timing info
05:12:34.345077 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:12:34.360704 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:12:34.360704 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:12:34.360704 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:34.360704 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:12:34.382522 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 9.48 seconds
05:12:34.382522 [debug] [Thread-3  ]: finished collecting timing info
05:12:34.382522 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
05:12:34.529330 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB1133A0>]}
05:12:34.529330 [info ] [Thread-3  ]: 3 of 10 OK created incremental model DEMO.sat_inv_supp_nation_details .......... [[32mSUCCESS 1[0m in 9.79s]
05:12:34.529330 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:12:34.544827 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
05:12:34.545806 [info ] [Thread-3  ]: 8 of 10 START incremental model DEMO.sat_order_customer_details ................ [RUN]
05:12:34.547163 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:12:34.547163 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
05:12:34.548101 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
05:12:34.583957 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:12:34.583957 [debug] [Thread-3  ]: finished collecting timing info
05:12:34.583957 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
05:12:34.599757 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:12:34.599757 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:12:34.599757 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:34.599757 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:12:34.599757 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 9.69 seconds
05:12:34.599757 [debug] [Thread-2  ]: finished collecting timing info
05:12:34.599757 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
05:12:34.767251 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB39130>]}
05:12:34.767251 [info ] [Thread-2  ]: 2 of 10 OK created incremental model DEMO.sat_inv_part_details ................. [[32mSUCCESS 1[0m in 10.04s]
05:12:34.767251 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
05:12:34.767251 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:12:34.775856 [info ] [Thread-2  ]: 9 of 10 START incremental model DEMO.sat_order_lineitem_details ................ [RUN]
05:12:34.777549 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:12:34.777549 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:12:34.777549 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:12:34.797890 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:12:34.814168 [debug] [Thread-2  ]: finished collecting timing info
05:12:34.849200 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:12:34.849200 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:12:34.849200 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:12:34.849200 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:34.849200 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:12:35.199662 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 10.3 seconds
05:12:35.199662 [debug] [Thread-1  ]: finished collecting timing info
05:12:35.199662 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
05:12:35.346234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAB39A00>]}
05:12:35.346234 [info ] [Thread-1  ]: 1 of 10 OK created incremental model DEMO.sat_inv_inventory_details ............ [[32mSUCCESS 1[0m in 10.62s]
05:12:35.346234 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:12:35.346234 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
05:12:35.360956 [info ] [Thread-1  ]: 10 of 10 START incremental model DEMO.sat_order_order_details .................. [RUN]
05:12:35.362363 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
05:12:35.362363 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
05:12:35.363581 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
05:12:35.402196 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
05:12:35.402196 [debug] [Thread-1  ]: finished collecting timing info
05:12:35.402196 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
05:12:35.402196 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
05:12:35.402196 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
05:12:35.402196 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:12:35.402196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:12:36.228918 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.87 seconds
05:12:36.228918 [debug] [Thread-4  ]: finished collecting timing info
05:12:36.228918 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
05:12:36.374395 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB130AF0>]}
05:12:36.374395 [info ] [Thread-4  ]: 7 of 10 OK created incremental model DEMO.sat_order_cust_region_details ........ [[32mSUCCESS 1[0m in 2.05s]
05:12:36.374395 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:12:39.496831 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.9 seconds
05:12:39.496831 [debug] [Thread-3  ]: finished collecting timing info
05:12:39.496831 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
05:12:39.659498 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DC2E0280>]}
05:12:39.659498 [info ] [Thread-3  ]: 8 of 10 OK created incremental model DEMO.sat_order_customer_details ........... [[32mSUCCESS 1[0m in 5.11s]
05:12:39.659498 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
05:12:39.761001 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.91 seconds
05:12:39.761001 [debug] [Thread-2  ]: finished collecting timing info
05:12:39.761001 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
05:12:39.914005 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DC39ACD0>]}
05:12:39.914005 [info ] [Thread-2  ]: 9 of 10 OK created incremental model DEMO.sat_order_lineitem_details ........... [[32mSUCCESS 1[0m in 5.14s]
05:12:39.914005 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:12:42.691334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7.29 seconds
05:12:42.691334 [debug] [Thread-1  ]: finished collecting timing info
05:12:42.691334 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
05:12:42.838741 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81888765-3584-4a4f-89a0-be8d99f42492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB2B97F0>]}
05:12:42.838741 [info ] [Thread-1  ]: 10 of 10 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 7.48s]
05:12:42.838741 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
05:12:42.855526 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:12:42.855526 [info ] [MainThread]: 
05:12:42.855526 [info ] [MainThread]: Finished running 10 incremental models in 19.63s.
05:12:42.855526 [debug] [MainThread]: Connection 'master' was properly closed.
05:12:42.859280 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
05:12:42.859280 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
05:12:42.859280 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_order_details' was properly closed.
05:12:42.859280 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_lineitem_details' was properly closed.
05:12:42.860377 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_customer_details' was properly closed.
05:12:42.860758 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_order_cust_region_details' was properly closed.
05:12:42.892106 [info ] [MainThread]: 
05:12:42.893372 [info ] [MainThread]: [32mCompleted successfully[0m
05:12:42.894609 [info ] [MainThread]: 
05:12:42.895694 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
05:12:42.896289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB275DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DB126F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293DAF80640>]}


============================== 2022-05-10 05:13:10.854246 | 2afb5573-53ff-4b58-813a-90835b7fe81c ==============================
05:13:10.854246 [info ] [MainThread]: Running with dbt=1.1.0
05:13:10.855232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:t_link'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:13:10.855232 [debug] [MainThread]: Tracking: tracking
05:13:10.855232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559860DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559860580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559860F10>]}
05:13:10.980459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:13:10.980459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:13:10.980459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2afb5573-53ff-4b58-813a-90835b7fe81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165598FEFD0>]}
05:13:11.037501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2afb5573-53ff-4b58-813a-90835b7fe81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165597E65B0>]}
05:13:11.038499 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
05:13:11.038499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2afb5573-53ff-4b58-813a-90835b7fe81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165597F1190>]}
05:13:11.039499 [info ] [MainThread]: 
05:13:11.040495 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:13:11.042609 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
05:13:11.055783 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
05:13:11.055783 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
05:13:11.056734 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:13:11.822762 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.77 seconds
05:13:11.823855 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
05:13:11.966670 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:13:11.984337 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:13:11.984337 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
05:13:11.984337 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:13:12.484288 [debug] [ThreadPool]: SQL status: SUCCESS 30 in 0.5 seconds
05:13:12.484288 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
05:13:12.642540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2afb5573-53ff-4b58-813a-90835b7fe81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559C62640>]}
05:13:12.642540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
05:13:12.642540 [info ] [MainThread]: 
05:13:12.656611 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
05:13:12.656611 [info ] [Thread-1  ]: 1 of 1 START incremental model DEMO.t_link_transactions ........................ [RUN]
05:13:12.659527 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:12.660062 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
05:13:12.660562 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
05:13:12.740854 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:12.741854 [debug] [Thread-1  ]: finished collecting timing info
05:13:12.742647 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
05:13:12.773764 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:12.776077 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:12.776077 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
05:13:12.776077 [debug] [Thread-1  ]: Opening a new connection, currently in state init
05:13:14.048305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.27 seconds
05:13:14.048305 [debug] [Thread-1  ]: finished collecting timing info
05:13:14.048305 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
05:13:14.202757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2afb5573-53ff-4b58-813a-90835b7fe81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559DE9310>]}
05:13:14.202757 [info ] [Thread-1  ]: 1 of 1 OK created incremental model DEMO.t_link_transactions ................... [[32mSUCCESS 1[0m in 1.54s]
05:13:14.203757 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
05:13:14.206804 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:13:14.206804 [info ] [MainThread]: 
05:13:14.207757 [info ] [MainThread]: Finished running 1 incremental model in 3.17s.
05:13:14.209756 [debug] [MainThread]: Connection 'master' was properly closed.
05:13:14.210757 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
05:13:14.210757 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
05:13:14.210757 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.t_link_transactions' was properly closed.
05:13:14.223853 [info ] [MainThread]: 
05:13:14.224797 [info ] [MainThread]: [32mCompleted successfully[0m
05:13:14.225759 [info ] [MainThread]: 
05:13:14.226366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
05:13:14.226866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165598D3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559DFD1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016559E729D0>]}


============================== 2022-05-10 05:13:34.355724 | 9b736adb-bd90-4105-97cb-252ad9dd9449 ==============================
05:13:34.355724 [info ] [MainThread]: Running with dbt=1.1.0
05:13:34.356772 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:13:34.356772 [debug] [MainThread]: Tracking: tracking
05:13:34.356772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4D5F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4D5F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4D5FDC0>]}
05:13:34.477509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:13:34.477509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:13:34.477509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4DFDFA0>]}
05:13:34.528769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4CE6580>]}
05:13:34.528769 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
05:13:34.528769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4CFB7C0>]}
05:13:34.535641 [info ] [MainThread]: 
05:13:34.536918 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:13:34.538878 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
05:13:34.549457 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
05:13:34.549457 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
05:13:34.549457 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:13:35.271948 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.72 seconds
05:13:35.289172 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
05:13:35.425299 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:13:35.441726 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
05:13:35.441726 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
05:13:35.441726 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:13:35.942687 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.5 seconds
05:13:35.942687 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
05:13:36.110207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C52E48E0>]}
05:13:36.110207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
05:13:36.111205 [info ] [MainThread]: 
05:13:36.117338 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
05:13:36.117338 [info ] [Thread-1  ]: 1 of 31 START view model DEMO.raw_orders ....................................... [RUN]
05:13:36.118387 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
05:13:36.118387 [info ] [Thread-2  ]: 2 of 31 START view model DEMO.raw_transactions ................................. [RUN]
05:13:36.119337 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
05:13:36.119337 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
05:13:36.120339 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
05:13:36.120339 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
05:13:36.120339 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
05:13:36.125427 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
05:13:36.126416 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
05:13:36.129721 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
05:13:36.141721 [debug] [Thread-1  ]: finished collecting timing info
05:13:36.141721 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
05:13:36.141721 [debug] [Thread-2  ]: finished collecting timing info
05:13:36.161721 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
05:13:36.162722 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
05:13:36.165805 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
05:13:36.170138 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
05:13:36.170138 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
05:13:36.170138 [debug] [Thread-1  ]: Opening a new connection, currently in state init
05:13:36.172136 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
05:13:36.172136 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
05:13:36.172136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
05:13:36.723775 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.55 seconds
05:13:36.728687 [debug] [Thread-2  ]: finished collecting timing info
05:13:36.728687 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
05:13:36.817200 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
05:13:36.817200 [debug] [Thread-1  ]: finished collecting timing info
05:13:36.817200 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
05:13:36.860202 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C52E9EB0>]}
05:13:36.860202 [info ] [Thread-2  ]: 2 of 31 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 0.74s]
05:13:36.875902 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
05:13:36.880048 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
05:13:36.881047 [info ] [Thread-4  ]: 3 of 31 START view model DEMO.v_stg_transactions ............................... [RUN]
05:13:36.882039 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:36.883041 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
05:13:36.883041 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
05:13:36.914041 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:36.914041 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
05:13:36.914041 [debug] [Thread-4  ]: Opening a new connection, currently in state init
05:13:36.979532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C5305460>]}
05:13:36.979532 [info ] [Thread-1  ]: 1 of 31 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 0.86s]
05:13:36.979532 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
05:13:36.982039 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
05:13:36.982039 [info ] [Thread-2  ]: 4 of 31 START view model DEMO.raw_inventory .................................... [RUN]
05:13:36.983036 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
05:13:36.983036 [info ] [Thread-3  ]: 5 of 31 START view model DEMO.v_stg_orders ..................................... [RUN]
05:13:36.983036 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
05:13:36.983036 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
05:13:36.984036 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
05:13:36.987873 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
05:13:36.988873 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:36.989883 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
05:13:36.989883 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
05:13:36.997877 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:36.997877 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
05:13:36.997877 [debug] [Thread-3  ]: Opening a new connection, currently in state init
05:13:37.002148 [debug] [Thread-2  ]: finished collecting timing info
05:13:37.002148 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
05:13:37.005148 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
05:13:37.007147 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
05:13:37.007147 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
05:13:37.008235 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:37.308287 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.39 seconds
05:13:37.362126 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:37.362126 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
05:13:37.412653 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.41 seconds
05:13:37.441728 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:37.442424 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
05:13:37.460853 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.1 seconds
05:13:37.526650 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:37.538852 [debug] [Thread-4  ]: finished collecting timing info
05:13:37.538852 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
05:13:37.538852 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:37.538852 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.1 seconds
05:13:37.554583 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
05:13:37.554583 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
05:13:37.646774 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:37.647317 [debug] [Thread-3  ]: finished collecting timing info
05:13:37.647317 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
05:13:37.647317 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:37.647317 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
05:13:37.647317 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
05:13:37.647317 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.64 seconds
05:13:37.647317 [debug] [Thread-2  ]: finished collecting timing info
05:13:37.647317 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
05:13:37.778570 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.21 seconds
05:13:37.778570 [debug] [Thread-4  ]: finished collecting timing info
05:13:37.794090 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
05:13:37.794090 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53A1610>]}
05:13:37.794090 [info ] [Thread-2  ]: 4 of 31 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 0.81s]
05:13:37.794090 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
05:13:37.794090 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
05:13:37.809304 [info ] [Thread-1  ]: 6 of 31 START view model DEMO.v_stg_inventory .................................. [RUN]
05:13:37.809304 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:37.810306 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
05:13:37.810306 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
05:13:37.817390 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:37.817390 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
05:13:37.818388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:37.932490 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53ADC40>]}
05:13:37.932490 [info ] [Thread-4  ]: 3 of 31 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.05s]
05:13:37.932490 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
05:13:37.932490 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
05:13:37.941801 [info ] [Thread-2  ]: 7 of 31 START incremental model DEMO.t_link_transactions ....................... [RUN]
05:13:37.942470 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.3 seconds
05:13:37.944471 [debug] [Thread-3  ]: finished collecting timing info
05:13:37.945472 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:37.945472 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
05:13:37.945472 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
05:13:37.948470 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
05:13:38.053780 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:38.054777 [debug] [Thread-2  ]: finished collecting timing info
05:13:38.054777 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
05:13:38.078668 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:38.078668 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
05:13:38.078668 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
05:13:38.078668 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:38.151692 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C651D0D0>]}
05:13:38.151692 [info ] [Thread-3  ]: 5 of 31 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.16s]
05:13:38.151692 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
05:13:38.166554 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
05:13:38.166849 [info ] [Thread-4  ]: 8 of 31 START incremental model DEMO.hub_customer .............................. [RUN]
05:13:38.166849 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
05:13:38.167350 [info ] [Thread-3  ]: 9 of 31 START incremental model DEMO.hub_lineitem .............................. [RUN]
05:13:38.167350 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
05:13:38.168369 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
05:13:38.168953 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
05:13:38.168953 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
05:13:38.168953 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
05:13:38.195365 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
05:13:38.195365 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
05:13:38.206459 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
05:13:38.207458 [debug] [Thread-4  ]: finished collecting timing info
05:13:38.207458 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
05:13:38.207458 [debug] [Thread-3  ]: finished collecting timing info
05:13:38.210560 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
05:13:38.210560 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
05:13:38.215538 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
05:13:38.217572 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
05:13:38.217572 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:38.218533 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:38.234768 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
05:13:38.235270 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:38.236097 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:38.333666 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.52 seconds
05:13:38.365009 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:38.365009 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
05:13:38.483255 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.12 seconds
05:13:38.549915 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:38.549915 [debug] [Thread-1  ]: finished collecting timing info
05:13:38.549915 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
05:13:38.549915 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:38.549915 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
05:13:38.549915 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
05:13:38.835144 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.29 seconds
05:13:38.835144 [debug] [Thread-1  ]: finished collecting timing info
05:13:38.835144 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
05:13:38.983304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53A1610>]}
05:13:38.983304 [info ] [Thread-1  ]: 6 of 31 OK created view model DEMO.v_stg_inventory ............................. [[32mSUCCESS 1[0m in 1.17s]
05:13:38.983304 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
05:13:38.983304 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
05:13:38.983304 [info ] [Thread-1  ]: 10 of 31 START incremental model DEMO.hub_order ................................ [RUN]
05:13:38.992290 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
05:13:38.992290 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
05:13:38.992290 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
05:13:38.995898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
05:13:38.995898 [debug] [Thread-1  ]: finished collecting timing info
05:13:38.995898 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
05:13:38.995898 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
05:13:38.995898 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
05:13:38.995898 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:38.995898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:39.352473 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.27 seconds
05:13:39.368077 [debug] [Thread-2  ]: finished collecting timing info
05:13:39.368077 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
05:13:39.568683 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C533DA90>]}
05:13:39.568683 [info ] [Thread-2  ]: 7 of 31 OK created incremental model DEMO.t_link_transactions .................. [[32mSUCCESS 1[0m in 1.62s]
05:13:39.568683 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
05:13:39.568683 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
05:13:39.568683 [info ] [Thread-2  ]: 11 of 31 START incremental model DEMO.link_customer_nation ..................... [RUN]
05:13:39.579600 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
05:13:39.579600 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
05:13:39.579600 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
05:13:39.606089 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
05:13:39.607101 [debug] [Thread-2  ]: finished collecting timing info
05:13:39.607101 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
05:13:39.610087 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
05:13:39.611155 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
05:13:39.611155 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:39.611155 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:40.720656 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.5 seconds
05:13:40.720656 [debug] [Thread-3  ]: finished collecting timing info
05:13:40.720656 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
05:13:40.757426 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.52 seconds
05:13:40.757426 [debug] [Thread-4  ]: finished collecting timing info
05:13:40.757426 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
05:13:40.877570 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53B0610>]}
05:13:40.878642 [info ] [Thread-3  ]: 9 of 31 OK created incremental model DEMO.hub_lineitem ......................... [[32mSUCCESS 1[0m in 2.71s]
05:13:40.879444 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
05:13:40.879444 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
05:13:40.879444 [info ] [Thread-3  ]: 12 of 31 START incremental model DEMO.link_customer_order ...................... [RUN]
05:13:40.880601 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
05:13:40.880601 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
05:13:40.881604 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
05:13:40.882075 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
05:13:40.882075 [debug] [Thread-3  ]: finished collecting timing info
05:13:40.882075 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
05:13:40.882075 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
05:13:40.882075 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
05:13:40.882075 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:40.882075 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:40.919294 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53ADC10>]}
05:13:40.919294 [info ] [Thread-4  ]: 8 of 31 OK created incremental model DEMO.hub_customer ......................... [[32mSUCCESS 1[0m in 2.75s]
05:13:40.920229 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
05:13:40.920229 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
05:13:40.920229 [info ] [Thread-4  ]: 13 of 31 START incremental model DEMO.link_inventory_allocation ................ [RUN]
05:13:40.921236 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:13:40.921236 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
05:13:40.921236 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
05:13:40.931239 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:13:40.932241 [debug] [Thread-4  ]: finished collecting timing info
05:13:40.932241 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
05:13:40.936237 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:13:40.937624 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
05:13:40.938632 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:40.938632 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:41.046810 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.05 seconds
05:13:41.046810 [debug] [Thread-1  ]: finished collecting timing info
05:13:41.046810 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
05:13:41.191388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6552370>]}
05:13:41.191388 [info ] [Thread-1  ]: 10 of 31 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 2.20s]
05:13:41.191388 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
05:13:41.191388 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
05:13:41.191388 [info ] [Thread-1  ]: 14 of 31 START incremental model DEMO.link_order_lineitem ...................... [RUN]
05:13:41.206642 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
05:13:41.207643 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
05:13:41.207839 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
05:13:41.218140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
05:13:41.218140 [debug] [Thread-1  ]: finished collecting timing info
05:13:41.219059 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
05:13:41.221143 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
05:13:41.223063 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
05:13:41.223063 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:41.223063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:41.319734 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.71 seconds
05:13:41.321734 [debug] [Thread-2  ]: finished collecting timing info
05:13:41.321734 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
05:13:41.459763 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C52FA520>]}
05:13:41.459763 [info ] [Thread-2  ]: 11 of 31 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 1.88s]
05:13:41.459763 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
05:13:41.459763 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:13:41.459763 [info ] [Thread-2  ]: 15 of 31 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
05:13:41.466313 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:13:41.466313 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:13:41.466313 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:13:41.502785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:13:41.503775 [debug] [Thread-2  ]: finished collecting timing info
05:13:41.503775 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:13:41.507600 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:13:41.508598 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
05:13:41.508598 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:41.508598 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:42.562160 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.68 seconds
05:13:42.562160 [debug] [Thread-3  ]: finished collecting timing info
05:13:42.562160 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
05:13:42.704298 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53FA0A0>]}
05:13:42.704298 [info ] [Thread-3  ]: 12 of 31 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 1.82s]
05:13:42.704298 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
05:13:42.704298 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:13:42.704298 [info ] [Thread-3  ]: 16 of 31 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
05:13:42.718534 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:13:42.718534 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:13:42.719534 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:13:42.733019 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:13:42.734649 [debug] [Thread-3  ]: finished collecting timing info
05:13:42.734649 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:13:42.737759 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:13:42.738660 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
05:13:42.738660 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:42.739755 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:42.942189 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
05:13:42.948285 [debug] [Thread-4  ]: finished collecting timing info
05:13:42.948285 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
05:13:43.095763 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C5432A60>]}
05:13:43.095763 [info ] [Thread-4  ]: 13 of 31 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 2.17s]
05:13:43.095763 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
05:13:43.095763 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
05:13:43.095763 [info ] [Thread-4  ]: 17 of 31 START incremental model DEMO.sat_order_customer_details ............... [RUN]
05:13:43.107741 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:13:43.107741 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
05:13:43.107741 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
05:13:43.125393 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:13:43.126369 [debug] [Thread-4  ]: finished collecting timing info
05:13:43.126369 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
05:13:43.130370 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:13:43.132371 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
05:13:43.132371 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:43.132371 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:43.214156 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.99 seconds
05:13:43.215155 [debug] [Thread-1  ]: finished collecting timing info
05:13:43.215155 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
05:13:43.364956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C535DB50>]}
05:13:43.364956 [info ] [Thread-1  ]: 14 of 31 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 2.16s]
05:13:43.364956 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
05:13:43.364956 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:13:43.364956 [info ] [Thread-1  ]: 18 of 31 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
05:13:43.375486 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:13:43.375486 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:13:43.375486 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:13:43.394614 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:13:43.396120 [debug] [Thread-1  ]: finished collecting timing info
05:13:43.396120 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:13:43.399718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:13:43.401794 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
05:13:43.401794 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:43.401794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:43.475877 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.97 seconds
05:13:43.477951 [debug] [Thread-2  ]: finished collecting timing info
05:13:43.477951 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
05:13:43.614461 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6624250>]}
05:13:43.614461 [info ] [Thread-2  ]: 15 of 31 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 2.15s]
05:13:43.614461 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
05:13:43.614461 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
05:13:43.614461 [info ] [Thread-2  ]: 19 of 31 START incremental model DEMO.sat_order_order_details .................. [RUN]
05:13:43.623933 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
05:13:43.623933 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
05:13:43.623933 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
05:13:43.638656 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
05:13:43.639659 [debug] [Thread-2  ]: finished collecting timing info
05:13:43.640570 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
05:13:43.642650 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
05:13:43.643652 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
05:13:43.643652 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:43.644678 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:44.499619 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.76 seconds
05:13:44.499619 [debug] [Thread-3  ]: finished collecting timing info
05:13:44.499619 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
05:13:44.653072 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C66030D0>]}
05:13:44.653072 [info ] [Thread-3  ]: 16 of 31 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 1.93s]
05:13:44.653072 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
05:13:44.653072 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
05:13:44.653072 [info ] [Thread-3  ]: 20 of 31 START incremental model DEMO.hub_nation ............................... [RUN]
05:13:44.668525 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
05:13:44.668525 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
05:13:44.668525 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
05:13:44.681609 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
05:13:44.684453 [debug] [Thread-3  ]: finished collecting timing info
05:13:44.684714 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
05:13:44.688823 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
05:13:44.690822 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
05:13:44.690822 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:13:44.690822 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:44.969617 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.84 seconds
05:13:44.969617 [debug] [Thread-4  ]: finished collecting timing info
05:13:44.969617 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
05:13:45.124669 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6685670>]}
05:13:45.125669 [info ] [Thread-4  ]: 17 of 31 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 2.02s]
05:13:45.126863 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
05:13:45.126863 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_part
05:13:45.127876 [info ] [Thread-4  ]: 21 of 31 START incremental model DEMO.hub_part ................................. [RUN]
05:13:45.128949 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
05:13:45.128949 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
05:13:45.129878 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_part
05:13:45.141964 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
05:13:45.142971 [debug] [Thread-4  ]: finished collecting timing info
05:13:45.142971 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
05:13:45.145959 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
05:13:45.147881 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
05:13:45.147881 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:13:45.148877 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:47.322885 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.92 seconds
05:13:47.322885 [debug] [Thread-1  ]: finished collecting timing info
05:13:47.322885 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
05:13:47.376680 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.73 seconds
05:13:47.376680 [debug] [Thread-2  ]: finished collecting timing info
05:13:47.376680 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
05:13:47.477149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C65F0EE0>]}
05:13:47.477149 [info ] [Thread-1  ]: 18 of 31 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 4.10s]
05:13:47.477149 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
05:13:47.477149 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
05:13:47.477149 [info ] [Thread-1  ]: 22 of 31 START incremental model DEMO.hub_region ............................... [RUN]
05:13:47.485093 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
05:13:47.485093 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
05:13:47.485093 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_region
05:13:47.499904 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
05:13:47.500965 [debug] [Thread-1  ]: finished collecting timing info
05:13:47.500965 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
05:13:47.505188 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
05:13:47.507149 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
05:13:47.507149 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:13:47.507149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:47.524535 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C66E2BE0>]}
05:13:47.525613 [info ] [Thread-2  ]: 19 of 31 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 3.90s]
05:13:47.526537 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
05:13:47.526537 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
05:13:47.526537 [info ] [Thread-2  ]: 23 of 31 START incremental model DEMO.hub_supplier ............................. [RUN]
05:13:47.527534 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
05:13:47.527534 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
05:13:47.527534 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
05:13:47.538507 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
05:13:47.539474 [debug] [Thread-2  ]: finished collecting timing info
05:13:47.539474 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
05:13:47.541481 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
05:13:47.544131 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
05:13:47.544131 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:13:47.544131 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:48.830362 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.14 seconds
05:13:48.830362 [debug] [Thread-3  ]: finished collecting timing info
05:13:48.830362 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
05:13:48.978569 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C66E0FA0>]}
05:13:48.978569 [info ] [Thread-3  ]: 20 of 31 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 4.31s]
05:13:48.982401 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
05:13:48.982401 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
05:13:48.983696 [info ] [Thread-3  ]: 24 of 31 START incremental model DEMO.link_inventory ........................... [RUN]
05:13:48.984457 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
05:13:48.984957 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
05:13:48.984957 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
05:13:48.996492 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
05:13:48.997493 [debug] [Thread-3  ]: finished collecting timing info
05:13:48.997493 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
05:13:49.001047 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
05:13:49.002012 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
05:13:49.003095 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:49.003095 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:49.312467 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.16 seconds
05:13:49.312467 [debug] [Thread-4  ]: finished collecting timing info
05:13:49.312467 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_part: Close
05:13:49.481293 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C670A610>]}
05:13:49.481293 [info ] [Thread-4  ]: 21 of 31 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 4.35s]
05:13:49.481293 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
05:13:49.481293 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
05:13:49.481293 [info ] [Thread-4  ]: 25 of 31 START incremental model DEMO.link_nation_region ....................... [RUN]
05:13:49.487247 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
05:13:49.487247 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
05:13:49.488289 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
05:13:49.501040 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
05:13:49.502039 [debug] [Thread-4  ]: finished collecting timing info
05:13:49.502039 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
05:13:49.505039 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
05:13:49.506849 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
05:13:49.506849 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
05:13:49.506849 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:51.687904 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.18 seconds
05:13:51.687904 [debug] [Thread-1  ]: finished collecting timing info
05:13:51.687904 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
05:13:51.819571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53D6280>]}
05:13:51.819571 [info ] [Thread-1  ]: 22 of 31 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 4.34s]
05:13:51.819571 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
05:13:51.819571 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
05:13:51.819571 [info ] [Thread-1  ]: 26 of 31 START incremental model DEMO.link_supplier_nation ..................... [RUN]
05:13:51.825043 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
05:13:51.825043 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
05:13:51.826045 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
05:13:51.837261 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
05:13:51.838260 [debug] [Thread-1  ]: finished collecting timing info
05:13:51.838260 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
05:13:51.841983 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
05:13:51.843455 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
05:13:51.843977 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
05:13:51.843977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:52.189554 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.65 seconds
05:13:52.205151 [debug] [Thread-2  ]: finished collecting timing info
05:13:52.205151 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
05:13:52.305367 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.3 seconds
05:13:52.305367 [debug] [Thread-3  ]: finished collecting timing info
05:13:52.305367 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
05:13:52.336676 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C66E2FD0>]}
05:13:52.453200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C66E0190>]}
05:13:54.295531 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.79 seconds
05:13:54.295531 [debug] [Thread-4  ]: finished collecting timing info
05:13:54.295531 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
05:13:54.442862 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C64E25E0>]}
05:13:54.664206 [info ] [Thread-2  ]: 23 of 31 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 4.81s]
05:13:54.664206 [info ] [Thread-3  ]: 24 of 31 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 3.47s]
05:13:54.664206 [info ] [Thread-4  ]: 25 of 31 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 4.96s]
05:13:54.664206 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
05:13:54.678872 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
05:13:54.679872 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:13:54.679872 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
05:13:54.680866 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
05:13:54.681866 [info ] [Thread-2  ]: 27 of 31 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
05:13:54.681866 [info ] [Thread-3  ]: 28 of 31 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
05:13:54.682955 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:13:54.683866 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:13:54.684866 [info ] [Thread-4  ]: 29 of 31 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
05:13:54.684866 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:13:54.685867 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:13:54.685867 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:13:54.686873 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:13:54.686873 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
05:13:54.693954 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:13:54.699953 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:13:54.700863 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
05:13:54.700863 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:13:54.717840 [debug] [Thread-2  ]: finished collecting timing info
05:13:54.717840 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:13:54.720774 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:13:54.731483 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:13:54.742029 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
05:13:54.742029 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:54.744025 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:13:54.744934 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
05:13:54.744934 [debug] [Thread-3  ]: finished collecting timing info
05:13:54.746933 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
05:13:54.747935 [debug] [Thread-4  ]: finished collecting timing info
05:13:54.752016 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:13:54.752016 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:13:54.755018 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:13:54.757108 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
05:13:54.757412 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:54.757412 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
05:13:54.757412 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
05:13:54.758426 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:54.760235 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:54.913341 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.07 seconds
05:13:54.928953 [debug] [Thread-1  ]: finished collecting timing info
05:13:54.928953 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
05:13:55.082623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C64E7640>]}
05:13:55.082623 [info ] [Thread-1  ]: 26 of 31 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 3.26s]
05:13:55.082623 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
05:13:55.082623 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:13:55.082623 [info ] [Thread-1  ]: 30 of 31 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
05:13:55.087668 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:13:55.087668 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:13:55.087956 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:13:55.101415 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:13:55.107764 [debug] [Thread-1  ]: finished collecting timing info
05:13:55.107764 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:13:55.110832 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:13:55.112877 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
05:13:55.112877 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:55.112877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:13:58.655765 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.9 seconds
05:13:58.655765 [debug] [Thread-4  ]: finished collecting timing info
05:13:58.655765 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
05:13:58.809222 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.05 seconds
05:13:58.809222 [debug] [Thread-3  ]: finished collecting timing info
05:13:58.809222 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
05:13:58.809222 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C654DC10>]}
05:13:58.809222 [info ] [Thread-4  ]: 29 of 31 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 4.12s]
05:13:58.809222 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
05:13:58.818867 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:13:58.818867 [info ] [Thread-4  ]: 31 of 31 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
05:13:58.819870 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:13:58.820129 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:13:58.820347 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:13:58.834357 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:13:58.835350 [debug] [Thread-4  ]: finished collecting timing info
05:13:58.835350 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:13:58.838350 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:13:58.839350 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
05:13:58.839350 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
05:13:58.839350 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
05:13:58.854156 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.11 seconds
05:13:58.856202 [debug] [Thread-2  ]: finished collecting timing info
05:13:58.856202 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
05:13:58.947288 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C52E61C0>]}
05:13:58.947288 [info ] [Thread-3  ]: 28 of 31 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 4.26s]
05:13:58.947288 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
05:13:59.002512 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53DA160>]}
05:13:59.003553 [info ] [Thread-2  ]: 27 of 31 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 4.32s]
05:13:59.004547 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
05:13:59.241487 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.13 seconds
05:13:59.241487 [debug] [Thread-1  ]: finished collecting timing info
05:13:59.241487 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
05:13:59.409718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C54A4D30>]}
05:13:59.409718 [info ] [Thread-1  ]: 30 of 31 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 4.32s]
05:13:59.410752 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
05:14:01.916149 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.08 seconds
05:14:01.931735 [debug] [Thread-4  ]: finished collecting timing info
05:14:01.931735 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
05:14:02.081820 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b736adb-bd90-4105-97cb-252ad9dd9449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C53D8310>]}
05:14:02.081820 [info ] [Thread-4  ]: 31 of 31 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 3.26s]
05:14:02.081820 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
05:14:02.096899 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:14:02.097399 [info ] [MainThread]: 
05:14:02.098148 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 27.56s.
05:14:02.098148 [debug] [MainThread]: Connection 'master' was properly closed.
05:14:02.099149 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
05:14:02.099149 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
05:14:02.099149 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
05:14:02.099149 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
05:14:02.099149 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
05:14:02.100230 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
05:14:02.117070 [info ] [MainThread]: 
05:14:02.117981 [info ] [MainThread]: [32mCompleted successfully[0m
05:14:02.118985 [info ] [MainThread]: 
05:14:02.118985 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
05:14:02.119981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6685670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C4CFBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C541EFD0>]}


============================== 2022-05-10 08:12:50.746656 | 414a8a1c-cb1d-47ff-8fcd-ee114adeb847 ==============================
08:12:50.746656 [info ] [MainThread]: Running with dbt=1.1.0
08:12:50.748657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:12:50.748657 [debug] [MainThread]: Tracking: tracking
08:12:50.749655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F758E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F75070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F75880>]}
08:12:54.007308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:12:54.007308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:12:54.018309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A01DF40>]}
08:12:54.088841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F065E0>]}
08:12:54.089842 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
08:12:54.089842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F101F0>]}
08:12:54.092912 [info ] [MainThread]: 
08:12:54.093838 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:12:54.100631 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
08:12:54.122816 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
08:12:54.122816 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
08:12:54.122816 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:12:55.192145 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.07 seconds
08:12:55.195165 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
08:12:55.363128 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
08:12:55.378207 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
08:12:55.379205 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
08:12:55.379205 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:12:55.952698 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.57 seconds
08:12:55.958695 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
08:12:56.117422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F140D0>]}
08:12:56.118948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
08:12:56.119947 [info ] [MainThread]: 
08:12:56.131945 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
08:12:56.132946 [info ] [Thread-1  ]: 1 of 31 START view model DEMO.raw_orders ....................................... [RUN]
08:12:56.132946 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
08:12:56.133945 [info ] [Thread-2  ]: 2 of 31 START view model DEMO.raw_transactions ................................. [RUN]
08:12:56.135053 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
08:12:56.136094 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
08:12:56.137651 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
08:12:56.139151 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
08:12:56.139151 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
08:12:56.147196 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
08:12:56.148209 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
08:12:56.156284 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
08:12:56.159250 [debug] [Thread-2  ]: finished collecting timing info
08:12:56.159752 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
08:12:56.160254 [debug] [Thread-1  ]: finished collecting timing info
08:12:56.196756 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
08:12:56.203274 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
08:12:56.207280 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
08:12:56.211195 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
08:12:56.216674 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
08:12:56.216674 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
08:12:56.217677 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
08:12:56.218145 [debug] [Thread-2  ]: Opening a new connection, currently in state init
08:12:56.218145 [debug] [Thread-1  ]: Opening a new connection, currently in state init
08:12:56.817499 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.6 seconds
08:12:56.830777 [debug] [Thread-2  ]: finished collecting timing info
08:12:56.830777 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
08:12:56.949849 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
08:12:56.953855 [debug] [Thread-1  ]: finished collecting timing info
08:12:56.953855 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
08:12:56.990105 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A525A00>]}
08:12:56.990105 [info ] [Thread-2  ]: 2 of 31 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 0.85s]
08:12:56.992104 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
08:12:56.993100 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
08:12:56.993100 [info ] [Thread-4  ]: 3 of 31 START view model DEMO.v_stg_transactions ............................... [RUN]
08:12:56.994102 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:56.995102 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
08:12:56.995102 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
08:12:57.062789 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:57.063866 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
08:12:57.063866 [debug] [Thread-4  ]: Opening a new connection, currently in state init
08:12:57.150863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A510760>]}
08:12:57.151861 [info ] [Thread-1  ]: 1 of 31 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 1.02s]
08:12:57.153234 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
08:12:57.153737 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
08:12:57.154769 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
08:12:57.154769 [info ] [Thread-2  ]: 4 of 31 START view model DEMO.raw_inventory .................................... [RUN]
08:12:57.155807 [info ] [Thread-3  ]: 5 of 31 START view model DEMO.v_stg_orders ..................................... [RUN]
08:12:57.157696 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
08:12:57.158699 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
08:12:57.158699 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
08:12:57.167337 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
08:12:57.168260 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:57.168260 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
08:12:57.169263 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
08:12:57.188495 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:57.188495 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
08:12:57.189462 [debug] [Thread-3  ]: Opening a new connection, currently in state init
08:12:57.189462 [debug] [Thread-2  ]: finished collecting timing info
08:12:57.194404 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
08:12:57.203003 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
08:12:57.210886 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
08:12:57.211556 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
08:12:57.212049 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:12:57.565286 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.5 seconds
08:12:57.628558 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:57.629560 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
08:12:57.756640 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.12 seconds
08:12:57.766413 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.58 seconds
08:12:57.916230 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:57.931090 [debug] [Thread-4  ]: finished collecting timing info
08:12:57.932122 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
08:12:57.938120 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:57.950191 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:57.951128 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
08:12:57.955116 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
08:12:57.956116 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
08:12:58.066605 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.12 seconds
08:12:58.108766 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.9 seconds
08:12:58.114764 [debug] [Thread-2  ]: finished collecting timing info
08:12:58.118763 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
08:12:58.192997 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.24 seconds
08:12:58.195076 [debug] [Thread-4  ]: finished collecting timing info
08:12:58.197998 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
08:12:58.314347 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:58.316271 [debug] [Thread-3  ]: finished collecting timing info
08:12:58.317271 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A5B86D0>]}
08:12:58.317271 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
08:12:58.317271 [info ] [Thread-2  ]: 4 of 31 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 1.16s]
08:12:58.321361 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:58.323290 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
08:12:58.323290 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
08:12:58.324379 [info ] [Thread-1  ]: 6 of 31 START view model DEMO.v_stg_inventory .................................. [RUN]
08:12:58.334350 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
08:12:58.334350 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
08:12:58.335365 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:58.335365 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
08:12:58.336360 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
08:12:58.346336 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:58.346336 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
08:12:58.346336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:12:58.398975 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B6E4DF0>]}
08:12:58.399998 [info ] [Thread-4  ]: 3 of 31 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.40s]
08:12:58.400995 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
08:12:58.402010 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
08:12:58.402010 [info ] [Thread-2  ]: 7 of 31 START incremental model DEMO.t_link_transactions ....................... [RUN]
08:12:58.403000 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
08:12:58.403000 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
08:12:58.404000 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
08:12:58.505503 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
08:12:58.542989 [debug] [Thread-2  ]: finished collecting timing info
08:12:58.542989 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
08:12:58.588311 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
08:12:58.590772 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
08:12:58.590772 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
08:12:58.591826 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:12:58.737175 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.4 seconds
08:12:58.740175 [debug] [Thread-3  ]: finished collecting timing info
08:12:58.741604 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
08:12:58.883152 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A5A09D0>]}
08:12:58.883152 [info ] [Thread-3  ]: 5 of 31 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.72s]
08:12:58.884150 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
08:12:58.885161 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
08:12:58.885161 [info ] [Thread-4  ]: 8 of 31 START incremental model DEMO.hub_customer .............................. [RUN]
08:12:58.886151 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
08:12:58.886151 [info ] [Thread-3  ]: 9 of 31 START incremental model DEMO.hub_lineitem .............................. [RUN]
08:12:58.887151 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
08:12:58.887151 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
08:12:58.887151 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
08:12:58.897322 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
08:12:58.913080 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
08:12:58.925952 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
08:12:58.929099 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.58 seconds
08:12:59.017627 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
08:12:59.037390 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
08:12:59.068201 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:59.068201 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
08:12:59.069709 [debug] [Thread-4  ]: finished collecting timing info
08:12:59.069709 [debug] [Thread-3  ]: finished collecting timing info
08:12:59.071314 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
08:12:59.072286 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
08:12:59.078255 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
08:12:59.082288 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
08:12:59.087149 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
08:12:59.088147 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:12:59.088147 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
08:12:59.091146 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
08:12:59.092160 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:12:59.092160 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:12:59.185313 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.12 seconds
08:12:59.355897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:59.385533 [debug] [Thread-1  ]: finished collecting timing info
08:12:59.385533 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
08:12:59.389612 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:59.397224 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
08:12:59.397224 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
08:12:59.708221 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.31 seconds
08:12:59.710222 [debug] [Thread-1  ]: finished collecting timing info
08:12:59.711222 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
08:12:59.898263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B6DF4F0>]}
08:12:59.899568 [info ] [Thread-1  ]: 6 of 31 OK created view model DEMO.v_stg_inventory ............................. [[32mSUCCESS 1[0m in 1.56s]
08:12:59.900726 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
08:12:59.901636 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
08:12:59.903630 [info ] [Thread-1  ]: 10 of 31 START incremental model DEMO.hub_order ................................ [RUN]
08:12:59.939442 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
08:12:59.939442 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
08:12:59.940524 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
08:12:59.964053 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
08:12:59.967042 [debug] [Thread-1  ]: finished collecting timing info
08:12:59.968042 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
08:12:59.973122 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
08:12:59.976035 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
08:12:59.977038 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:12:59.978038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:01.576546 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.98 seconds
08:13:01.586620 [debug] [Thread-2  ]: finished collecting timing info
08:13:01.587540 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
08:13:01.748826 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B7A2F70>]}
08:13:01.749834 [info ] [Thread-2  ]: 7 of 31 OK created incremental model DEMO.t_link_transactions .................. [[32mSUCCESS 1[0m in 3.35s]
08:13:01.751832 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
08:13:01.752885 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
08:13:01.753866 [info ] [Thread-2  ]: 11 of 31 START incremental model DEMO.link_customer_nation ..................... [RUN]
08:13:01.754833 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
08:13:01.755826 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
08:13:01.755826 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
08:13:01.815036 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
08:13:01.818006 [debug] [Thread-2  ]: finished collecting timing info
08:13:01.818962 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
08:13:01.822038 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
08:13:01.827367 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
08:13:01.828362 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:01.828362 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:03.056993 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.96 seconds
08:13:03.058512 [debug] [Thread-3  ]: finished collecting timing info
08:13:03.059516 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
08:13:03.207043 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B7C3EB0>]}
08:13:03.208031 [info ] [Thread-3  ]: 9 of 31 OK created incremental model DEMO.hub_lineitem ......................... [[32mSUCCESS 1[0m in 4.31s]
08:13:03.210200 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
08:13:03.210696 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
08:13:03.211938 [info ] [Thread-3  ]: 12 of 31 START incremental model DEMO.link_customer_order ...................... [RUN]
08:13:03.213959 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
08:13:03.213959 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
08:13:03.214965 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
08:13:03.235644 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
08:13:03.238654 [debug] [Thread-3  ]: finished collecting timing info
08:13:03.238654 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
08:13:03.245650 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
08:13:03.250655 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
08:13:03.250655 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:03.251639 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:13:03.488663 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.51 seconds
08:13:03.492657 [debug] [Thread-1  ]: finished collecting timing info
08:13:03.493657 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
08:13:03.639111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B7448B0>]}
08:13:03.640111 [info ] [Thread-1  ]: 10 of 31 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 3.70s]
08:13:03.642035 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
08:13:03.642035 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
08:13:03.642035 [info ] [Thread-1  ]: 13 of 31 START incremental model DEMO.link_inventory_allocation ................ [RUN]
08:13:03.644035 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
08:13:03.644035 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
08:13:03.645114 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
08:13:03.678378 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
08:13:03.716092 [debug] [Thread-1  ]: finished collecting timing info
08:13:03.717097 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
08:13:03.723426 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
08:13:03.727834 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
08:13:03.728869 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:03.728869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:03.752548 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.92 seconds
08:13:03.756499 [debug] [Thread-2  ]: finished collecting timing info
08:13:03.757569 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
08:13:03.915440 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A506C40>]}
08:13:03.916462 [info ] [Thread-2  ]: 11 of 31 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 2.16s]
08:13:03.917420 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
08:13:03.918422 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
08:13:03.919425 [info ] [Thread-2  ]: 14 of 31 START incremental model DEMO.link_order_lineitem ...................... [RUN]
08:13:03.920421 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
08:13:03.920421 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
08:13:03.931211 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
08:13:03.956113 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
08:13:03.995571 [debug] [Thread-2  ]: finished collecting timing info
08:13:03.996572 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
08:13:04.002402 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
08:13:04.005434 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
08:13:04.005434 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:04.005434 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:04.947447 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.7 seconds
08:13:04.948481 [debug] [Thread-3  ]: finished collecting timing info
08:13:04.949538 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
08:13:05.104166 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B7C3B80>]}
08:13:05.104166 [info ] [Thread-3  ]: 12 of 31 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 1.89s]
08:13:05.106163 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
08:13:05.106932 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
08:13:05.106932 [info ] [Thread-3  ]: 15 of 31 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
08:13:05.109177 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
08:13:05.109177 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
08:13:05.109177 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
08:13:05.171569 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
08:13:05.175474 [debug] [Thread-3  ]: finished collecting timing info
08:13:05.175474 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
08:13:05.180548 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
08:13:05.184402 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
08:13:05.184980 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:05.184980 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:13:05.916012 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.19 seconds
08:13:05.919568 [debug] [Thread-1  ]: finished collecting timing info
08:13:05.920569 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
08:13:06.068502 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.06 seconds
08:13:06.071503 [debug] [Thread-2  ]: finished collecting timing info
08:13:06.072502 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
08:13:06.080105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B6E0940>]}
08:13:06.081344 [info ] [Thread-1  ]: 13 of 31 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 2.44s]
08:13:06.083370 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
08:13:06.083944 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
08:13:06.084939 [info ] [Thread-1  ]: 16 of 31 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
08:13:06.086953 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
08:13:06.086953 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
08:13:06.086953 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
08:13:06.124689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
08:13:06.128029 [debug] [Thread-1  ]: finished collecting timing info
08:13:06.128481 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
08:13:06.135374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
08:13:06.140374 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
08:13:06.140374 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:06.140374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:06.223184 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B74F9D0>]}
08:13:06.223687 [info ] [Thread-2  ]: 14 of 31 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 2.30s]
08:13:06.224709 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
08:13:06.225714 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
08:13:06.226631 [info ] [Thread-2  ]: 17 of 31 START incremental model DEMO.sat_order_customer_details ............... [RUN]
08:13:06.227904 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
08:13:06.228757 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
08:13:06.229257 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
08:13:06.250299 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
08:13:06.252496 [debug] [Thread-2  ]: finished collecting timing info
08:13:06.252496 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
08:13:06.258851 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
08:13:06.262875 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
08:13:06.263882 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:06.263882 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:07.124976 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.94 seconds
08:13:07.129899 [debug] [Thread-3  ]: finished collecting timing info
08:13:07.129899 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
08:13:07.265013 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 8.18 seconds
08:13:07.267227 [debug] [Thread-4  ]: finished collecting timing info
08:13:07.268391 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
08:13:07.286290 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A630490>]}
08:13:07.287293 [info ] [Thread-3  ]: 15 of 31 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 2.18s]
08:13:07.289213 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
08:13:07.290212 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
08:13:07.291211 [info ] [Thread-3  ]: 18 of 31 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
08:13:07.293787 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
08:13:07.294942 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
08:13:07.294942 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
08:13:07.333580 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
08:13:07.339494 [debug] [Thread-3  ]: finished collecting timing info
08:13:07.340137 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
08:13:07.345551 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
08:13:07.349547 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
08:13:07.349547 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:07.350549 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:13:07.425862 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B7C39D0>]}
08:13:07.426359 [info ] [Thread-4  ]: 8 of 31 OK created incremental model DEMO.hub_customer ......................... [[32mSUCCESS 1[0m in 8.54s]
08:13:07.428970 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
08:13:07.429479 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
08:13:07.429479 [info ] [Thread-4  ]: 19 of 31 START incremental model DEMO.sat_order_order_details .................. [RUN]
08:13:07.431513 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
08:13:07.431513 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
08:13:07.432514 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
08:13:07.464054 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
08:13:07.467270 [debug] [Thread-4  ]: finished collecting timing info
08:13:07.467270 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
08:13:07.474131 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
08:13:07.478085 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
08:13:07.478085 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:07.478085 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
08:13:08.319552 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.18 seconds
08:13:08.322551 [debug] [Thread-1  ]: finished collecting timing info
08:13:08.323551 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
08:13:08.481574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B80D1C0>]}
08:13:08.482576 [info ] [Thread-1  ]: 16 of 31 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 2.40s]
08:13:08.483573 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
08:13:08.484566 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
08:13:08.485571 [info ] [Thread-1  ]: 20 of 31 START incremental model DEMO.hub_nation ............................... [RUN]
08:13:08.486568 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
08:13:08.487571 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
08:13:08.488587 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
08:13:08.516836 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
08:13:08.553812 [debug] [Thread-1  ]: finished collecting timing info
08:13:08.554879 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
08:13:08.562804 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
08:13:08.566888 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
08:13:08.567882 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
08:13:08.567882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:08.667079 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.4 seconds
08:13:08.668079 [debug] [Thread-2  ]: finished collecting timing info
08:13:08.669078 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
08:13:08.813254 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B8DCCD0>]}
08:13:08.814266 [info ] [Thread-2  ]: 17 of 31 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 2.59s]
08:13:08.815255 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
08:13:08.816261 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_part
08:13:08.816261 [info ] [Thread-2  ]: 21 of 31 START incremental model DEMO.hub_part ................................. [RUN]
08:13:08.818431 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
08:13:08.818431 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
08:13:08.818431 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_part
08:13:08.902902 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
08:13:08.905903 [debug] [Thread-2  ]: finished collecting timing info
08:13:08.905903 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
08:13:08.909907 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
08:13:08.913466 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
08:13:08.913466 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
08:13:08.914465 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:11.485688 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.01 seconds
08:13:11.488937 [debug] [Thread-4  ]: finished collecting timing info
08:13:11.489936 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
08:13:11.717295 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B93FF70>]}
08:13:11.718285 [info ] [Thread-4  ]: 19 of 31 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 4.29s]
08:13:11.720294 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
08:13:11.721283 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
08:13:11.722291 [info ] [Thread-4  ]: 22 of 31 START incremental model DEMO.hub_region ............................... [RUN]
08:13:11.723286 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
08:13:11.724291 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
08:13:11.725304 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_region
08:13:11.756325 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
08:13:11.794634 [debug] [Thread-4  ]: finished collecting timing info
08:13:11.795599 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
08:13:11.806132 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
08:13:11.812530 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
08:13:11.813011 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
08:13:11.813179 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
08:13:12.507132 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.16 seconds
08:13:12.509133 [debug] [Thread-3  ]: finished collecting timing info
08:13:12.510132 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
08:13:12.716822 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B902DF0>]}
08:13:12.717824 [info ] [Thread-3  ]: 18 of 31 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 5.42s]
08:13:12.719825 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
08:13:12.720831 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
08:13:12.720831 [info ] [Thread-3  ]: 23 of 31 START incremental model DEMO.hub_supplier ............................. [RUN]
08:13:12.722826 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
08:13:12.723824 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
08:13:12.723824 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
08:13:12.758062 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
08:13:12.761724 [debug] [Thread-3  ]: finished collecting timing info
08:13:12.762918 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
08:13:12.769904 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
08:13:12.772902 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
08:13:12.772902 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
08:13:12.773909 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:13:14.979412 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.41 seconds
08:13:14.982842 [debug] [Thread-1  ]: finished collecting timing info
08:13:14.983989 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
08:13:15.152368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B825D30>]}
08:13:15.153304 [info ] [Thread-1  ]: 20 of 31 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 6.67s]
08:13:15.155125 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
08:13:15.156010 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
08:13:15.157019 [info ] [Thread-1  ]: 24 of 31 START incremental model DEMO.link_inventory ........................... [RUN]
08:13:15.159063 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
08:13:15.159699 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
08:13:15.160206 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
08:13:15.187869 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
08:13:15.190878 [debug] [Thread-1  ]: finished collecting timing info
08:13:15.190878 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
08:13:15.197875 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
08:13:15.200951 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
08:13:15.200951 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:15.202012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:15.598565 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 6.68 seconds
08:13:15.601581 [debug] [Thread-2  ]: finished collecting timing info
08:13:15.601581 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: Close
08:13:15.770836 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B964100>]}
08:13:15.771842 [info ] [Thread-2  ]: 21 of 31 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 6.95s]
08:13:15.773756 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
08:13:15.774758 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
08:13:15.774758 [info ] [Thread-2  ]: 25 of 31 START incremental model DEMO.link_nation_region ....................... [RUN]
08:13:15.776758 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
08:13:15.776758 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
08:13:15.777764 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
08:13:15.805805 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
08:13:15.808791 [debug] [Thread-2  ]: finished collecting timing info
08:13:15.808791 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
08:13:15.816667 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
08:13:15.824072 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
08:13:15.825071 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
08:13:15.825071 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:17.291301 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.48 seconds
08:13:17.296305 [debug] [Thread-4  ]: finished collecting timing info
08:13:17.296305 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: Close
08:13:17.450446 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B752D60>]}
08:13:17.451771 [info ] [Thread-4  ]: 22 of 31 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 5.73s]
08:13:17.452860 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
08:13:17.453801 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
08:13:17.454802 [info ] [Thread-4  ]: 26 of 31 START incremental model DEMO.link_supplier_nation ..................... [RUN]
08:13:17.455801 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
08:13:17.455801 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
08:13:17.455801 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
08:13:17.474023 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
08:13:17.475729 [debug] [Thread-4  ]: finished collecting timing info
08:13:17.476103 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
08:13:17.481599 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
08:13:17.486396 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
08:13:17.487738 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
08:13:17.488238 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
08:13:18.385384 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.61 seconds
08:13:18.389180 [debug] [Thread-3  ]: finished collecting timing info
08:13:18.389935 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
08:13:18.548939 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B902C10>]}
08:13:18.729838 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.53 seconds
08:13:18.731839 [debug] [Thread-1  ]: finished collecting timing info
08:13:18.731839 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
08:13:18.880255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F24610>]}
08:13:19.753659 [info ] [Thread-3  ]: 23 of 31 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 5.83s]
08:13:19.754613 [info ] [Thread-1  ]: 24 of 31 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 3.72s]
08:13:19.757288 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
08:13:19.757288 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
08:13:19.758288 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
08:13:19.759299 [info ] [Thread-3  ]: 27 of 31 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
08:13:19.760288 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
08:13:19.761286 [info ] [Thread-1  ]: 28 of 31 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
08:13:19.762289 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
08:13:19.763287 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
08:13:19.764287 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
08:13:19.778867 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
08:13:19.779867 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
08:13:19.779867 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
08:13:19.811294 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
08:13:19.825718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
08:13:19.826720 [debug] [Thread-3  ]: finished collecting timing info
08:13:19.826720 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
08:13:19.830803 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
08:13:19.831722 [debug] [Thread-1  ]: finished collecting timing info
08:13:19.832720 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
08:13:19.835721 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
08:13:19.837720 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
08:13:19.838722 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:19.838722 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
08:13:19.841739 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
08:13:19.841739 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:19.842722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:20.594617 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.77 seconds
08:13:20.599253 [debug] [Thread-2  ]: finished collecting timing info
08:13:20.600088 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
08:13:20.758659 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A66BD60>]}
08:13:20.759738 [info ] [Thread-2  ]: 25 of 31 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 4.98s]
08:13:20.761038 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
08:13:20.762058 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
08:13:20.762058 [info ] [Thread-2  ]: 29 of 31 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
08:13:20.764057 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
08:13:20.764057 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
08:13:20.765056 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
08:13:20.806290 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
08:13:20.808287 [debug] [Thread-2  ]: finished collecting timing info
08:13:20.809297 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
08:13:20.818339 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
08:13:20.857651 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
08:13:20.858653 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:20.858653 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
08:13:21.842219 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.35 seconds
08:13:21.845895 [debug] [Thread-4  ]: finished collecting timing info
08:13:21.845895 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
08:13:22.003300 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A61B340>]}
08:13:22.003300 [info ] [Thread-4  ]: 26 of 31 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 4.55s]
08:13:22.005951 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
08:13:22.006231 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
08:13:22.007341 [info ] [Thread-4  ]: 30 of 31 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
08:13:22.009340 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
08:13:22.010449 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
08:13:22.010677 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
08:13:22.041944 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
08:13:22.044980 [debug] [Thread-4  ]: finished collecting timing info
08:13:22.045526 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
08:13:22.053043 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
08:13:22.057042 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
08:13:22.057042 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:22.057042 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
08:13:23.255565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.41 seconds
08:13:23.259688 [debug] [Thread-1  ]: finished collecting timing info
08:13:23.260651 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
08:13:23.420305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A56F340>]}
08:13:23.420799 [info ] [Thread-1  ]: 28 of 31 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 3.64s]
08:13:23.422082 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
08:13:23.424171 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
08:13:23.424915 [info ] [Thread-1  ]: 31 of 31 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
08:13:23.426908 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
08:13:23.426908 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
08:13:23.427453 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
08:13:23.459001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
08:13:23.461962 [debug] [Thread-1  ]: finished collecting timing info
08:13:23.461962 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
08:13:23.468983 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
08:13:23.473485 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
08:13:23.473485 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
08:13:23.473485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:24.378469 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.54 seconds
08:13:24.382713 [debug] [Thread-3  ]: finished collecting timing info
08:13:24.383703 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
08:13:24.548219 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A4FEAF0>]}
08:13:24.550276 [info ] [Thread-3  ]: 27 of 31 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 4.79s]
08:13:24.551217 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
08:13:24.912283 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.86 seconds
08:13:24.916784 [debug] [Thread-4  ]: finished collecting timing info
08:13:24.916784 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
08:13:25.071893 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B78C0D0>]}
08:13:25.071893 [info ] [Thread-4  ]: 30 of 31 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 3.06s]
08:13:25.073888 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
08:13:26.547478 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.07 seconds
08:13:26.551931 [debug] [Thread-1  ]: finished collecting timing info
08:13:26.551931 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
08:13:26.719052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A65E8E0>]}
08:13:26.720057 [info ] [Thread-1  ]: 31 of 31 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 3.29s]
08:13:26.721058 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
08:13:29.442659 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 8.58 seconds
08:13:29.445657 [debug] [Thread-2  ]: finished collecting timing info
08:13:29.446660 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
08:13:29.593208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '414a8a1c-cb1d-47ff-8fcd-ee114adeb847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B806640>]}
08:13:29.594123 [info ] [Thread-2  ]: 29 of 31 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 8.83s]
08:13:29.595122 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
08:13:29.601131 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:13:29.603210 [info ] [MainThread]: 
08:13:29.604206 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 35.51s.
08:13:29.605130 [debug] [MainThread]: Connection 'master' was properly closed.
08:13:29.606159 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
08:13:29.606159 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
08:13:29.607122 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
08:13:29.607122 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
08:13:29.607122 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
08:13:29.608131 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
08:13:29.638839 [info ] [MainThread]: 
08:13:29.639981 [info ] [MainThread]: [32mCompleted successfully[0m
08:13:29.641031 [info ] [MainThread]: 
08:13:29.642035 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
08:13:29.642035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A519100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A5251F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094B670C70>]}


============================== 2022-05-11 14:24:58.715694 | affd29ab-1d89-4ee5-977b-320939356278 ==============================
14:24:58.715694 [info ] [MainThread]: Running with dbt=1.1.0
14:24:58.717207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:24:58.717207 [debug] [MainThread]: Tracking: tracking
14:24:58.718283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B401EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B4015B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B401D90>]}
14:25:00.375752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:25:00.375752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:25:00.391677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B49EFD0>]}
14:25:00.428186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B3865B0>]}
14:25:00.428186 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
14:25:00.428186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B390190>]}
14:25:00.442233 [info ] [MainThread]: 
14:25:00.442962 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:25:00.446956 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
14:25:00.457957 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
14:25:00.459110 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
14:25:00.459110 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:01.492287 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.03 seconds
14:25:01.492287 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
14:25:01.661190 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
14:25:01.677188 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
14:25:01.677188 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
14:25:01.677188 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:02.214976 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.54 seconds
14:25:02.214976 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
14:25:02.373281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B986D00>]}
14:25:02.373978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
14:25:02.373978 [info ] [MainThread]: 
14:25:02.398008 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
14:25:02.398008 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
14:25:02.399005 [info ] [Thread-1  ]: 1 of 31 START view model DEMO.raw_orders ....................................... [RUN]
14:25:02.399005 [info ] [Thread-2  ]: 2 of 31 START view model DEMO.raw_transactions ................................. [RUN]
14:25:02.400012 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
14:25:02.401097 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
14:25:02.401097 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
14:25:02.406004 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
14:25:02.406004 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
14:25:02.407112 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
14:25:02.407112 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
14:25:02.411049 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
14:25:02.414466 [debug] [Thread-1  ]: finished collecting timing info
14:25:02.414466 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
14:25:02.425623 [debug] [Thread-2  ]: finished collecting timing info
14:25:02.435749 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
14:25:02.435749 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
14:25:02.438756 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
14:25:02.441875 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
14:25:02.444997 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
14:25:02.444997 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
14:25:02.444997 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
14:25:02.445898 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:25:02.445898 [debug] [Thread-1  ]: Opening a new connection, currently in state init
14:25:03.081205 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.64 seconds
14:25:03.081205 [debug] [Thread-2  ]: finished collecting timing info
14:25:03.081205 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
14:25:03.134970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:25:03.134970 [debug] [Thread-1  ]: finished collecting timing info
14:25:03.134970 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
14:25:03.218298 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B9EA1F0>]}
14:25:03.218298 [info ] [Thread-2  ]: 2 of 31 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 0.81s]
14:25:03.218298 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
14:25:03.218298 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
14:25:03.228973 [info ] [Thread-4  ]: 3 of 31 START view model DEMO.v_stg_transactions ............................... [RUN]
14:25:03.228973 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.229971 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
14:25:03.229971 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
14:25:03.259399 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.260399 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
14:25:03.260399 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:25:03.280023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B39D490>]}
14:25:03.280023 [info ] [Thread-1  ]: 1 of 31 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 0.88s]
14:25:03.280980 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
14:25:03.281931 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
14:25:03.281931 [info ] [Thread-2  ]: 4 of 31 START view model DEMO.raw_inventory .................................... [RUN]
14:25:03.281931 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
14:25:03.281931 [info ] [Thread-3  ]: 5 of 31 START view model DEMO.v_stg_orders ..................................... [RUN]
14:25:03.282931 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
14:25:03.282931 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
14:25:03.283932 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
14:25:03.289017 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
14:25:03.289932 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:03.289932 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
14:25:03.289932 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
14:25:03.298563 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:03.298563 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
14:25:03.298563 [debug] [Thread-3  ]: Opening a new connection, currently in state init
14:25:03.300563 [debug] [Thread-2  ]: finished collecting timing info
14:25:03.301562 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
14:25:03.304212 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
14:25:03.307212 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
14:25:03.307212 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
14:25:03.308328 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:03.665291 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.4 seconds
14:25:03.726472 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.726472 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
14:25:03.798843 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.5 seconds
14:25:03.818569 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:03.818569 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
14:25:03.834953 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.11 seconds
14:25:03.884807 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.884807 [debug] [Thread-4  ]: finished collecting timing info
14:25:03.884807 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
14:25:03.884807 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.900837 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
14:25:03.900837 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
14:25:03.941279 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.12 seconds
14:25:04.035511 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:04.035511 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.73 seconds
14:25:04.035511 [debug] [Thread-2  ]: finished collecting timing info
14:25:04.035511 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
14:25:04.035511 [debug] [Thread-3  ]: finished collecting timing info
14:25:04.035511 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
14:25:04.035511 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:04.051260 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
14:25:04.051260 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
14:25:04.182516 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA21250>]}
14:25:04.182516 [info ] [Thread-2  ]: 4 of 31 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 0.90s]
14:25:04.182516 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
14:25:04.197005 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
14:25:04.197005 [info ] [Thread-1  ]: 6 of 31 START view model DEMO.v_stg_inventory .................................. [RUN]
14:25:04.198559 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.198948 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
14:25:04.198948 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
14:25:04.211271 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.212058 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
14:25:04.212075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:04.229308 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.33 seconds
14:25:04.230400 [debug] [Thread-4  ]: finished collecting timing info
14:25:04.230400 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
14:25:04.371969 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CB493A0>]}
14:25:04.371969 [info ] [Thread-4  ]: 3 of 31 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.14s]
14:25:04.371969 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
14:25:04.371969 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
14:25:04.371969 [info ] [Thread-2  ]: 7 of 31 START incremental model DEMO.t_link_transactions ....................... [RUN]
14:25:04.380705 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
14:25:04.380705 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
14:25:04.381732 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
14:25:04.435543 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.38 seconds
14:25:04.446591 [debug] [Thread-3  ]: finished collecting timing info
14:25:04.446591 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
14:25:04.495230 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
14:25:04.499694 [debug] [Thread-2  ]: finished collecting timing info
14:25:04.499694 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
14:25:04.536181 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
14:25:04.536181 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
14:25:04.536181 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.t_link_transactions  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert
      );
14:25:04.536181 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:04.620006 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA8BF70>]}
14:25:04.620006 [info ] [Thread-3  ]: 5 of 31 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.33s]
14:25:04.620006 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
14:25:04.636808 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
14:25:04.636808 [info ] [Thread-4  ]: 8 of 31 START incremental model DEMO.hub_customer .............................. [RUN]
14:25:04.638072 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
14:25:04.639033 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
14:25:04.639534 [info ] [Thread-3  ]: 9 of 31 START incremental model DEMO.hub_lineitem .............................. [RUN]
14:25:04.641559 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
14:25:04.641559 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
14:25:04.666388 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
14:25:04.666388 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
14:25:04.667308 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
14:25:04.667308 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
14:25:04.677309 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
14:25:04.677309 [debug] [Thread-4  ]: finished collecting timing info
14:25:04.678308 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
14:25:04.681393 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
14:25:04.681393 [debug] [Thread-3  ]: finished collecting timing info
14:25:04.681393 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
14:25:04.685088 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
14:25:04.686999 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
14:25:04.686999 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_customer  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:04.686999 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:04.687999 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
14:25:04.687999 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:04.689010 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:04.772172 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.56 seconds
14:25:04.785966 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.785966 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
14:25:04.907029 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.12 seconds
14:25:04.967730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.967730 [debug] [Thread-1  ]: finished collecting timing info
14:25:04.967730 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
14:25:04.967730 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.983400 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
14:25:04.983400 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
14:25:05.337267 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.35 seconds
14:25:05.337267 [debug] [Thread-1  ]: finished collecting timing info
14:25:05.337267 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
14:25:05.484184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAE1CA0>]}
14:25:05.484184 [info ] [Thread-1  ]: 6 of 31 OK created view model DEMO.v_stg_inventory ............................. [[32mSUCCESS 1[0m in 1.29s]
14:25:05.484184 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
14:25:05.484184 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
14:25:05.491805 [info ] [Thread-1  ]: 10 of 31 START incremental model DEMO.hub_order ................................ [RUN]
14:25:05.492804 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
14:25:05.492804 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
14:25:05.492804 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
14:25:05.501925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
14:25:05.513460 [debug] [Thread-1  ]: finished collecting timing info
14:25:05.513460 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
14:25:05.516466 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
14:25:05.517405 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
14:25:05.518415 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:05.518415 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:09.363470 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.68 seconds
14:25:09.379211 [debug] [Thread-4  ]: finished collecting timing info
14:25:09.379211 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
14:25:09.532625 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B390BE0>]}
14:25:09.532625 [info ] [Thread-4  ]: 8 of 31 OK created incremental model DEMO.hub_customer ......................... [[32mSUCCESS 1[0m in 4.89s]
14:25:09.532625 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
14:25:09.532625 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
14:25:09.541965 [info ] [Thread-4  ]: 11 of 31 START incremental model DEMO.link_customer_nation ..................... [RUN]
14:25:09.541965 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
14:25:09.541965 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
14:25:09.541965 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
14:25:09.567690 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
14:25:09.579892 [debug] [Thread-4  ]: finished collecting timing info
14:25:09.579892 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
14:25:09.582984 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
14:25:09.585901 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
14:25:09.586944 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:09.586944 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:10.609161 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.09 seconds
14:25:10.609161 [debug] [Thread-1  ]: finished collecting timing info
14:25:10.609161 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
14:25:10.750923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CBEDA90>]}
14:25:10.766430 [info ] [Thread-1  ]: 10 of 31 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 5.26s]
14:25:10.766430 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
14:25:10.766430 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
14:25:10.766430 [info ] [Thread-1  ]: 12 of 31 START incremental model DEMO.link_customer_order ...................... [RUN]
14:25:10.768991 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
14:25:10.768991 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
14:25:10.768991 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
14:25:10.779837 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
14:25:10.781867 [debug] [Thread-1  ]: finished collecting timing info
14:25:10.782009 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
14:25:10.784525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
14:25:10.786152 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
14:25:10.787240 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_customer_order  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:10.787240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:10.861365 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.17 seconds
14:25:10.862502 [debug] [Thread-3  ]: finished collecting timing info
14:25:10.862502 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
14:25:11.015256 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B695E80>]}
14:25:11.015256 [info ] [Thread-3  ]: 9 of 31 OK created incremental model DEMO.hub_lineitem ......................... [[32mSUCCESS 1[0m in 6.35s]
14:25:11.025985 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
14:25:11.025985 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
14:25:11.025985 [info ] [Thread-3  ]: 13 of 31 START incremental model DEMO.link_inventory_allocation ................ [RUN]
14:25:11.027560 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
14:25:11.027560 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
14:25:11.027560 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
14:25:11.036647 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
14:25:11.037655 [debug] [Thread-3  ]: finished collecting timing info
14:25:11.037655 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
14:25:11.040562 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
14:25:11.042562 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
14:25:11.043562 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:11.043562 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:11.852992 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 7.32 seconds
14:25:11.854176 [debug] [Thread-2  ]: finished collecting timing info
14:25:11.854176 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
14:25:12.016633 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA0D6A0>]}
14:25:12.016633 [info ] [Thread-2  ]: 7 of 31 OK created incremental model DEMO.t_link_transactions .................. [[32mSUCCESS 1[0m in 7.64s]
14:25:12.016633 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
14:25:12.016633 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
14:25:12.030345 [info ] [Thread-2  ]: 14 of 31 START incremental model DEMO.link_order_lineitem ...................... [RUN]
14:25:12.032011 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
14:25:12.032477 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
14:25:12.032477 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
14:25:12.044089 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
14:25:12.045680 [debug] [Thread-2  ]: finished collecting timing info
14:25:12.046695 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
14:25:12.048772 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
14:25:12.051940 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
14:25:12.051940 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_order_lineitem  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:12.051940 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:12.064943 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.48 seconds
14:25:12.065945 [debug] [Thread-4  ]: finished collecting timing info
14:25:12.065945 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
14:25:12.270695 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC97550>]}
14:25:12.270695 [info ] [Thread-4  ]: 11 of 31 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 2.73s]
14:25:12.270695 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
14:25:12.270695 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
14:25:12.270695 [info ] [Thread-4  ]: 15 of 31 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
14:25:12.283647 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
14:25:12.284644 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
14:25:12.284644 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
14:25:12.318663 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
14:25:12.340828 [debug] [Thread-4  ]: finished collecting timing info
14:25:12.341827 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
14:25:12.345826 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
14:25:12.348438 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
14:25:12.349540 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:12.349540 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:14.008414 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.22 seconds
14:25:14.024083 [debug] [Thread-1  ]: finished collecting timing info
14:25:14.024083 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
14:25:14.179716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC322B0>]}
14:25:14.180048 [info ] [Thread-1  ]: 12 of 31 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 3.41s]
14:25:14.180612 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
14:25:14.181081 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
14:25:14.181622 [info ] [Thread-1  ]: 16 of 31 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
14:25:14.182532 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
14:25:14.182532 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
14:25:14.183083 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
14:25:14.200904 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
14:25:14.202712 [debug] [Thread-1  ]: finished collecting timing info
14:25:14.202712 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
14:25:14.205713 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
14:25:14.208627 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
14:25:14.209128 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:14.209128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:14.605857 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.56 seconds
14:25:14.605857 [debug] [Thread-3  ]: finished collecting timing info
14:25:14.605857 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
14:25:14.710978 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.36 seconds
14:25:14.710978 [debug] [Thread-4  ]: finished collecting timing info
14:25:14.710978 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
14:25:14.761418 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA54C10>]}
14:25:14.761418 [info ] [Thread-3  ]: 13 of 31 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 3.73s]
14:25:14.761418 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
14:25:14.761418 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
14:25:14.761418 [info ] [Thread-3  ]: 17 of 31 START incremental model DEMO.sat_order_customer_details ............... [RUN]
14:25:14.771690 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
14:25:14.771690 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
14:25:14.772688 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
14:25:14.774347 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
14:25:14.800160 [debug] [Thread-3  ]: finished collecting timing info
14:25:14.800160 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
14:25:14.800160 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
14:25:14.800160 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.75 seconds
14:25:14.800160 [debug] [Thread-2  ]: finished collecting timing info
14:25:14.800160 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
14:25:14.800160 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
14:25:14.800160 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:14.800160 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:14.882823 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAF1730>]}
14:25:14.883904 [info ] [Thread-4  ]: 15 of 31 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 2.60s]
14:25:14.884820 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
14:25:14.884820 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
14:25:14.885820 [info ] [Thread-4  ]: 18 of 31 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
14:25:14.886820 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
14:25:14.886820 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
14:25:14.886820 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
14:25:14.904561 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
14:25:14.905821 [debug] [Thread-4  ]: finished collecting timing info
14:25:14.905821 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
14:25:14.909843 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
14:25:14.911828 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
14:25:14.911828 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:14.911828 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:14.969588 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B845C10>]}
14:25:14.969588 [info ] [Thread-2  ]: 14 of 31 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 2.94s]
14:25:14.971579 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
14:25:14.972210 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
14:25:14.972459 [info ] [Thread-2  ]: 19 of 31 START incremental model DEMO.sat_order_order_details .................. [RUN]
14:25:14.973916 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
14:25:14.973916 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
14:25:14.973916 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
14:25:14.992971 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
14:25:14.993971 [debug] [Thread-2  ]: finished collecting timing info
14:25:14.993971 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
14:25:14.997975 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
14:25:15.000199 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
14:25:15.000199 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_order_order_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:15.000199 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:15.963783 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.75 seconds
14:25:15.963783 [debug] [Thread-1  ]: finished collecting timing info
14:25:15.963783 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
14:25:16.133630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAF12B0>]}
14:25:16.133630 [info ] [Thread-1  ]: 16 of 31 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 1.95s]
14:25:16.134959 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
14:25:16.134959 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
14:25:16.134959 [info ] [Thread-1  ]: 20 of 31 START incremental model DEMO.hub_nation ............................... [RUN]
14:25:16.136977 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
14:25:16.136977 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
14:25:16.137972 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
14:25:16.158089 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
14:25:16.171030 [debug] [Thread-1  ]: finished collecting timing info
14:25:16.171136 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
14:25:16.174864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
14:25:16.177234 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
14:25:16.177234 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
14:25:16.177234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:18.656129 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.86 seconds
14:25:18.656129 [debug] [Thread-3  ]: finished collecting timing info
14:25:18.656129 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
14:25:18.792757 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.79 seconds
14:25:18.792757 [debug] [Thread-2  ]: finished collecting timing info
14:25:18.792757 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
14:25:18.820657 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CD58310>]}
14:25:18.821057 [info ] [Thread-3  ]: 17 of 31 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 4.05s]
14:25:18.822105 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
14:25:18.822600 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_part
14:25:18.822600 [info ] [Thread-3  ]: 21 of 31 START incremental model DEMO.hub_part ................................. [RUN]
14:25:18.823894 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
14:25:18.823894 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
14:25:18.824397 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_part
14:25:18.834105 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
14:25:18.846451 [debug] [Thread-3  ]: finished collecting timing info
14:25:18.846451 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
14:25:18.848965 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
14:25:18.851966 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
14:25:18.851966 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_part  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
14:25:18.851966 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:19.135304 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAF1EB0>]}
14:25:19.135304 [info ] [Thread-2  ]: 19 of 31 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 4.16s]
14:25:19.145762 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
14:25:19.145762 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_region
14:25:19.145762 [info ] [Thread-2  ]: 22 of 31 START incremental model DEMO.hub_region ............................... [RUN]
14:25:19.156078 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
14:25:19.156078 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
14:25:19.156596 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_region
14:25:19.166245 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
14:25:19.168245 [debug] [Thread-2  ]: finished collecting timing info
14:25:19.168245 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
14:25:19.171330 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
14:25:19.174273 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
14:25:19.174273 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
14:25:19.174273 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:20.160343 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.25 seconds
14:25:20.176264 [debug] [Thread-4  ]: finished collecting timing info
14:25:20.176264 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
14:25:20.309782 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CD72FD0>]}
14:25:20.309782 [info ] [Thread-4  ]: 18 of 31 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 5.42s]
14:25:20.309782 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
14:25:20.309782 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
14:25:20.324061 [info ] [Thread-4  ]: 23 of 31 START incremental model DEMO.hub_supplier ............................. [RUN]
14:25:20.325348 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
14:25:20.325348 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
14:25:20.325348 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
14:25:20.336598 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
14:25:20.348981 [debug] [Thread-4  ]: finished collecting timing info
14:25:20.348981 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
14:25:20.351082 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
14:25:20.352988 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
14:25:20.352988 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.hub_supplier  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
14:25:20.352988 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:23.603090 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.75 seconds
14:25:23.603090 [debug] [Thread-3  ]: finished collecting timing info
14:25:23.603090 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: Close
14:25:23.686395 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.51 seconds
14:25:23.686395 [debug] [Thread-2  ]: finished collecting timing info
14:25:23.686395 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_region: Close
14:25:23.733262 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CD53700>]}
14:25:23.733262 [info ] [Thread-3  ]: 21 of 31 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 4.91s]
14:25:23.749309 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
14:25:23.749800 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
14:25:23.750655 [info ] [Thread-3  ]: 24 of 31 START incremental model DEMO.link_inventory ........................... [RUN]
14:25:23.754398 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
14:25:23.755314 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
14:25:23.755314 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
14:25:23.768397 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
14:25:23.770319 [debug] [Thread-3  ]: finished collecting timing info
14:25:23.770319 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
14:25:23.772393 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
14:25:23.774359 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
14:25:23.774359 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_inventory  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:23.774359 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:23.859267 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAD00D0>]}
14:25:23.871883 [info ] [Thread-2  ]: 22 of 31 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 4.70s]
14:25:23.871883 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
14:25:23.874444 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
14:25:23.874444 [info ] [Thread-2  ]: 25 of 31 START incremental model DEMO.link_nation_region ....................... [RUN]
14:25:23.875442 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
14:25:23.876578 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
14:25:23.876813 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
14:25:23.886896 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
14:25:23.887934 [debug] [Thread-2  ]: finished collecting timing info
14:25:23.887934 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
14:25:23.890902 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
14:25:23.895011 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
14:25:23.895011 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_nation_region  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
      );
14:25:23.895011 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:24.473854 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.12 seconds
14:25:24.473854 [debug] [Thread-4  ]: finished collecting timing info
14:25:24.473854 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
14:25:24.819960 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC24D30>]}
14:25:24.819960 [info ] [Thread-4  ]: 23 of 31 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 4.49s]
14:25:24.841150 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
14:25:24.841150 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
14:25:24.841150 [info ] [Thread-4  ]: 26 of 31 START incremental model DEMO.link_supplier_nation ..................... [RUN]
14:25:24.845243 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
14:25:24.845873 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
14:25:24.845873 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
14:25:24.858197 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
14:25:24.859222 [debug] [Thread-4  ]: finished collecting timing info
14:25:24.859222 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
14:25:24.862201 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
14:25:24.864224 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
14:25:24.864224 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.link_supplier_nation  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:25:24.864224 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:25.708256 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 9.53 seconds
14:25:25.724082 [debug] [Thread-1  ]: finished collecting timing info
14:25:25.724082 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
14:25:25.874928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CDD7610>]}
14:25:27.284475 [info ] [Thread-1  ]: 20 of 31 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 9.74s]
14:25:27.286483 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
14:25:27.286483 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
14:25:27.286483 [info ] [Thread-1  ]: 27 of 31 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
14:25:27.288493 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
14:25:27.288493 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
14:25:27.288493 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
14:25:27.310374 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
14:25:27.312375 [debug] [Thread-1  ]: finished collecting timing info
14:25:27.312375 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
14:25:27.319307 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
14:25:27.320875 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
14:25:27.320875 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:27.320875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:27.356458 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.58 seconds
14:25:27.357468 [debug] [Thread-3  ]: finished collecting timing info
14:25:27.357468 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
14:25:27.628863 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA86490>]}
14:25:27.628863 [info ] [Thread-3  ]: 24 of 31 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 3.87s]
14:25:27.628863 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
14:25:27.628863 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
14:25:27.628863 [info ] [Thread-3  ]: 28 of 31 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
14:25:27.635356 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
14:25:27.635356 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
14:25:27.635356 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
14:25:27.651898 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
14:25:27.652807 [debug] [Thread-3  ]: finished collecting timing info
14:25:27.652807 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
14:25:27.655895 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
14:25:27.656809 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
14:25:27.656809 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:27.656809 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:29.173301 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.31 seconds
14:25:29.173301 [debug] [Thread-4  ]: finished collecting timing info
14:25:29.173301 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
14:25:29.365813 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC10A00>]}
14:25:29.365813 [info ] [Thread-4  ]: 26 of 31 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 4.52s]
14:25:29.365813 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
14:25:29.365813 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
14:25:29.365813 [info ] [Thread-4  ]: 29 of 31 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
14:25:29.373895 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
14:25:29.373895 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
14:25:29.373895 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
14:25:29.387983 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
14:25:29.388892 [debug] [Thread-4  ]: finished collecting timing info
14:25:29.388892 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
14:25:29.390893 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
14:25:29.401783 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
14:25:29.401783 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:29.401783 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
14:25:29.732731 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.84 seconds
14:25:29.732731 [debug] [Thread-2  ]: finished collecting timing info
14:25:29.732731 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
14:25:29.885987 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA729D0>]}
14:25:29.885987 [info ] [Thread-2  ]: 25 of 31 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 6.01s]
14:25:29.885987 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
14:25:29.885987 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
14:25:29.901422 [info ] [Thread-2  ]: 30 of 31 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
14:25:29.903443 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
14:25:29.903443 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
14:25:29.903443 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
14:25:29.918293 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
14:25:29.929844 [debug] [Thread-2  ]: finished collecting timing info
14:25:29.929844 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
14:25:29.932939 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
14:25:29.934494 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
14:25:29.934494 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:29.934494 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:25:30.622102 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.97 seconds
14:25:30.622102 [debug] [Thread-3  ]: finished collecting timing info
14:25:30.622102 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
14:25:30.787976 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC77760>]}
14:25:30.787976 [info ] [Thread-3  ]: 28 of 31 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 3.15s]
14:25:30.787976 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
14:25:30.787976 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
14:25:30.787976 [info ] [Thread-3  ]: 31 of 31 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
14:25:30.796763 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
14:25:30.796763 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
14:25:30.796763 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
14:25:30.813991 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
14:25:30.824996 [debug] [Thread-3  ]: finished collecting timing info
14:25:30.824996 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
14:25:30.828005 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
14:25:30.831020 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
14:25:30.831020 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */


      create or replace transient table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
      );
14:25:30.832007 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
14:25:32.391896 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.99 seconds
14:25:32.391896 [debug] [Thread-4  ]: finished collecting timing info
14:25:32.407634 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
14:25:32.561686 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B39BE50>]}
14:25:32.562776 [info ] [Thread-4  ]: 29 of 31 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 3.19s]
14:25:32.563682 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
14:25:32.929587 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
14:25:32.945478 [debug] [Thread-2  ]: finished collecting timing info
14:25:32.945478 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
14:25:33.100953 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CB9EB20>]}
14:25:33.100953 [info ] [Thread-2  ]: 30 of 31 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 3.20s]
14:25:33.102156 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
14:25:34.062923 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.23 seconds
14:25:34.062923 [debug] [Thread-3  ]: finished collecting timing info
14:25:34.078644 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
14:25:34.225706 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B39B5B0>]}
14:25:34.225706 [info ] [Thread-3  ]: 31 of 31 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 3.43s]
14:25:34.242609 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
14:25:36.436913 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 9.12 seconds
14:25:36.436913 [debug] [Thread-1  ]: finished collecting timing info
14:25:36.436913 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
14:25:36.588192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'affd29ab-1d89-4ee5-977b-320939356278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CD9CDF0>]}
14:25:36.588192 [info ] [Thread-1  ]: 27 of 31 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 9.30s]
14:25:36.588192 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
14:25:36.594765 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:25:36.596170 [info ] [MainThread]: 
14:25:36.596459 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 36.15s.
14:25:36.596459 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
14:25:36.597460 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
14:25:36.623548 [info ] [MainThread]: 
14:25:36.624555 [info ] [MainThread]: [32mCompleted successfully[0m
14:25:36.625555 [info ] [MainThread]: 
14:25:36.625555 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
14:25:36.626556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BA361F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B999AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BAC25E0>]}


============================== 2022-05-16 10:34:34.866242 | 2915a746-f897-4e1a-9adf-f57b1b2afbbd ==============================
10:34:34.866242 [info ] [MainThread]: Running with dbt=1.1.0
10:34:34.868924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:34:34.868924 [debug] [MainThread]: Tracking: tracking
10:34:34.869926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C980EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C9805B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C980FA0>]}
10:34:36.424182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:34:36.424182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:34:36.432241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CA160D0>]}
10:34:36.473079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C909490>]}
10:34:36.473079 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
10:34:36.473079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C914370>]}
10:34:36.476608 [info ] [MainThread]: 
10:34:36.478178 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:34:36.481180 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
10:34:36.492348 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
10:34:36.493349 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
10:34:36.493349 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:34:38.406694 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.91 seconds
10:34:38.406694 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
10:34:38.576246 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
10:34:38.591949 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
10:34:38.591949 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
10:34:38.591949 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:34:39.048733 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.46 seconds
10:34:39.048733 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
10:34:39.191725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF1D070>]}
10:34:39.191725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:34:39.191725 [info ] [MainThread]: 
10:34:39.210280 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
10:34:39.211285 [info ] [Thread-1  ]: 1 of 31 START view model DEMO.raw_orders ....................................... [RUN]
10:34:39.212278 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
10:34:39.212278 [info ] [Thread-2  ]: 2 of 31 START view model DEMO.raw_transactions ................................. [RUN]
10:34:39.212278 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:34:39.213281 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
10:34:39.213281 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
10:34:39.217277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:34:39.218277 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:34:39.218277 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
10:34:39.218277 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
10:34:39.221377 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:34:39.223340 [debug] [Thread-1  ]: finished collecting timing info
10:34:39.223340 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
10:34:39.246246 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
10:34:39.247327 [debug] [Thread-2  ]: finished collecting timing info
10:34:39.247327 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
10:34:39.249245 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
10:34:39.254589 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
10:34:39.255086 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:34:39.255086 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
10:34:39.255086 [debug] [Thread-1  ]: Opening a new connection, currently in state init
10:34:39.256440 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
10:34:39.257549 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:34:39.862095 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.6 seconds
10:34:39.862095 [debug] [Thread-2  ]: finished collecting timing info
10:34:39.862095 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
10:34:40.029645 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF6A1F0>]}
10:34:40.029645 [info ] [Thread-2  ]: 2 of 31 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 0.81s]
10:34:40.031043 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
10:34:40.031859 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
10:34:40.031859 [info ] [Thread-4  ]: 3 of 31 START view model DEMO.v_stg_transactions ............................... [RUN]
10:34:40.032848 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.032919 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
10:34:40.032919 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
10:34:40.066525 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.066525 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
10:34:40.066525 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:34:40.163760 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.91 seconds
10:34:40.164962 [debug] [Thread-1  ]: finished collecting timing info
10:34:40.164962 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
10:34:40.295521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF15970>]}
10:34:40.295521 [info ] [Thread-1  ]: 1 of 31 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 1.08s]
10:34:40.295521 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
10:34:40.295521 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
10:34:40.295521 [info ] [Thread-2  ]: 4 of 31 START view model DEMO.raw_inventory .................................... [RUN]
10:34:40.311449 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
10:34:40.295521 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
10:34:40.311449 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
10:34:40.311449 [info ] [Thread-3  ]: 5 of 31 START view model DEMO.v_stg_orders ..................................... [RUN]
10:34:40.312733 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
10:34:40.316269 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
10:34:40.317272 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:40.317272 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
10:34:40.318273 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
10:34:40.324353 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:40.324353 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
10:34:40.325311 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:34:40.326270 [debug] [Thread-2  ]: finished collecting timing info
10:34:40.327357 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
10:34:40.332868 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
10:34:40.345469 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
10:34:40.346467 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
10:34:40.346467 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:34:40.496316 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.43 seconds
10:34:40.544443 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.544443 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
10:34:40.674431 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.13 seconds
10:34:40.708446 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.708446 [debug] [Thread-4  ]: finished collecting timing info
10:34:40.708446 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
10:34:40.708446 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.724154 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
10:34:40.724154 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
10:34:40.786131 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.46 seconds
10:34:40.833733 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:40.833733 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
10:34:41.038504 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
10:34:41.038504 [debug] [Thread-2  ]: finished collecting timing info
10:34:41.038504 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
10:34:41.567678 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.73 seconds
10:34:41.648341 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.92 seconds
10:34:41.648341 [debug] [Thread-4  ]: finished collecting timing info
10:34:41.648341 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
10:34:41.682228 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:41.702101 [debug] [Thread-3  ]: finished collecting timing info
10:34:41.702101 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
10:34:41.702101 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:41.702101 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
10:34:41.702101 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
10:34:41.743341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D0D74C0>]}
10:34:41.743341 [info ] [Thread-2  ]: 4 of 31 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 1.43s]
10:34:41.743341 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
10:34:41.743341 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
10:34:41.745919 [info ] [Thread-1  ]: 6 of 31 START view model DEMO.v_stg_inventory .................................. [RUN]
10:34:41.745919 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:41.746935 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
10:34:41.747175 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
10:34:41.748903 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:41.748903 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
10:34:41.748903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:34:41.818578 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E0CDE50>]}
10:34:41.818578 [info ] [Thread-4  ]: 3 of 31 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.79s]
10:34:41.819575 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
10:34:41.820492 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
10:34:41.821495 [info ] [Thread-2  ]: 7 of 31 START incremental model DEMO.t_link_transactions ....................... [RUN]
10:34:41.821495 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:41.821495 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
10:34:41.822487 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
10:34:41.919111 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:41.920159 [debug] [Thread-2  ]: finished collecting timing info
10:34:41.920159 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
10:34:41.942895 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:41.942895 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.t_link_transactions AS tgt
    ON stg."TRANSACTION_PK" = tgt."TRANSACTION_PK"
    WHERE tgt."TRANSACTION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:41.942895 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:34:42.013685 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.31 seconds
10:34:42.029813 [debug] [Thread-3  ]: finished collecting timing info
10:34:42.029813 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
10:34:42.169468 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFAF910>]}
10:34:42.169468 [info ] [Thread-3  ]: 5 of 31 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.85s]
10:34:42.169468 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
10:34:42.169468 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
10:34:42.173707 [info ] [Thread-4  ]: 8 of 31 START incremental model DEMO.hub_customer .............................. [RUN]
10:34:42.173707 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
10:34:42.173707 [info ] [Thread-3  ]: 9 of 31 START incremental model DEMO.hub_lineitem .............................. [RUN]
10:34:42.173707 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:42.175369 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
10:34:42.175369 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
10:34:42.196243 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:42.196243 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:34:42.200658 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
10:34:42.201946 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
10:34:42.212959 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:42.213959 [debug] [Thread-4  ]: finished collecting timing info
10:34:42.213959 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
10:34:42.217958 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:42.217958 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_customer AS d
    ON a."CUSTOMER_PK" = d."CUSTOMER_PK"
    WHERE d."CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:42.217958 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:34:42.219974 [debug] [Thread-3  ]: finished collecting timing info
10:34:42.219974 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
10:34:42.224956 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:42.224956 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_lineitem AS d
    ON a."LINEITEM_PK" = d."LINEITEM_PK"
    WHERE d."LINEITEM_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:42.224956 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:34:42.310311 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.56 seconds
10:34:42.326594 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:42.326594 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
10:34:42.450460 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.12 seconds
10:34:42.518060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:42.529148 [debug] [Thread-1  ]: finished collecting timing info
10:34:42.529148 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
10:34:42.529148 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:42.545373 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
10:34:42.545373 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
10:34:43.673282 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.13 seconds
10:34:43.673282 [debug] [Thread-1  ]: finished collecting timing info
10:34:43.673282 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
10:34:43.839871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D079490>]}
10:34:43.840892 [info ] [Thread-1  ]: 6 of 31 OK created view model DEMO.v_stg_inventory ............................. [[32mSUCCESS 1[0m in 2.09s]
10:34:43.841640 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
10:34:43.841640 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
10:34:43.841640 [info ] [Thread-1  ]: 10 of 31 START incremental model DEMO.hub_order ................................ [RUN]
10:34:43.842650 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:43.842650 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
10:34:43.843651 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
10:34:43.851736 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:34:43.853649 [debug] [Thread-1  ]: finished collecting timing info
10:34:43.853649 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
10:34:43.857731 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:43.857731 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_order AS d
    ON a."ORDER_PK" = d."ORDER_PK"
    WHERE d."ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:43.857731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:34:49.266281 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 7.32 seconds
10:34:49.266281 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:49.266281 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
10:34:49.742278 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.48 seconds
10:34:49.742278 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:49.742278 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions
10:34:49.918141 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.18 seconds
10:34:49.933985 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:49.933985 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."T_LINK_TRANSACTIONS"
10:34:50.051510 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.12 seconds
10:34:50.067026 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:50.079325 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:50.079325 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
10:34:50.504245 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.42 seconds
10:34:50.504245 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:50.504245 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: insert into DV_PROTOTYPE_DB.DEMO.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
        );
10:34:52.940801 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2.44 seconds
10:34:52.940801 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
10:34:52.940801 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: commit;
10:34:53.268711 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.33 seconds
10:34:53.268711 [debug] [Thread-2  ]: finished collecting timing info
10:34:53.268711 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
10:34:53.400669 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 11.18 seconds
10:34:53.404681 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:53.405671 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
10:34:53.442797 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 11.22 seconds
10:34:53.442797 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:53.442797 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
10:34:53.496838 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D0D77C0>]}
10:34:53.496838 [info ] [Thread-2  ]: 7 of 31 OK created incremental model DEMO.t_link_transactions .................. [[32mSUCCESS 1[0m in 11.68s]
10:34:53.496838 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
10:34:53.496838 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
10:34:53.496838 [info ] [Thread-2  ]: 11 of 31 START incremental model DEMO.link_customer_nation ..................... [RUN]
10:34:53.511480 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:53.511966 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
10:34:53.512286 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
10:34:53.541366 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:53.555281 [debug] [Thread-2  ]: finished collecting timing info
10:34:53.555281 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
10:34:53.559284 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:53.559284 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_nation AS d
    ON a."LINK_CUSTOMER_NATION_PK" = d."LINK_CUSTOMER_NATION_PK"
    WHERE d."LINK_CUSTOMER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:53.559284 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:34:53.761711 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.36 seconds
10:34:53.761711 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:53.761711 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer
10:34:53.828896 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.39 seconds
10:34:53.828896 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:53.828896 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem
10:34:53.860327 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:34:53.876324 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:53.876324 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_CUSTOMER"
10:34:53.924436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 10.07 seconds
10:34:53.930442 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:53.930442 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
10:34:53.977212 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:34:53.977212 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:34:53.977212 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:53.977212 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
10:34:54.055840 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.13 seconds
10:34:54.055840 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:54.055840 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order
10:34:54.148495 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.32 seconds
10:34:54.164274 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:54.164274 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_LINEITEM"
10:34:54.180001 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:34:54.198208 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:54.198208 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_ORDER"
10:34:54.715530 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.74 seconds
10:34:54.715530 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:54.715530 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: insert into DV_PROTOTYPE_DB.DEMO.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
        );
10:34:54.815977 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.65 seconds
10:34:54.815977 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:54.819807 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:54.819807 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
10:34:54.819807 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.62 seconds
10:34:54.819807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:34:54.819807 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:54.819807 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
10:34:54.932533 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.11 seconds
10:34:54.932533 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:54.932533 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: insert into DV_PROTOTYPE_DB.DEMO.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
        );
10:34:54.948193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:34:54.948193 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:54.948193 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: insert into DV_PROTOTYPE_DB.DEMO.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
        );
10:34:55.179907 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.23 seconds
10:34:55.179907 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:34:55.179907 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: commit;
10:34:55.462872 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.75 seconds
10:34:55.462872 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:34:55.462872 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: commit;
10:34:55.517206 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.96 seconds
10:34:55.522197 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:55.522197 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
10:34:55.544765 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.61 seconds
10:34:55.544765 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:34:55.544765 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: commit;
10:34:55.561271 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.38 seconds
10:34:55.561271 [debug] [Thread-1  ]: finished collecting timing info
10:34:55.561271 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
10:34:55.625388 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
10:34:55.641785 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:55.641785 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation
10:34:55.749028 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CDD5670>]}
10:34:55.749028 [info ] [Thread-1  ]: 10 of 31 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 11.91s]
10:34:55.749028 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:34:55.766612 [debug] [Thread-3  ]: finished collecting timing info
10:34:55.767615 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
10:34:55.769611 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
10:34:55.769611 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
10:34:55.769611 [info ] [Thread-1  ]: 12 of 31 START incremental model DEMO.link_customer_order ...................... [RUN]
10:34:55.771518 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:55.771518 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
10:34:55.771518 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
10:34:55.781661 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
10:34:55.793662 [debug] [Thread-1  ]: finished collecting timing info
10:34:55.793662 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
10:34:55.797971 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:55.797971 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_order AS d
    ON a."ORDER_CUSTOMER_PK" = d."ORDER_CUSTOMER_PK"
    WHERE d."ORDER_CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:55.798949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:34:55.824071 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.36 seconds
10:34:55.825067 [debug] [Thread-4  ]: finished collecting timing info
10:34:55.825067 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
10:34:55.879632 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.24 seconds
10:34:55.879632 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:55.879632 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_NATION"
10:34:55.934042 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFD3A90>]}
10:34:55.934042 [info ] [Thread-3  ]: 9 of 31 OK created incremental model DEMO.hub_lineitem ......................... [[32mSUCCESS 1[0m in 13.74s]
10:34:55.934042 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
10:34:55.934042 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:34:55.934042 [info ] [Thread-3  ]: 13 of 31 START incremental model DEMO.link_inventory_allocation ................ [RUN]
10:34:55.945878 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:55.946878 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
10:34:55.946878 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
10:34:55.959876 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:55.960873 [debug] [Thread-3  ]: finished collecting timing info
10:34:55.961884 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
10:34:55.967078 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:55.967967 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory_allocation AS d
    ON a."INVENTORY_ALLOCATION_PK" = d."INVENTORY_ALLOCATION_PK"
    WHERE d."INVENTORY_ALLOCATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:55.967967 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:34:56.043710 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.16 seconds
10:34:56.046721 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:56.051712 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:56.052724 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
10:34:56.077320 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C917C40>]}
10:34:56.077320 [info ] [Thread-4  ]: 8 of 31 OK created incremental model DEMO.hub_customer ......................... [[32mSUCCESS 1[0m in 13.90s]
10:34:56.077320 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
10:34:56.077320 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
10:34:56.077320 [info ] [Thread-4  ]: 14 of 31 START incremental model DEMO.link_order_lineitem ...................... [RUN]
10:34:56.092415 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:56.092415 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
10:34:56.092415 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
10:34:56.094508 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:56.102519 [debug] [Thread-4  ]: finished collecting timing info
10:34:56.102519 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
10:34:56.102519 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:56.102519 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_order_lineitem AS d
    ON a."LINK_LINEITEM_ORDER_PK" = d."LINK_LINEITEM_ORDER_PK"
    WHERE d."LINK_LINEITEM_ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:56.102519 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:34:56.212214 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.16 seconds
10:34:56.212214 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:56.212214 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: insert into DV_PROTOTYPE_DB.DEMO.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
        );
10:34:56.418670 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.21 seconds
10:34:56.418670 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
10:34:56.418670 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: commit;
10:34:56.603702 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.19 seconds
10:34:56.619434 [debug] [Thread-2  ]: finished collecting timing info
10:34:56.619559 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
10:34:56.783815 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF15CA0>]}
10:34:56.783815 [info ] [Thread-2  ]: 11 of 31 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 3.27s]
10:34:56.783815 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
10:34:56.783815 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:34:56.783815 [info ] [Thread-2  ]: 15 of 31 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
10:34:56.797311 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:56.797578 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:34:56.797578 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:34:56.852134 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:56.863446 [debug] [Thread-2  ]: finished collecting timing info
10:34:56.864439 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:34:56.871529 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:56.871529 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_NATION_HASHDIFF" != stage."CUSTOMER_NATION_HASHDIFF"
                OR latest_records."CUSTOMER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:56.871529 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:34:57.822588 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.02 seconds
10:34:57.838570 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:57.838570 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
10:34:58.013303 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.17 seconds
10:34:58.123059 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.123059 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order
10:34:58.239337 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:34:58.239337 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.239337 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_ORDER"
10:34:58.363092 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:34:58.363092 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.378667 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.378667 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
10:34:58.524224 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
10:34:58.524224 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.524224 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: insert into DV_PROTOTYPE_DB.DEMO.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
        );
10:34:58.790258 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.82 seconds
10:34:58.790258 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:58.790258 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
10:34:58.840396 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.32 seconds
10:34:58.840396 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
10:34:58.840396 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: commit;
10:34:58.909061 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.12 seconds
10:34:58.909061 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:58.909061 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation
10:34:58.972765 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.87 seconds
10:34:58.988363 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:58.988363 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
10:34:59.027189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
10:34:59.027189 [debug] [Thread-1  ]: finished collecting timing info
10:34:59.027189 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
10:34:59.027189 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.12 seconds
10:34:59.042736 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:59.042736 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY_ALLOCATION"
10:34:59.074023 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.2 seconds
10:34:59.089625 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.089625 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
10:34:59.172472 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.13 seconds
10:34:59.172472 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:59.172472 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:59.172472 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
10:34:59.505519 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.42 seconds
10:34:59.511082 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.511082 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details
10:34:59.511082 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.52 seconds
10:34:59.511082 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:59.511082 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem
10:34:59.526864 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.35 seconds
10:34:59.526864 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:59.526864 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DV_PROTOTYPE_DB.DEMO.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
        );
10:34:59.558822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E2E8CD0>]}
10:34:59.558822 [info ] [Thread-1  ]: 12 of 31 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 3.79s]
10:34:59.558822 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
10:34:59.558822 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:34:59.558822 [info ] [Thread-1  ]: 16 of 31 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
10:34:59.562328 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:34:59.562328 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:34:59.562328 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:34:59.578866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:34:59.591361 [debug] [Thread-1  ]: finished collecting timing info
10:34:59.591361 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:34:59.595370 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:34:59.595370 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_REGION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_REGION_HASHDIFF" != stage."CUSTOMER_REGION_HASHDIFF"
                OR latest_records."CUSTOMER_REGION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:34:59.595370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:34:59.626786 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:34:59.630098 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:59.631098 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_ORDER_LINEITEM"
10:34:59.638883 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.13 seconds
10:34:59.641977 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.642968 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_NATION_DETAILS"
10:34:59.728678 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.2 seconds
10:34:59.728678 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
10:34:59.728678 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
10:34:59.746341 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.1 seconds
10:34:59.749350 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.751263 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.751263 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
10:34:59.765006 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.13 seconds
10:34:59.767012 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:59.768989 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:59.769927 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
10:34:59.856593 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
10:34:59.856593 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:34:59.856593 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
        );
10:34:59.903570 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:34:59.903570 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:34:59.903570 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DV_PROTOTYPE_DB.DEMO.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
        );
10:34:59.927928 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:34:59.927928 [debug] [Thread-3  ]: finished collecting timing info
10:34:59.927928 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
10:35:00.145477 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFAF550>]}
10:35:00.145477 [info ] [Thread-3  ]: 13 of 31 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 4.20s]
10:35:00.145477 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
10:35:00.145477 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:35:00.145477 [info ] [Thread-3  ]: 17 of 31 START incremental model DEMO.sat_order_customer_details ............... [RUN]
10:35:00.149351 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:00.149351 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
10:35:00.150415 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
10:35:00.166536 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:00.168459 [debug] [Thread-3  ]: finished collecting timing info
10:35:00.168459 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
10:35:00.172544 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:00.172544 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_HASHDIFF" != stage."CUSTOMER_HASHDIFF"
                OR latest_records."CUSTOMER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:00.172544 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:35:00.174455 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.32 seconds
10:35:00.176046 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
10:35:00.176046 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
10:35:00.180346 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.28 seconds
10:35:00.180346 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
10:35:00.180346 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
10:35:00.368025 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
10:35:00.368025 [debug] [Thread-4  ]: finished collecting timing info
10:35:00.368025 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
10:35:00.368025 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.19 seconds
10:35:00.383664 [debug] [Thread-2  ]: finished collecting timing info
10:35:00.383664 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
10:35:00.562696 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D003760>]}
10:35:00.562696 [info ] [Thread-4  ]: 14 of 31 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 4.47s]
10:35:00.562696 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
10:35:00.562696 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:35:00.562696 [info ] [Thread-4  ]: 18 of 31 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
10:35:00.565706 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:00.565706 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:35:00.565706 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:35:00.586196 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:00.587198 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E37D190>]}
10:35:00.587198 [info ] [Thread-2  ]: 15 of 31 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 3.79s]
10:35:00.588119 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
10:35:00.588119 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
10:35:00.588119 [info ] [Thread-2  ]: 19 of 31 START incremental model DEMO.sat_order_order_details .................. [RUN]
10:35:00.589112 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:00.589112 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
10:35:00.589112 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
10:35:00.590115 [debug] [Thread-4  ]: finished collecting timing info
10:35:00.596113 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:35:00.600120 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:00.601112 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."LINEITEM_PK", current_records."LINEITEM_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."LINEITEM_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."LINEITEM_PK"
                FROM source_data
            ) AS source_records
                ON current_records."LINEITEM_PK" = source_records."LINEITEM_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."LINEITEM_PK" = stage."LINEITEM_PK"
            WHERE latest_records."LINEITEM_HASHDIFF" != stage."LINEITEM_HASHDIFF"
                OR latest_records."LINEITEM_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:00.601112 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:35:00.615135 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:00.616038 [debug] [Thread-2  ]: finished collecting timing info
10:35:00.616038 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
10:35:00.621120 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:00.621120 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."ORDER_PK", current_records."ORDER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."ORDER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."ORDER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."ORDER_PK" = source_records."ORDER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."ORDER_PK" = stage."ORDER_PK"
            WHERE latest_records."ORDER_HASHDIFF" != stage."ORDER_HASHDIFF"
                OR latest_records."ORDER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:00.621120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:35:02.993264 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.82 seconds
10:35:02.993264 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:02.993264 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
10:35:03.284293 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.29 seconds
10:35:03.284293 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:03.299888 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details
10:35:03.421358 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.12 seconds
10:35:03.437013 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:03.437013 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUSTOMER_DETAILS"
10:35:03.553805 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.12 seconds
10:35:03.553805 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:03.553805 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:03.553805 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
10:35:03.693483 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.14 seconds
10:35:03.693483 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:03.693483 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
        );
10:35:04.023309 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.33 seconds
10:35:04.023309 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
10:35:04.023309 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
10:35:04.370526 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.35 seconds
10:35:04.370526 [debug] [Thread-3  ]: finished collecting timing info
10:35:04.370526 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
10:35:04.819362 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFDBC40>]}
10:35:04.819362 [info ] [Thread-3  ]: 17 of 31 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 4.67s]
10:35:04.825381 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
10:35:04.825381 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
10:35:04.827570 [info ] [Thread-3  ]: 20 of 31 START incremental model DEMO.hub_nation ............................... [RUN]
10:35:04.829376 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:04.829376 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
10:35:04.829376 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
10:35:04.843108 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:35:04.854730 [debug] [Thread-3  ]: finished collecting timing info
10:35:04.854730 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
10:35:04.858735 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:04.858735 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_nation AS d
    ON a."NATION_PK" = d."NATION_PK"
    WHERE d."NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:04.858735 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:35:05.025932 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.4 seconds
10:35:05.025932 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.025932 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
10:35:05.342145 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0.32 seconds
10:35:05.357657 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.357657 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details
10:35:05.560188 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0.2 seconds
10:35:05.560188 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.560188 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_ORDER_DETAILS"
10:35:05.713167 [debug] [Thread-2  ]: SQL status: SUCCESS 12 in 0.15 seconds
10:35:05.713167 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.731557 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.731557 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
10:35:05.875074 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
10:35:05.875074 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:05.875074 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
        );
10:35:06.329746 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.45 seconds
10:35:06.329746 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
10:35:06.329746 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
10:35:06.503508 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
10:35:06.503508 [debug] [Thread-2  ]: finished collecting timing info
10:35:06.503508 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
10:35:06.807764 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFDBA30>]}
10:35:06.807764 [info ] [Thread-2  ]: 19 of 31 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 6.22s]
10:35:06.807764 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
10:35:06.807764 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_part
10:35:06.807764 [info ] [Thread-2  ]: 21 of 31 START incremental model DEMO.hub_part ................................. [RUN]
10:35:06.820222 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:06.820222 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
10:35:06.820222 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_part
10:35:06.832673 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:35:06.833647 [debug] [Thread-2  ]: finished collecting timing info
10:35:06.834658 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
10:35:06.837875 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:06.837875 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_part AS d
    ON a."PART_PK" = d."PART_PK"
    WHERE d."PART_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:06.837875 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:35:06.947492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7.35 seconds
10:35:06.947492 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:06.947492 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
10:35:07.063488 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.12 seconds
10:35:07.063488 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.063488 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details
10:35:07.177490 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.11 seconds
10:35:07.183502 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.184496 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_REGION_DETAILS"
10:35:07.348213 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.16 seconds
10:35:07.348213 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.371318 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.371318 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
10:35:07.581305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
10:35:07.581305 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.581305 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
        );
10:35:07.802494 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.22 seconds
10:35:07.802494 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
10:35:07.802494 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
10:35:08.227530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.43 seconds
10:35:08.229609 [debug] [Thread-1  ]: finished collecting timing info
10:35:08.229609 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
10:35:08.435217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFE5760>]}
10:35:08.435217 [info ] [Thread-1  ]: 16 of 31 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 8.87s]
10:35:08.435217 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
10:35:08.450868 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_region
10:35:08.450868 [info ] [Thread-1  ]: 22 of 31 START incremental model DEMO.hub_region ............................... [RUN]
10:35:08.451796 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:08.451796 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
10:35:08.451796 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_region
10:35:08.463532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:35:08.464522 [debug] [Thread-1  ]: finished collecting timing info
10:35:08.464522 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
10:35:08.469614 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:08.469614 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_region AS d
    ON a."REGION_PK" = d."REGION_PK"
    WHERE d."REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:08.469614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:35:09.594623 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.74 seconds
10:35:09.610960 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:09.610960 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
10:35:09.716491 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:35:09.732062 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:09.732062 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation
10:35:09.878803 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.15 seconds
10:35:09.878803 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:09.878803 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_NATION"
10:35:09.980242 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:35:09.980242 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:35:09.980242 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:09.996105 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
10:35:10.218513 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.22 seconds
10:35:10.218513 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:10.218513 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: insert into DV_PROTOTYPE_DB.DEMO.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
        );
10:35:10.487982 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.27 seconds
10:35:10.487982 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:35:10.487982 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: commit;
10:35:10.912280 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.42 seconds
10:35:10.912280 [debug] [Thread-3  ]: finished collecting timing info
10:35:10.912280 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
10:35:11.158824 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 10.56 seconds
10:35:11.174593 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.174593 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
10:35:11.174593 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF1D250>]}
10:35:11.174593 [info ] [Thread-3  ]: 20 of 31 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 6.35s]
10:35:11.174593 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
10:35:11.190421 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
10:35:11.190531 [info ] [Thread-3  ]: 23 of 31 START incremental model DEMO.hub_supplier ............................. [RUN]
10:35:11.190743 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:11.190743 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
10:35:11.191757 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
10:35:11.202824 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:35:11.215042 [debug] [Thread-3  ]: finished collecting timing info
10:35:11.215042 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
10:35:11.219038 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:11.219038 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_supplier AS d
    ON a."SUPPLIER_PK" = d."SUPPLIER_PK"
    WHERE d."SUPPLIER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:11.219038 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:35:11.308706 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.13 seconds
10:35:11.311735 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.311735 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details
10:35:11.429822 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.12 seconds
10:35:11.429822 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.429822 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_LINEITEM_DETAILS"
10:35:11.544212 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.11 seconds
10:35:11.544212 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.544212 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.544212 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
10:35:11.675835 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:35:11.675835 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.675835 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
        );
10:35:11.936203 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.26 seconds
10:35:11.936203 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
10:35:11.937203 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
10:35:12.140472 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:35:12.146004 [debug] [Thread-4  ]: finished collecting timing info
10:35:12.146004 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
10:35:12.329009 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E37D160>]}
10:35:12.329009 [info ] [Thread-4  ]: 18 of 31 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 11.76s]
10:35:12.329009 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
10:35:12.329009 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
10:35:12.329009 [info ] [Thread-4  ]: 24 of 31 START incremental model DEMO.link_inventory ........................... [RUN]
10:35:12.338051 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:12.338051 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
10:35:12.338051 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
10:35:12.401207 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
10:35:12.403198 [debug] [Thread-4  ]: finished collecting timing info
10:35:12.403198 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
10:35:12.407209 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:12.407209 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory AS d
    ON a."INVENTORY_PK" = d."INVENTORY_PK"
    WHERE d."INVENTORY_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:12.407209 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:35:15.016384 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 8.18 seconds
10:35:15.031985 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.031985 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
10:35:15.148045 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:35:15.154035 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.154035 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part
10:35:15.254087 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:35:15.269808 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.269808 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_PART"
10:35:15.370621 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:35:15.386810 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:35:15.399322 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.399322 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
10:35:15.537285 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
10:35:15.537285 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.537285 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: insert into DV_PROTOTYPE_DB.DEMO.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
        );
10:35:15.663784 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7.19 seconds
10:35:15.679498 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:15.679498 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
10:35:15.771274 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.23 seconds
10:35:15.771274 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:35:15.771274 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: commit;
10:35:15.802525 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:35:15.802525 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:15.802525 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region
10:35:15.911971 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:35:15.911971 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:15.911971 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_REGION"
10:35:15.943379 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
10:35:15.955976 [debug] [Thread-2  ]: finished collecting timing info
10:35:15.955976 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: Close
10:35:16.018588 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:35:16.034222 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:35:16.046960 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:16.046960 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
10:35:16.056097 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.65 seconds
10:35:16.071825 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.071825 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
10:35:16.122913 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E1D7F10>]}
10:35:16.122913 [info ] [Thread-2  ]: 21 of 31 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 9.30s]
10:35:16.122913 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
10:35:16.122913 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
10:35:16.122913 [info ] [Thread-2  ]: 25 of 31 START incremental model DEMO.link_nation_region ....................... [RUN]
10:35:16.138644 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:16.138644 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
10:35:16.138644 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
10:35:16.151841 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
10:35:16.154035 [debug] [Thread-2  ]: finished collecting timing info
10:35:16.154035 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
10:35:16.158314 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:16.158314 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_nation_region AS d
    ON a."NATION_REGION_PK" = d."NATION_REGION_PK"
    WHERE d."NATION_REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:16.158314 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:35:16.195216 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
10:35:16.195216 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:16.195216 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: insert into DV_PROTOTYPE_DB.DEMO.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
        );
10:35:16.199232 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.13 seconds
10:35:16.202320 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.203423 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory
10:35:16.319356 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:35:16.319356 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.319356 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY"
10:35:16.405665 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.21 seconds
10:35:16.405665 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:35:16.405665 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: commit;
10:35:16.421695 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
10:35:16.421695 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.421695 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.421695 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
10:35:16.573355 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
10:35:16.573355 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.573355 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: insert into DV_PROTOTYPE_DB.DEMO.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
        );
10:35:16.588871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
10:35:16.588871 [debug] [Thread-1  ]: finished collecting timing info
10:35:16.588871 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_region: Close
10:35:16.758228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CF1DCD0>]}
10:35:16.758228 [info ] [Thread-1  ]: 22 of 31 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 8.31s]
10:35:16.773966 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
10:35:16.773966 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
10:35:16.773966 [info ] [Thread-1  ]: 26 of 31 START incremental model DEMO.link_supplier_nation ..................... [RUN]
10:35:16.775717 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:16.775717 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
10:35:16.776106 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
10:35:16.786981 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:16.788906 [debug] [Thread-1  ]: finished collecting timing info
10:35:16.788906 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
10:35:16.793254 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:16.793254 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_supplier_nation AS d
    ON a."LINK_SUPPLIER_NATION_PK" = d."LINK_SUPPLIER_NATION_PK"
    WHERE d."LINK_SUPPLIER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:16.793254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:35:16.823380 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.25 seconds
10:35:16.823380 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
10:35:16.823380 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: commit;
10:35:17.006193 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
10:35:17.006193 [debug] [Thread-4  ]: finished collecting timing info
10:35:17.006193 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
10:35:17.022643 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.8 seconds
10:35:17.028167 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.028167 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
10:35:17.154330 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.13 seconds
10:35:17.158844 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.158844 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier
10:35:17.210103 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667D0D6340>]}
10:35:17.280651 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:35:17.281846 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.281846 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_SUPPLIER"
10:35:17.375946 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.09 seconds
10:35:17.391982 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.391982 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.391982 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
10:35:17.538508 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.15 seconds
10:35:17.538508 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.538508 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: insert into DV_PROTOTYPE_DB.DEMO.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
        );
10:35:17.793484 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.25 seconds
10:35:17.793484 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:35:17.794481 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: commit;
10:35:18.008038 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.21 seconds
10:35:18.008038 [debug] [Thread-3  ]: finished collecting timing info
10:35:18.008038 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
10:35:18.209808 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E3581F0>]}
10:35:18.394713 [info ] [Thread-4  ]: 24 of 31 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 4.88s]
10:35:18.394713 [info ] [Thread-3  ]: 23 of 31 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 7.02s]
10:35:18.394713 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
10:35:18.394713 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:35:18.401211 [info ] [Thread-4  ]: 27 of 31 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
10:35:18.401211 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
10:35:18.401211 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:35:18.402405 [info ] [Thread-3  ]: 28 of 31 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
10:35:18.403408 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:18.403408 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:35:18.403408 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:35:18.417491 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:18.419012 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:18.420006 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
10:35:18.420006 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
10:35:18.437626 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:18.437626 [debug] [Thread-4  ]: finished collecting timing info
10:35:18.438623 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:35:18.438623 [debug] [Thread-3  ]: finished collecting timing info
10:35:18.442622 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:18.442622 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
10:35:18.442622 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."INVENTORY_PK", current_records."INVENTORY_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."INVENTORY_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."INVENTORY_PK"
                FROM source_data
            ) AS source_records
                ON current_records."INVENTORY_PK" = source_records."INVENTORY_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."INVENTORY_PK" = stage."INVENTORY_PK"
            WHERE latest_records."INVENTORY_HASHDIFF" != stage."INVENTORY_HASHDIFF"
                OR latest_records."INVENTORY_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:18.447623 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:18.447623 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:35:18.447623 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."PART_PK", current_records."PART_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."PART_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."PART_PK"
                FROM source_data
            ) AS source_records
                ON current_records."PART_PK" = source_records."PART_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."PART_PK" = stage."PART_PK"
            WHERE latest_records."PART_HASHDIFF" != stage."PART_HASHDIFF"
                OR latest_records."PART_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:18.450835 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:35:20.166821 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.37 seconds
10:35:20.166821 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.166821 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
10:35:20.298570 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.13 seconds
10:35:20.314161 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.314161 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation
10:35:20.467945 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.15 seconds
10:35:20.483847 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.483847 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_SUPPLIER_NATION"
10:35:20.590601 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
10:35:20.606226 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.606226 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.606226 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
10:35:20.734292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:35:20.734292 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.734292 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DV_PROTOTYPE_DB.DEMO.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
        );
10:35:20.985354 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.25 seconds
10:35:20.985354 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
10:35:20.985354 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
10:35:21.185507 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:35:21.201633 [debug] [Thread-1  ]: finished collecting timing info
10:35:21.202137 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
10:35:21.385729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E162370>]}
10:35:21.385729 [info ] [Thread-1  ]: 26 of 31 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 4.61s]
10:35:21.385729 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
10:35:21.385729 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:35:21.385729 [info ] [Thread-1  ]: 29 of 31 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
10:35:21.399860 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:21.399860 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:35:21.399860 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:35:21.414350 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:21.415435 [debug] [Thread-1  ]: finished collecting timing info
10:35:21.415435 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:35:21.421552 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:21.421552 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:21.421552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:35:23.374312 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 7.22 seconds
10:35:23.374312 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.374312 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
10:35:23.573243 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.2 seconds
10:35:23.578241 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.579159 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region
10:35:23.675168 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.22 seconds
10:35:23.675168 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:23.675168 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
10:35:23.675168 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
10:35:23.675168 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.675168 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_NATION_REGION"
10:35:23.791936 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:35:23.791936 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.809675 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.809675 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
10:35:23.809675 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.13 seconds
10:35:23.809675 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:23.809675 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details
10:35:23.920378 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.11 seconds
10:35:23.920378 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:23.920378 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_PART_DETAILS"
10:35:23.991945 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.18 seconds
10:35:23.991945 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:23.991945 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: insert into DV_PROTOTYPE_DB.DEMO.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
        );
10:35:24.024917 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.1 seconds
10:35:24.024917 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:24.024917 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:24.024917 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
10:35:24.286183 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.26 seconds
10:35:24.286183 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:24.286183 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
        );
10:35:24.424069 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.43 seconds
10:35:24.424069 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
10:35:24.424069 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: commit;
10:35:24.618540 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.2 seconds
10:35:24.634118 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:24.634118 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
10:35:24.743545 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.32 seconds
10:35:24.743545 [debug] [Thread-2  ]: finished collecting timing info
10:35:24.743545 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
10:35:24.743545 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.46 seconds
10:35:24.743545 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
10:35:24.743545 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
10:35:24.835776 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.2 seconds
10:35:24.836273 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:24.836273 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details
10:35:24.960675 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667B3E79D0>]}
10:35:24.960675 [info ] [Thread-2  ]: 25 of 31 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 8.82s]
10:35:24.960675 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
10:35:24.960675 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:35:24.960675 [info ] [Thread-2  ]: 30 of 31 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
10:35:24.968595 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:24.968595 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:35:24.968595 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:35:24.983792 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:24.984698 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.15 seconds
10:35:24.989208 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:24.990211 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_NATION_DETAILS"
10:35:24.995356 [debug] [Thread-2  ]: finished collecting timing info
10:35:24.995356 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:35:24.999357 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:25.000357 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:25.000357 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
10:35:25.017029 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.27 seconds
10:35:25.019121 [debug] [Thread-3  ]: finished collecting timing info
10:35:25.019121 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
10:35:25.139214 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.15 seconds
10:35:25.139214 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:25.139214 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:25.139214 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
10:35:25.277133 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFDAE80>]}
10:35:25.277133 [info ] [Thread-3  ]: 28 of 31 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 6.86s]
10:35:25.292978 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
10:35:25.293480 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:35:25.293820 [info ] [Thread-3  ]: 31 of 31 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
10:35:25.293820 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:25.293820 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:35:25.294989 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:35:25.311305 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:25.312302 [debug] [Thread-3  ]: finished collecting timing info
10:35:25.313304 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:35:25.322661 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:25.323662 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_HASHDIFF" != stage."SUPPLIER_HASHDIFF"
                OR latest_records."SUPPLIER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
10:35:25.324666 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:35:25.325663 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
10:35:25.327665 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:25.328665 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
        );
10:35:25.678922 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.35 seconds
10:35:25.678922 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
10:35:25.678922 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
10:35:25.900363 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
10:35:25.900363 [debug] [Thread-1  ]: finished collecting timing info
10:35:25.900363 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
10:35:26.226532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667CFDA040>]}
10:35:26.226532 [info ] [Thread-1  ]: 29 of 31 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 4.83s]
10:35:26.226532 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
10:35:27.310720 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 8.86 seconds
10:35:27.316719 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.316719 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
10:35:27.418433 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.1 seconds
10:35:27.418433 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.418433 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details
10:35:27.516469 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.1 seconds
10:35:27.516469 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.516469 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_INVENTORY_DETAILS"
10:35:27.648811 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.13 seconds
10:35:27.648811 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.668468 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.668468 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
10:35:27.801427 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:35:27.801427 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:27.801427 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
        );
10:35:28.066857 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.27 seconds
10:35:28.066857 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
10:35:28.066857 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
10:35:28.251354 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.25 seconds
10:35:28.266872 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.266872 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
10:35:28.351370 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.28 seconds
10:35:28.351370 [debug] [Thread-4  ]: finished collecting timing info
10:35:28.351370 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
10:35:28.429939 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.16 seconds
10:35:28.429939 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.429939 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details
10:35:28.535244 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E2C0100>]}
10:35:28.535689 [info ] [Thread-4  ]: 27 of 31 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 10.13s]
10:35:28.537014 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
10:35:28.557104 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.13 seconds
10:35:28.560170 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.560170 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_REGION_DETAILS"
10:35:28.662867 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.1 seconds
10:35:28.678637 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.690126 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.690126 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
10:35:28.809850 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
10:35:28.809850 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:28.809850 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
        );
10:35:29.272971 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.45 seconds
10:35:29.272971 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
10:35:29.272971 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
10:35:29.490605 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:35:29.490605 [debug] [Thread-2  ]: finished collecting timing info
10:35:29.490605 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
10:35:29.935356 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E13DA60>]}
10:35:29.935356 [info ] [Thread-2  ]: 30 of 31 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 4.97s]
10:35:29.935356 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
10:35:30.292599 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.97 seconds
10:35:30.308589 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.308589 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
10:35:30.426031 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 0.12 seconds
10:35:30.426031 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.426031 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details
10:35:30.546802 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 0.12 seconds
10:35:30.551012 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.551012 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPPLIER_DETAILS"
10:35:30.665734 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 0.11 seconds
10:35:30.665734 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.665734 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.665734 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
10:35:30.794079 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
10:35:30.794079 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:30.794079 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
        );
10:35:31.048676 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.25 seconds
10:35:31.048676 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
10:35:31.048676 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
10:35:31.247259 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:35:31.247259 [debug] [Thread-3  ]: finished collecting timing info
10:35:31.247259 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
10:35:31.443335 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2915a746-f897-4e1a-9adf-f57b1b2afbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E112400>]}
10:35:31.443335 [info ] [Thread-3  ]: 31 of 31 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 6.15s]
10:35:31.443335 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
10:35:31.460310 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:35:31.460310 [info ] [MainThread]: 
10:35:31.461323 [info ] [MainThread]: Finished running 6 view models, 25 incremental models in 54.98s.
10:35:31.461837 [debug] [MainThread]: Connection 'master' was properly closed.
10:35:31.461837 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
10:35:31.461837 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
10:35:31.461837 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
10:35:31.462269 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
10:35:31.462269 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
10:35:31.462269 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
10:35:31.478865 [info ] [MainThread]: 
10:35:31.479848 [info ] [MainThread]: [32mCompleted successfully[0m
10:35:31.480847 [info ] [MainThread]: 
10:35:31.480847 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
10:35:31.481684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C914250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667C9149D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667E322AC0>]}


============================== 2022-05-18 10:23:42.627817 | 3d3e7462-6226-4389-92ae-4265804f6453 ==============================
10:23:42.627817 [info ] [MainThread]: Running with dbt=1.1.0
10:23:42.630077 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:23:42.630077 [debug] [MainThread]: Tracking: tracking
10:23:42.632048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA725B2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA725B2BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA725B2370>]}
10:23:44.917089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
10:23:44.918057 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://data\customers.csv
10:23:44.918057 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://data\bookings_2.csv
10:23:44.918057 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://data\bookings_1.csv
10:23:44.962041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA729D60D0>]}
10:23:44.979336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA72744E80>]}
10:23:44.979818 [info ] [MainThread]: Found 31 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 3 seed files, 8 sources, 0 exposures, 0 metrics
10:23:44.979818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA72744CD0>]}
10:23:44.982956 [info ] [MainThread]: 
10:23:44.983854 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:23:44.987855 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
10:23:45.004016 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
10:23:45.004016 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
10:23:45.004016 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:23:46.365572 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.36 seconds
10:23:46.367428 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
10:23:46.527952 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
10:23:46.536066 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
10:23:46.536066 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
10:23:46.536066 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:23:46.977803 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.44 seconds
10:23:46.982794 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
10:23:47.138812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73A14040>]}
10:23:47.139828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:23:47.140821 [info ] [MainThread]: 
10:23:47.185905 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
10:23:47.186905 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
10:23:47.186905 [info ] [Thread-1  ]: 1 of 7 START incremental model DEMO.hub_customer ............................... [RUN]
10:23:47.186905 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
10:23:47.187921 [info ] [Thread-2  ]: 2 of 7 START incremental model DEMO.hub_lineitem ............................... [RUN]
10:23:47.187921 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
10:23:47.188903 [info ] [Thread-3  ]: 3 of 7 START incremental model DEMO.hub_nation ................................. [RUN]
10:23:47.188989 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:47.189739 [info ] [Thread-4  ]: 4 of 7 START incremental model DEMO.hub_order .................................. [RUN]
10:23:47.190225 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:47.191265 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
10:23:47.191265 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:47.192271 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
10:23:47.192271 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
10:23:47.193262 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:47.193262 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
10:23:47.194264 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
10:23:47.235086 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
10:23:47.235994 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
10:23:47.296864 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_order
10:23:47.345291 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:47.350982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:23:47.353981 [debug] [Thread-2  ]: finished collecting timing info
10:23:47.354981 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
10:23:47.394306 [debug] [Thread-1  ]: finished collecting timing info
10:23:47.394306 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
10:23:47.404109 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:47.404109 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_customer AS d
    ON a."CUSTOMER_PK" = d."CUSTOMER_PK"
    WHERE d."CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:47.406125 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:47.407234 [debug] [Thread-1  ]: Opening a new connection, currently in state init
10:23:47.408458 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_lineitem AS d
    ON a."LINEITEM_PK" = d."LINEITEM_PK"
    WHERE d."LINEITEM_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:47.414717 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:23:47.415680 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:23:47.421620 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:23:47.424743 [debug] [Thread-4  ]: finished collecting timing info
10:23:47.424743 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
10:23:47.429822 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:47.429822 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_order AS d
    ON a."ORDER_PK" = d."ORDER_PK"
    WHERE d."ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:47.429822 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:23:47.432826 [debug] [Thread-3  ]: finished collecting timing info
10:23:47.432826 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
10:23:47.437822 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:47.437822 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_nation AS d
    ON a."NATION_PK" = d."NATION_PK"
    WHERE d."NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:47.438925 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:23:53.172465 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.77 seconds
10:23:53.181644 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.181644 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
10:23:53.297273 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:23:53.301269 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.301269 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer
10:23:53.408314 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:23:53.414393 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.414393 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_CUSTOMER"
10:23:53.515917 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:23:53.528987 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.540077 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.1 seconds
10:23:53.542779 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:53.542779 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
10:23:53.566476 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.566476 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
10:23:53.659786 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:23:53.665767 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:53.665767 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation
10:23:53.689296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
10:23:53.689296 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.689296 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: insert into DV_PROTOTYPE_DB.DEMO.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
        );
10:23:53.784049 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:23:53.787929 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:53.788508 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_NATION"
10:23:53.881225 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.09 seconds
10:23:53.883209 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
10:23:53.885207 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:53.885457 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
10:23:53.914090 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.22 seconds
10:23:53.914090 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
10:23:53.914090 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: commit;
10:23:54.001450 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
10:23:54.002447 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:54.002447 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: insert into DV_PROTOTYPE_DB.DEMO.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
        );
10:23:54.081566 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
10:23:54.092303 [debug] [Thread-1  ]: finished collecting timing info
10:23:54.093301 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
10:23:54.227053 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.22 seconds
10:23:54.228052 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
10:23:54.228052 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: commit;
10:23:54.257257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73B8D460>]}
10:23:54.258604 [info ] [Thread-1  ]: 1 of 7 OK created incremental model DEMO.hub_customer .......................... [[32mSUCCESS 1[0m in 7.07s]
10:23:54.259789 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
10:23:54.259789 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_part
10:23:54.260860 [info ] [Thread-1  ]: 5 of 7 START incremental model DEMO.hub_part ................................... [RUN]
10:23:54.262491 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:23:54.262491 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
10:23:54.262491 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_part
10:23:54.276323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:23:54.313991 [debug] [Thread-1  ]: finished collecting timing info
10:23:54.313991 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
10:23:54.317051 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:23:54.318049 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_part AS d
    ON a."PART_PK" = d."PART_PK"
    WHERE d."PART_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:54.318049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:23:54.398424 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.17 seconds
10:23:54.399428 [debug] [Thread-3  ]: finished collecting timing info
10:23:54.400427 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
10:23:54.562353 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73BA3610>]}
10:23:54.563475 [info ] [Thread-3  ]: 3 of 7 OK created incremental model DEMO.hub_nation ............................ [[32mSUCCESS 1[0m in 7.37s]
10:23:54.564400 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
10:23:54.564400 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_region
10:23:54.564400 [info ] [Thread-3  ]: 6 of 7 START incremental model DEMO.hub_region ................................. [RUN]
10:23:54.565401 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:54.565401 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
10:23:54.565401 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_region
10:23:54.577311 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:23:54.607738 [debug] [Thread-3  ]: finished collecting timing info
10:23:54.607915 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
10:23:54.615939 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:54.616270 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_region AS d
    ON a."REGION_PK" = d."REGION_PK"
    WHERE d."REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:54.616270 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
10:23:56.707278 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 9.28 seconds
10:23:56.713582 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:56.713582 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
10:23:56.862553 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.15 seconds
10:23:56.866970 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:56.866970 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order
10:23:56.937560 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 9.52 seconds
10:23:56.943568 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:56.943568 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
10:23:56.974166 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:23:56.979163 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:56.979163 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_ORDER"
10:23:57.050701 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
10:23:57.055515 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.055515 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem
10:23:57.093287 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:23:57.098289 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
10:23:57.101133 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:57.102089 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
10:23:57.153563 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
10:23:57.156544 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.156544 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_LINEITEM"
10:23:57.257031 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
10:23:57.257974 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:57.257974 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: insert into DV_PROTOTYPE_DB.DEMO.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
        );
10:23:57.273860 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
10:23:57.275853 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.283987 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.284843 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
10:23:57.397211 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
10:23:57.397211 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.398211 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: insert into DV_PROTOTYPE_DB.DEMO.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
        );
10:23:57.515311 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.26 seconds
10:23:57.516640 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
10:23:57.516640 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: commit;
10:23:57.666337 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.27 seconds
10:23:57.666337 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
10:23:57.666337 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: commit;
10:23:57.746673 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.23 seconds
10:23:57.748670 [debug] [Thread-4  ]: finished collecting timing info
10:23:57.749670 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
10:23:57.875855 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.21 seconds
10:23:57.879761 [debug] [Thread-2  ]: finished collecting timing info
10:23:57.879761 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
10:23:57.915990 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73BBD0A0>]}
10:23:57.916992 [info ] [Thread-4  ]: 4 of 7 OK created incremental model DEMO.hub_order ............................. [[32mSUCCESS 1[0m in 10.72s]
10:23:57.918183 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
10:23:57.919206 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
10:23:57.919206 [info ] [Thread-4  ]: 7 of 7 START incremental model DEMO.hub_supplier ............................... [RUN]
10:23:57.920201 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:23:57.921195 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
10:23:57.921195 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
10:23:57.938075 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:23:57.975654 [debug] [Thread-4  ]: finished collecting timing info
10:23:57.975654 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
10:23:57.981398 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:23:57.981398 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_supplier AS d
    ON a."SUPPLIER_PK" = d."SUPPLIER_PK"
    WHERE d."SUPPLIER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
10:23:57.982402 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
10:23:58.043435 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73B95490>]}
10:23:58.044435 [info ] [Thread-2  ]: 2 of 7 OK created incremental model DEMO.hub_lineitem .......................... [[32mSUCCESS 1[0m in 10.85s]
10:23:58.045431 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
10:23:58.655971 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.04 seconds
10:23:58.660960 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:58.661961 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
10:23:58.781327 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
10:23:58.785329 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:58.785329 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region
10:23:58.884352 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:23:58.890363 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:58.890363 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_REGION"
10:23:58.991585 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.1 seconds
10:23:58.996517 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
10:23:59.033860 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:59.034895 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
10:23:59.267822 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.23 seconds
10:23:59.267822 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:59.267822 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: insert into DV_PROTOTYPE_DB.DEMO.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
        );
10:23:59.732672 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.46 seconds
10:23:59.732672 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
10:23:59.733694 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: commit;
10:24:00.009000 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.28 seconds
10:24:00.012010 [debug] [Thread-3  ]: finished collecting timing info
10:24:00.012922 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_region: Close
10:24:00.344698 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA726D47F0>]}
10:24:00.345662 [info ] [Thread-3  ]: 6 of 7 OK created incremental model DEMO.hub_region ............................ [[32mSUCCESS 1[0m in 5.78s]
10:24:00.346673 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
10:24:00.376665 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.06 seconds
10:24:00.381747 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:00.381747 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
10:24:00.643765 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.26 seconds
10:24:00.648768 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:00.648768 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part
10:24:00.759385 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:24:00.764565 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:00.764565 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_PART"
10:24:00.871696 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:24:00.875660 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
10:24:00.916440 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:00.916440 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
10:24:01.059964 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.14 seconds
10:24:01.059964 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:01.059964 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: insert into DV_PROTOTYPE_DB.DEMO.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
        );
10:24:01.316731 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.26 seconds
10:24:01.317732 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
10:24:01.317732 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: commit;
10:24:01.520083 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
10:24:01.521102 [debug] [Thread-1  ]: finished collecting timing info
10:24:01.522100 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: Close
10:24:01.708898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA726D4C40>]}
10:24:01.708898 [info ] [Thread-1  ]: 5 of 7 OK created incremental model DEMO.hub_part .............................. [[32mSUCCESS 1[0m in 7.45s]
10:24:01.710861 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
10:24:05.207196 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 7.22 seconds
10:24:05.213217 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.213217 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
10:24:05.323396 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
10:24:05.326394 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.326394 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier
10:24:05.452151 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.13 seconds
10:24:05.457867 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.458883 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_SUPPLIER"
10:24:05.553521 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.09 seconds
10:24:05.556521 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.594091 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.594589 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
10:24:05.717225 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
10:24:05.718209 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.718209 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: insert into DV_PROTOTYPE_DB.DEMO.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
        );
10:24:05.950099 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.23 seconds
10:24:05.950099 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
10:24:05.951101 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: commit;
10:24:06.131754 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
10:24:06.135754 [debug] [Thread-4  ]: finished collecting timing info
10:24:06.135754 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
10:24:06.306492 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3e7462-6226-4389-92ae-4265804f6453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73E3E0A0>]}
10:24:06.306492 [info ] [Thread-4  ]: 7 of 7 OK created incremental model DEMO.hub_supplier .......................... [[32mSUCCESS 1[0m in 8.39s]
10:24:06.308035 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
10:24:06.310025 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:24:06.310025 [info ] [MainThread]: 
10:24:06.311138 [info ] [MainThread]: Finished running 7 incremental models in 21.33s.
10:24:06.311710 [debug] [MainThread]: Connection 'master' was properly closed.
10:24:06.312659 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
10:24:06.312659 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
10:24:06.312659 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_part' was properly closed.
10:24:06.312659 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_lineitem' was properly closed.
10:24:06.313305 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_region' was properly closed.
10:24:06.313305 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_supplier' was properly closed.
10:24:06.334294 [info ] [MainThread]: 
10:24:06.334294 [info ] [MainThread]: [32mCompleted successfully[0m
10:24:06.335293 [info ] [MainThread]: 
10:24:06.336295 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
10:24:06.337295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA729E8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73EC7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73EC7E50>]}


============================== 2022-06-14 15:57:46.430386 | 7ea31062-98cb-4c1b-988e-e026e912b148 ==============================
15:57:46.430386 [info ] [MainThread]: Running with dbt=1.1.0
15:57:46.430386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:57:46.430386 [debug] [MainThread]: Tracking: tracking
15:57:46.430386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A4350A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A435310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A435AC0>]}
15:57:49.081222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
15:57:49.081222 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://models\analysis\thirty_day_avg_cost.sql
15:57:49.081222 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://models\transform\prepped_data.sql
15:57:49.081222 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://models\transform\combined_bookings.sql
15:57:49.081222 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://models\transform\customer.sql
15:57:49.081222 [debug] [MainThread]: Partial parsing: added file: dbtvault_snowflake_demo://models\analysis\hotel_count_by_day.sql
15:57:49.122421 [debug] [MainThread]: 1699: static parser successfully parsed analysis\thirty_day_avg_cost.sql
15:57:49.151138 [debug] [MainThread]: 1699: static parser successfully parsed transform\prepped_data.sql
15:57:49.156230 [debug] [MainThread]: 1603: static parser failed on transform\combined_bookings.sql
15:57:49.200932 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform\combined_bookings.sql
15:57:49.200932 [debug] [MainThread]: 1699: static parser successfully parsed transform\customer.sql
15:57:49.205975 [debug] [MainThread]: 1699: static parser successfully parsed analysis\hotel_count_by_day.sql
15:57:49.250307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39B87A0D0>]}
15:57:49.290885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A727A00>]}
15:57:49.290885 [info ] [MainThread]: Found 36 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 3 seed files, 8 sources, 0 exposures, 0 metrics
15:57:49.290885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A7279D0>]}
15:57:49.295910 [info ] [MainThread]: 
15:57:49.300980 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:57:49.302273 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
15:57:49.364751 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
15:57:49.364751 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
15:57:49.364751 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:51.615564 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.25 seconds
15:57:51.654597 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
15:57:51.851299 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
15:57:51.868361 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
15:57:51.868361 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
15:57:51.868361 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:52.571595 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.7 seconds
15:57:52.571595 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
15:57:52.731556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BA8E820>]}
15:57:52.741160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
15:57:52.744669 [info ] [MainThread]: 
15:57:52.754847 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
15:57:52.754847 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
15:57:52.754847 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
15:57:52.757687 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_order
15:57:52.758181 [info ] [Thread-1  ]: 1 of 7 START incremental model DEMO.hub_customer ............................... [RUN]
15:57:52.759400 [info ] [Thread-2  ]: 2 of 7 START incremental model DEMO.hub_lineitem ............................... [RUN]
15:57:52.761059 [info ] [Thread-3  ]: 3 of 7 START incremental model DEMO.hub_nation ................................. [RUN]
15:57:52.762077 [info ] [Thread-4  ]: 4 of 7 START incremental model DEMO.hub_order .................................. [RUN]
15:57:52.762077 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:52.764718 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:57:52.765957 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
15:57:52.767105 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:52.767605 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
15:57:52.768151 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:52.768688 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
15:57:52.769186 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
15:57:52.769698 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
15:57:52.769698 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
15:57:52.776190 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
15:57:52.951382 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_order
15:57:53.222235 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
15:57:53.226259 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
15:57:53.232360 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
15:57:53.251443 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
15:57:53.254961 [debug] [Thread-1  ]: finished collecting timing info
15:57:53.255079 [debug] [Thread-4  ]: finished collecting timing info
15:57:53.255079 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
15:57:53.255079 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
15:57:53.256989 [debug] [Thread-3  ]: finished collecting timing info
15:57:53.270060 [debug] [Thread-2  ]: finished collecting timing info
15:57:53.361373 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
15:57:53.415947 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:53.415947 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
15:57:53.427974 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:53.446217 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:53.446217 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_order AS d
    ON a."ORDER_PK" = d."ORDER_PK"
    WHERE d."ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:57:53.456464 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:57:53.456464 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_customer AS d
    ON a."CUSTOMER_PK" = d."CUSTOMER_PK"
    WHERE d."CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:57:53.458365 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_nation AS d
    ON a."NATION_PK" = d."NATION_PK"
    WHERE d."NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:57:53.458365 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:57:53.458365 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_lineitem AS d
    ON a."LINEITEM_PK" = d."LINEITEM_PK"
    WHERE d."LINEITEM_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:57:53.458365 [debug] [Thread-1  ]: Opening a new connection, currently in state init
15:57:53.458365 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:57:53.463393 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:57:58.788757 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.33 seconds
15:57:58.791397 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.33 seconds
15:57:58.810774 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:58.821416 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:58.821416 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
15:57:58.821416 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
15:57:58.932569 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:57:58.940556 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:58.940556 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order
15:57:58.951350 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.13 seconds
15:57:58.951350 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:58.951350 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer
15:57:59.052573 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
15:57:59.071314 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:59.076429 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_CUSTOMER"
15:57:59.076429 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.14 seconds
15:57:59.088159 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:59.088159 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_ORDER"
15:57:59.195870 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
15:57:59.201543 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:57:59.241662 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
15:57:59.241662 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
15:57:59.289493 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:59.289493 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
15:57:59.291637 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:59.291637 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
15:57:59.421552 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:57:59.423528 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:57:59.424033 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:59.424033 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:59.424033 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: insert into DV_PROTOTYPE_DB.DEMO.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
        );
15:57:59.424033 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: insert into DV_PROTOTYPE_DB.DEMO.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
        );
15:57:59.546803 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.09 seconds
15:57:59.554884 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:59.554884 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
15:57:59.663658 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:57:59.671268 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:59.671268 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation
15:57:59.676285 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.25 seconds
15:57:59.676285 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
15:57:59.681453 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: commit;
15:57:59.696947 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.27 seconds
15:57:59.696947 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
15:57:59.696947 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: commit;
15:57:59.790012 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
15:57:59.791692 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:59.791692 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_NATION"
15:57:59.851275 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
15:57:59.871131 [debug] [Thread-1  ]: finished collecting timing info
15:57:59.871131 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
15:57:59.876611 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
15:57:59.881784 [debug] [Thread-4  ]: finished collecting timing info
15:57:59.881784 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_order: Close
15:57:59.891707 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.1 seconds
15:57:59.891707 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
15:57:59.935520 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:57:59.935520 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
15:58:00.047936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BA99C70>]}
15:58:00.051916 [info ] [Thread-1  ]: 1 of 7 OK created incremental model DEMO.hub_customer .......................... [[32mSUCCESS 1[0m in 7.29s]
15:58:00.051916 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
15:58:00.051916 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_part
15:58:00.051916 [info ] [Thread-1  ]: 5 of 7 START incremental model DEMO.hub_part ................................... [RUN]
15:58:00.051916 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BAC8130>]}
15:58:00.051916 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:00.051916 [info ] [Thread-4  ]: 4 of 7 OK created incremental model DEMO.hub_order ............................. [[32mSUCCESS 1[0m in 7.28s]
15:58:00.051916 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
15:58:00.051916 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_part
15:58:00.061744 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
15:58:00.071663 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
15:58:00.071663 [info ] [Thread-4  ]: 6 of 7 START incremental model DEMO.hub_region ................................. [RUN]
15:58:00.082486 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:00.082486 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.14 seconds
15:58:00.082486 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
15:58:00.090352 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:58:00.099123 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_region
15:58:00.101452 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
15:58:00.101452 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: insert into DV_PROTOTYPE_DB.DEMO.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
        );
15:58:00.131306 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
15:58:00.136318 [debug] [Thread-1  ]: finished collecting timing info
15:58:00.137999 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
15:58:00.147884 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:00.147884 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_part AS d
    ON a."PART_PK" = d."PART_PK"
    WHERE d."PART_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:58:00.148990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:58:00.172223 [debug] [Thread-4  ]: finished collecting timing info
15:58:00.172223 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
15:58:00.181506 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:00.181506 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_region AS d
    ON a."REGION_PK" = d."REGION_PK"
    WHERE d."REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:58:00.181506 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:58:00.429756 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.31 seconds
15:58:00.436349 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
15:58:00.437485 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: commit;
15:58:00.651708 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.21 seconds
15:58:00.651708 [debug] [Thread-3  ]: finished collecting timing info
15:58:00.660867 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
15:58:00.841804 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BAC8B80>]}
15:58:00.841804 [info ] [Thread-3  ]: 3 of 7 OK created incremental model DEMO.hub_nation ............................ [[32mSUCCESS 1[0m in 8.08s]
15:58:00.846345 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
15:58:00.846345 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
15:58:00.846345 [info ] [Thread-3  ]: 7 of 7 START incremental model DEMO.hub_supplier ............................... [RUN]
15:58:00.846345 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:00.851472 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
15:58:00.851506 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
15:58:00.876427 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
15:58:00.881646 [debug] [Thread-3  ]: finished collecting timing info
15:58:00.881646 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
15:58:00.890451 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:00.890451 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_supplier AS d
    ON a."SUPPLIER_PK" = d."SUPPLIER_PK"
    WHERE d."SUPPLIER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
15:58:00.890451 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:58:02.821782 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 9.36 seconds
15:58:02.826401 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:02.826401 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
15:58:02.941636 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
15:58:02.951130 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:02.951130 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem
15:58:03.072750 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
15:58:03.081339 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:03.081339 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_LINEITEM"
15:58:03.221796 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.14 seconds
15:58:03.230811 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:03.271072 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:03.271572 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
15:58:03.401443 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:58:03.401443 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:03.401443 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: insert into DV_PROTOTYPE_DB.DEMO.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
        );
15:58:04.131577 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.73 seconds
15:58:04.131577 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
15:58:04.131577 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: commit;
15:58:04.326846 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.2 seconds
15:58:04.326846 [debug] [Thread-2  ]: finished collecting timing info
15:58:04.331393 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
15:58:04.521885 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BAB2310>]}
15:58:04.521885 [info ] [Thread-2  ]: 2 of 7 OK created incremental model DEMO.hub_lineitem .......................... [[32mSUCCESS 1[0m in 11.76s]
15:58:04.521885 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
15:58:06.564336 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 6.38 seconds
15:58:06.571639 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:06.571639 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
15:58:06.682592 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6.53 seconds
15:58:06.690736 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:06.690736 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
15:58:06.697705 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.13 seconds
15:58:06.701403 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:06.701403 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region
15:58:06.791832 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
15:58:06.806331 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:06.806331 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part
15:58:06.807676 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:58:06.811913 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:06.811913 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_REGION"
15:58:06.921670 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:58:06.926777 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
15:58:06.926777 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
15:58:06.931412 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:06.931412 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_PART"
15:58:06.968005 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 6.08 seconds
15:58:06.976595 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:06.976595 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
15:58:06.982212 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:06.982212 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
15:58:07.038473 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:58:07.051682 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
15:58:07.056767 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:07.056767 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
15:58:07.088462 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:58:07.096456 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.096456 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier
15:58:07.111380 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:58:07.111380 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:07.111380 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: insert into DV_PROTOTYPE_DB.DEMO.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
        );
15:58:07.185684 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:58:07.185684 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:07.185684 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: insert into DV_PROTOTYPE_DB.DEMO.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
        );
15:58:07.201781 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.11 seconds
15:58:07.214395 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.214395 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_SUPPLIER"
15:58:07.305441 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.09 seconds
15:58:07.305441 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.313522 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.313522 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
15:58:07.389934 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.28 seconds
15:58:07.389934 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
15:58:07.389934 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: commit;
15:58:07.439434 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
15:58:07.439434 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.447454 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: insert into DV_PROTOTYPE_DB.DEMO.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
        );
15:58:07.447454 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.26 seconds
15:58:07.447454 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
15:58:07.447454 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: commit;
15:58:07.592852 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
15:58:07.592852 [debug] [Thread-4  ]: finished collecting timing info
15:58:07.592852 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: Close
15:58:07.628363 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
15:58:07.631812 [debug] [Thread-1  ]: finished collecting timing info
15:58:07.631812 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_part: Close
15:58:07.722229 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.27 seconds
15:58:07.730303 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
15:58:07.730303 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: commit;
15:58:07.778789 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BC3F820>]}
15:58:07.778789 [info ] [Thread-4  ]: 6 of 7 OK created incremental model DEMO.hub_region ............................ [[32mSUCCESS 1[0m in 7.70s]
15:58:07.779901 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
15:58:07.814041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BBA3250>]}
15:58:07.814041 [info ] [Thread-1  ]: 5 of 7 OK created incremental model DEMO.hub_part .............................. [[32mSUCCESS 1[0m in 7.76s]
15:58:07.822297 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
15:58:07.906604 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
15:58:07.908442 [debug] [Thread-3  ]: finished collecting timing info
15:58:07.909378 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
15:58:08.065364 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea31062-98cb-4c1b-988e-e026e912b148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39B862100>]}
15:58:08.065364 [info ] [Thread-3  ]: 7 of 7 OK created incremental model DEMO.hub_supplier .......................... [[32mSUCCESS 1[0m in 7.22s]
15:58:08.065364 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
15:58:08.074226 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:58:08.074226 [info ] [MainThread]: 
15:58:08.074226 [info ] [MainThread]: Finished running 7 incremental models in 18.77s.
15:58:08.074226 [debug] [MainThread]: Connection 'master' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_part' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_lineitem' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_supplier' was properly closed.
15:58:08.074226 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.hub_region' was properly closed.
15:58:08.141626 [info ] [MainThread]: 
15:58:08.141626 [info ] [MainThread]: [32mCompleted successfully[0m
15:58:08.141626 [info ] [MainThread]: 
15:58:08.141626 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
15:58:08.141626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BABDDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39BABDB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A727910>]}


============================== 2022-06-15 12:59:10.610269 | fecbc575-e275-4ff0-85ae-6d542b7bd310 ==============================
12:59:10.610269 [info ] [MainThread]: Running with dbt=1.1.0
12:59:10.611771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:59:10.612271 [debug] [MainThread]: Tracking: tracking
12:59:10.613778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63CD8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63CD8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63CD80D0>]}
12:59:13.000700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:59:13.000700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:59:13.016509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63D7B0D0>]}
12:59:13.041737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63E87310>]}
12:59:13.041737 [info ] [MainThread]: Found 36 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 3 seed files, 8 sources, 0 exposures, 0 metrics
12:59:13.041737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63E87100>]}
12:59:13.045074 [info ] [MainThread]: 
12:59:13.045074 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:59:13.052273 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
12:59:13.076037 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
12:59:13.078793 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
12:59:13.078793 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:59:14.196329 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.12 seconds
12:59:14.237748 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
12:59:14.379844 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
12:59:14.389523 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
12:59:14.389523 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
12:59:14.389523 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:59:14.897544 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.51 seconds
12:59:14.913193 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
12:59:15.073407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63DEEEE0>]}
12:59:15.074320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
12:59:15.074821 [info ] [MainThread]: 
12:59:15.092867 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.combined_bookings
12:59:15.092867 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.customer
12:59:15.092867 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
12:59:15.092867 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
12:59:15.092867 [info ] [Thread-1  ]: 1 of 36 START view model DEMO.combined_bookings ................................ [RUN]
12:59:15.092867 [info ] [Thread-2  ]: 2 of 36 START view model DEMO.customer ......................................... [RUN]
12:59:15.098064 [info ] [Thread-3  ]: 3 of 36 START view model DEMO.raw_orders ....................................... [RUN]
12:59:15.099062 [info ] [Thread-4  ]: 4 of 36 START view model DEMO.raw_transactions ................................. [RUN]
12:59:15.099587 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
12:59:15.099587 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.customer"
12:59:15.104043 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
12:59:15.104043 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.combined_bookings
12:59:15.106000 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
12:59:15.107268 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.customer
12:59:15.107268 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
12:59:15.107268 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.combined_bookings
12:59:15.107268 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
12:59:15.107268 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.customer
12:59:15.107268 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
12:59:15.131199 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
12:59:15.156278 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
12:59:15.164405 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.customer"
12:59:15.164405 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
12:59:15.172871 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
12:59:15.172871 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

    describe table DV_PROTOTYPE_DB.DEMO.bookings_1
12:59:15.172871 [debug] [Thread-1  ]: Opening a new connection, currently in state init
12:59:15.181128 [debug] [Thread-2  ]: finished collecting timing info
12:59:15.181128 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.customer
12:59:15.206186 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.customer"
12:59:15.206186 [debug] [Thread-4  ]: finished collecting timing info
12:59:15.206186 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
12:59:15.214340 [debug] [Thread-3  ]: finished collecting timing info
12:59:15.214906 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
12:59:15.214906 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
12:59:15.214906 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
12:59:15.214906 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.customer"
12:59:15.214906 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.customer"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.customer
  
   as (
    SELECT ID 
    , FIRST_NAME
    , LAST_NAME
    , birthdate
FROM DV_PROTOTYPE_DB.DEMO.customers
  );
12:59:15.214906 [debug] [Thread-2  ]: Opening a new connection, currently in state init
12:59:15.223150 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
12:59:15.223150 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
12:59:15.223150 [debug] [Thread-4  ]: Opening a new connection, currently in state init
12:59:15.223150 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
12:59:15.223150 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
12:59:15.223150 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:59:15.906800 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f6cb-0000-3be4-0000-9e95002b10de
12:59:15.906800 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
12:59:15.906800 [debug] [Thread-2  ]: finished collecting timing info
12:59:15.922584 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f6cb-0000-3bee-0000-9e95002b005a
12:59:15.922584 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.customer: Close
12:59:15.922584 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'DV_PROTOTYPE_DB.DEMO.BOOKINGS_1' does not exist or not authorized.
12:59:15.922584 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
12:59:15.922584 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
12:59:15.922584 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
12:59:15.922584 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

    describe table DV_PROTOTYPE_DB.DEMO.bookings_2
12:59:16.007184 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.78 seconds
12:59:16.007184 [debug] [Thread-4  ]: finished collecting timing info
12:59:16.007184 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
12:59:16.022831 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.8 seconds
12:59:16.038452 [debug] [Thread-3  ]: finished collecting timing info
12:59:16.038452 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
12:59:16.040648 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f6cb-0000-3be4-0000-9e95002b10e2
12:59:16.040648 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'DV_PROTOTYPE_DB.DEMO.BOOKINGS_2' does not exist or not authorized.
12:59:16.040648 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
12:59:16.040648 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
12:59:16.040648 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.combined_bookings"
12:59:16.040648 [debug] [Thread-1  ]: finished collecting timing info
12:59:16.048678 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.combined_bookings
12:59:16.048678 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.combined_bookings"
12:59:16.054345 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
12:59:16.054345 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.combined_bookings
  
   as (
    

        (
            select

                cast('DV_PROTOTYPE_DB.DEMO.bookings_1' as 
    varchar
) as _dbt_source_relation,
                

            from DV_PROTOTYPE_DB.DEMO.bookings_1
        )

        union all
        

        (
            select

                cast('DV_PROTOTYPE_DB.DEMO.bookings_2' as 
    varchar
) as _dbt_source_relation,
                

            from DV_PROTOTYPE_DB.DEMO.bookings_2
        )

        
  );
12:59:16.072905 [debug] [Thread-2  ]: Database Error in model customer (models\transform\customer.sql)
  002003 (42S02): SQL compilation error:
  Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\customer.sql
12:59:16.072905 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B63D44DC0>]}
12:59:16.072905 [error] [Thread-2  ]: 2 of 36 ERROR creating view model DEMO.customer ................................ [[31mERROR[0m in 0.97s]
12:59:16.072905 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.customer
12:59:16.148720 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B652C5910>]}
12:59:16.148720 [info ] [Thread-4  ]: 4 of 36 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 1.04s]
12:59:16.148720 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
12:59:16.156489 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
12:59:16.156489 [info ] [Thread-2  ]: 5 of 36 START view model DEMO.v_stg_transactions ............................... [RUN]
12:59:16.156489 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:16.156489 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
12:59:16.156489 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
12:59:16.181701 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:16.181701 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
12:59:16.181701 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:16.189423 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f6cb-0000-3bee-0000-9e95002b0066
12:59:16.195540 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B652C5700>]}
12:59:16.195540 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 12 unexpected 'from'.
syntax error line 28 at position 12 unexpected 'from'.
12:59:16.196042 [info ] [Thread-3  ]: 3 of 36 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 1.09s]
12:59:16.196042 [debug] [Thread-1  ]: finished collecting timing info
12:59:16.196042 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: Close
12:59:16.196042 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
12:59:16.204190 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
12:59:16.204691 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
12:59:16.205419 [info ] [Thread-4  ]: 6 of 36 START view model DEMO.raw_inventory .................................... [RUN]
12:59:16.206515 [info ] [Thread-3  ]: 7 of 36 START view model DEMO.v_stg_orders ..................................... [RUN]
12:59:16.208985 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
12:59:16.210088 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:16.210707 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
12:59:16.211212 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
12:59:16.211212 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
12:59:16.211212 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
12:59:16.216798 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
12:59:16.233325 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:16.233325 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
12:59:16.233325 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:16.241110 [debug] [Thread-4  ]: finished collecting timing info
12:59:16.242170 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
12:59:16.249026 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
12:59:16.254118 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
12:59:16.254118 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
12:59:16.255907 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:16.355035 [debug] [Thread-1  ]: Database Error in model combined_bookings (models\transform\combined_bookings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 12 unexpected 'from'.
  syntax error line 28 at position 12 unexpected 'from'.
  compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\combined_bookings.sql
12:59:16.355035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6534DE50>]}
12:59:16.355035 [error] [Thread-1  ]: 1 of 36 ERROR creating view model DEMO.combined_bookings ....................... [[31mERROR[0m in 1.26s]
12:59:16.355035 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.combined_bookings
12:59:16.355035 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.prepped_data
12:59:16.355035 [info ] [Thread-1  ]: 8 of 36 SKIP relation DEMO.prepped_data ........................................ [[33mSKIP[0m]
12:59:16.360178 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.prepped_data
12:59:16.360178 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hotel_count_by_day
12:59:16.361919 [info ] [Thread-1  ]: 9 of 36 SKIP relation DEMO.hotel_count_by_day .................................. [[33mSKIP[0m]
12:59:16.362235 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hotel_count_by_day
12:59:16.362235 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.thirty_day_avg_cost
12:59:16.362235 [info ] [Thread-1  ]: 10 of 36 SKIP relation DEMO.thirty_day_avg_cost ................................ [[33mSKIP[0m]
12:59:16.362235 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.thirty_day_avg_cost
12:59:16.638354 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.46 seconds
12:59:16.687132 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.45 seconds
12:59:16.707599 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:16.707599 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
12:59:16.723526 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:16.723526 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
12:59:16.830029 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.11 seconds
12:59:16.859309 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.15 seconds
12:59:16.951849 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.7 seconds
12:59:16.967461 [debug] [Thread-4  ]: finished collecting timing info
12:59:16.967461 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
12:59:16.967461 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:16.983163 [debug] [Thread-2  ]: finished collecting timing info
12:59:16.999122 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
12:59:16.999122 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:17.025113 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
12:59:17.025113 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:59:17.072846 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:17.072846 [debug] [Thread-3  ]: finished collecting timing info
12:59:17.072846 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
12:59:17.089336 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:17.089336 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
12:59:17.089336 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
12:59:17.140471 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B653DAAF0>]}
12:59:17.140471 [info ] [Thread-4  ]: 6 of 36 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 0.93s]
12:59:17.140471 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
12:59:17.140471 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
12:59:17.140471 [info ] [Thread-1  ]: 11 of 36 START view model DEMO.v_stg_inventory ................................. [RUN]
12:59:17.153580 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.153580 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
12:59:17.153580 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
12:59:17.156180 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.156180 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
12:59:17.156180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:17.349805 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.32 seconds
12:59:17.352955 [debug] [Thread-2  ]: finished collecting timing info
12:59:17.352955 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
12:59:17.424947 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.34 seconds
12:59:17.424947 [debug] [Thread-3  ]: finished collecting timing info
12:59:17.424947 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
12:59:17.489411 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B653EB730>]}
12:59:17.489411 [info ] [Thread-2  ]: 5 of 36 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.33s]
12:59:17.489411 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
12:59:17.489411 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
12:59:17.489411 [info ] [Thread-4  ]: 12 of 36 START incremental model DEMO.t_link_transactions ...................... [RUN]
12:59:17.503911 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:17.503911 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
12:59:17.503911 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
12:59:17.600442 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:17.602581 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.45 seconds
12:59:17.603657 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65516640>]}
12:59:17.612603 [info ] [Thread-3  ]: 7 of 36 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.39s]
12:59:17.614570 [debug] [Thread-4  ]: finished collecting timing info
12:59:17.615153 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
12:59:17.617225 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
12:59:17.631673 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
12:59:17.631673 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
12:59:17.631673 [info ] [Thread-2  ]: 13 of 36 START incremental model DEMO.hub_customer ............................. [RUN]
12:59:17.667760 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:17.667760 [info ] [Thread-3  ]: 14 of 36 START incremental model DEMO.hub_lineitem ............................. [RUN]
12:59:17.672973 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.t_link_transactions AS tgt
    ON stg."TRANSACTION_PK" = tgt."TRANSACTION_PK"
    WHERE tgt."TRANSACTION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:17.672973 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:17.681261 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:17.681261 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:17.689521 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
12:59:17.690023 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.698123 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
12:59:17.698123 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
12:59:17.698123 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
12:59:17.698123 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
12:59:17.754273 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
12:59:17.762910 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:17.795102 [debug] [Thread-2  ]: finished collecting timing info
12:59:17.796102 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
12:59:17.800818 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:17.800818 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_customer AS d
    ON a."CUSTOMER_PK" = d."CUSTOMER_PK"
    WHERE d."CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:17.800818 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:17.800818 [debug] [Thread-3  ]: finished collecting timing info
12:59:17.800818 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
12:59:17.824374 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:17.824374 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_lineitem AS d
    ON a."LINEITEM_PK" = d."LINEITEM_PK"
    WHERE d."LINEITEM_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:17.824374 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:17.846794 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.11 seconds
12:59:17.958869 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.960557 [debug] [Thread-1  ]: finished collecting timing info
12:59:17.960557 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
12:59:17.965101 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.973379 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
12:59:17.973809 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
12:59:18.305840 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.33 seconds
12:59:18.305840 [debug] [Thread-1  ]: finished collecting timing info
12:59:18.305840 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
12:59:18.439707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B657D3FA0>]}
12:59:18.439707 [info ] [Thread-1  ]: 11 of 36 OK created view model DEMO.v_stg_inventory ............................ [[32mSUCCESS 1[0m in 1.29s]
12:59:18.448057 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
12:59:18.448057 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
12:59:18.448057 [info ] [Thread-1  ]: 15 of 36 START incremental model DEMO.hub_order ................................ [RUN]
12:59:18.448057 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:18.448057 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
12:59:18.448057 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
12:59:18.464767 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
12:59:18.501439 [debug] [Thread-1  ]: finished collecting timing info
12:59:18.501439 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
12:59:18.507197 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:18.507197 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_order AS d
    ON a."ORDER_PK" = d."ORDER_PK"
    WHERE d."ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:18.507197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:22.930274 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.11 seconds
12:59:22.934547 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:22.934547 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
12:59:23.065288 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.13 seconds
12:59:23.065288 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.065288 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem
12:59:23.181714 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.12 seconds
12:59:23.181714 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.181714 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_LINEITEM"
12:59:23.286865 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.11 seconds
12:59:23.302838 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.306399 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.306399 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
12:59:23.323031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.82 seconds
12:59:23.323031 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:23.323031 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
12:59:23.378695 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.7 seconds
12:59:23.378695 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.378695 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
12:59:23.425531 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:23.425531 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.425531 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: insert into DV_PROTOTYPE_DB.DEMO.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
        );
12:59:23.452019 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.13 seconds
12:59:23.452019 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.65 seconds
12:59:23.452019 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:23.467854 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.467854 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order
12:59:23.467854 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
12:59:23.483745 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.11 seconds
12:59:23.499227 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.499227 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions
12:59:23.575922 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.11 seconds
12:59:23.575922 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.575922 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
12:59:23.575922 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer
12:59:23.575922 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:23.575922 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_ORDER"
12:59:23.609960 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.11 seconds
12:59:23.609960 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.609960 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."T_LINK_TRANSACTIONS"
12:59:23.658952 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.23 seconds
12:59:23.659719 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
12:59:23.660018 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: commit;
12:59:23.678133 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:23.678133 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
12:59:23.678133 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:23.678133 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
12:59:23.694236 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.12 seconds
12:59:23.694236 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.694236 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_CUSTOMER"
12:59:23.710199 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.1 seconds
12:59:23.710199 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.710199 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.710199 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
12:59:23.790111 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:23.790111 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.790111 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.790111 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
12:59:23.807269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:23.807269 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:23.807269 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: insert into DV_PROTOTYPE_DB.DEMO.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
        );
12:59:23.823134 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:23.835732 [debug] [Thread-3  ]: finished collecting timing info
12:59:23.835732 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
12:59:23.835732 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:23.835732 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:23.835732 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: insert into DV_PROTOTYPE_DB.DEMO.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
        );
12:59:23.929794 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.14 seconds
12:59:23.930899 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:23.930899 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: insert into DV_PROTOTYPE_DB.DEMO.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
        );
12:59:24.003567 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B656AC3D0>]}
12:59:24.004798 [info ] [Thread-3  ]: 14 of 36 OK created incremental model DEMO.hub_lineitem ........................ [[32mSUCCESS 1[0m in 6.32s]
12:59:24.005806 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
12:59:24.006306 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
12:59:24.006809 [info ] [Thread-3  ]: 16 of 36 START incremental model DEMO.link_customer_nation ..................... [RUN]
12:59:24.008457 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:24.009034 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
12:59:24.009459 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
12:59:24.041987 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.23 seconds
12:59:24.050037 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
12:59:24.050037 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: commit;
12:59:24.057229 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:24.057229 [debug] [Thread-3  ]: finished collecting timing info
12:59:24.057229 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
12:59:24.124326 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.29 seconds
12:59:24.124326 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
12:59:24.124326 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: commit;
12:59:24.124326 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:24.124326 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_nation AS d
    ON a."LINK_CUSTOMER_NATION_PK" = d."LINK_CUSTOMER_NATION_PK"
    WHERE d."LINK_CUSTOMER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:24.124326 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:24.124326 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.19 seconds
12:59:24.124326 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
12:59:24.124326 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: commit;
12:59:24.221197 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:24.221197 [debug] [Thread-1  ]: finished collecting timing info
12:59:24.221197 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
12:59:24.293114 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:24.293114 [debug] [Thread-4  ]: finished collecting timing info
12:59:24.293114 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
12:59:24.293114 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.15 seconds
12:59:24.293114 [debug] [Thread-2  ]: finished collecting timing info
12:59:24.293114 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
12:59:24.367133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B657D6190>]}
12:59:24.367133 [info ] [Thread-1  ]: 15 of 36 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 5.92s]
12:59:24.383560 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
12:59:24.383560 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
12:59:24.384500 [info ] [Thread-1  ]: 17 of 36 START incremental model DEMO.link_customer_order ...................... [RUN]
12:59:24.385577 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:24.385577 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
12:59:24.385577 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
12:59:24.401127 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
12:59:24.401823 [debug] [Thread-1  ]: finished collecting timing info
12:59:24.401823 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
12:59:24.407307 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:24.407802 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_order AS d
    ON a."ORDER_CUSTOMER_PK" = d."ORDER_CUSTOMER_PK"
    WHERE d."ORDER_CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:24.407802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:24.463214 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B657FBC10>]}
12:59:24.463214 [info ] [Thread-2  ]: 13 of 36 OK created incremental model DEMO.hub_customer ........................ [[32mSUCCESS 1[0m in 6.79s]
12:59:24.463214 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
12:59:24.463214 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
12:59:24.463214 [info ] [Thread-2  ]: 18 of 36 START incremental model DEMO.link_inventory_allocation ................ [RUN]
12:59:24.470582 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65783040>]}
12:59:24.470582 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:24.470582 [info ] [Thread-4  ]: 12 of 36 OK created incremental model DEMO.t_link_transactions ................. [[32mSUCCESS 1[0m in 6.97s]
12:59:24.470582 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
12:59:24.470582 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
12:59:24.478714 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
12:59:24.478714 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
12:59:24.478714 [info ] [Thread-4  ]: 19 of 36 START incremental model DEMO.link_order_lineitem ...................... [RUN]
12:59:24.486705 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:24.486705 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
12:59:24.486705 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
12:59:24.507534 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:24.516028 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:24.516028 [debug] [Thread-2  ]: finished collecting timing info
12:59:24.516028 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
12:59:24.524150 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:24.524150 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory_allocation AS d
    ON a."INVENTORY_ALLOCATION_PK" = d."INVENTORY_ALLOCATION_PK"
    WHERE d."INVENTORY_ALLOCATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:24.524150 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:24.529109 [debug] [Thread-4  ]: finished collecting timing info
12:59:24.529109 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
12:59:24.537320 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:24.537320 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_order_lineitem AS d
    ON a."LINK_LINEITEM_ORDER_PK" = d."LINK_LINEITEM_ORDER_PK"
    WHERE d."LINK_LINEITEM_ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:24.537320 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:26.103774 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.98 seconds
12:59:26.108747 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.108973 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
12:59:26.206055 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:26.221638 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.221638 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation
12:59:26.307349 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
12:59:26.323420 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.323420 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_NATION"
12:59:26.424347 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:26.426862 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.439604 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.439604 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
12:59:26.550451 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:26.550451 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.550451 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: insert into DV_PROTOTYPE_DB.DEMO.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
        );
12:59:26.707634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.3 seconds
12:59:26.707634 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:26.707634 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
12:59:26.814129 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:26.829890 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:26.829890 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order
12:59:26.845518 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.3 seconds
12:59:26.845518 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
12:59:26.845518 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: commit;
12:59:26.874239 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.35 seconds
12:59:26.874239 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:26.874239 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
12:59:26.936594 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
12:59:26.944888 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:26.944966 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_ORDER"
12:59:26.985794 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.11 seconds
12:59:26.985794 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:26.985794 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation
12:59:26.985794 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.45 seconds
12:59:27.002076 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.002076 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
12:59:27.012202 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:27.012202 [debug] [Thread-3  ]: finished collecting timing info
12:59:27.012202 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
12:59:27.043625 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:27.043625 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
12:59:27.043625 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:27.043625 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
12:59:27.092467 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.11 seconds
12:59:27.092467 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:27.092467 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY_ALLOCATION"
12:59:27.092467 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
12:59:27.092467 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.092467 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem
12:59:27.173483 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:27.173983 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:27.173983 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: insert into DV_PROTOTYPE_DB.DEMO.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
        );
12:59:27.177200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B658A8850>]}
12:59:27.179047 [info ] [Thread-3  ]: 16 of 36 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 3.17s]
12:59:27.179047 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
12:59:27.180603 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
12:59:27.180981 [info ] [Thread-3  ]: 20 of 36 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
12:59:27.183181 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:27.183302 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
12:59:27.183302 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
12:59:27.224000 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.13 seconds
12:59:27.224000 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.13 seconds
12:59:27.232087 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:27.232087 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:27.241262 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.241262 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_ORDER_LINEITEM"
12:59:27.283165 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:27.283165 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
12:59:27.283165 [debug] [Thread-3  ]: finished collecting timing info
12:59:27.283165 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
12:59:27.291941 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:27.291941 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_NATION_HASHDIFF" != stage."CUSTOMER_NATION_HASHDIFF"
                OR latest_records."CUSTOMER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:27.291941 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:27.342815 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
12:59:27.351308 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.351308 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.351308 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
12:59:27.392986 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:27.392986 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:27.392986 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DV_PROTOTYPE_DB.DEMO.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
        );
12:59:27.437633 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.26 seconds
12:59:27.437633 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
12:59:27.437633 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: commit;
12:59:27.473797 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:27.473797 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.473797 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DV_PROTOTYPE_DB.DEMO.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
        );
12:59:27.608999 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:27.608999 [debug] [Thread-1  ]: finished collecting timing info
12:59:27.608999 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
12:59:27.640227 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.25 seconds
12:59:27.640227 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
12:59:27.640227 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
12:59:27.740747 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.27 seconds
12:59:27.740747 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
12:59:27.740747 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
12:59:27.762915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6566CC40>]}
12:59:27.762915 [info ] [Thread-1  ]: 17 of 36 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 3.38s]
12:59:27.762915 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
12:59:27.762915 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
12:59:27.762915 [info ] [Thread-1  ]: 21 of 36 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
12:59:27.768359 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:27.768359 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
12:59:27.768359 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
12:59:27.782414 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:27.813206 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:27.814561 [debug] [Thread-2  ]: finished collecting timing info
12:59:27.815653 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
12:59:27.826526 [debug] [Thread-1  ]: finished collecting timing info
12:59:27.827100 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
12:59:27.827100 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:27.827100 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_REGION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_REGION_HASHDIFF" != stage."CUSTOMER_REGION_HASHDIFF"
                OR latest_records."CUSTOMER_REGION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:27.827100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:27.920702 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
12:59:27.922370 [debug] [Thread-4  ]: finished collecting timing info
12:59:27.922411 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
12:59:27.963469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65720EB0>]}
12:59:27.963469 [info ] [Thread-2  ]: 18 of 36 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 3.49s]
12:59:27.963469 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
12:59:27.963469 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
12:59:27.963469 [info ] [Thread-2  ]: 22 of 36 START incremental model DEMO.sat_order_customer_details ............... [RUN]
12:59:27.979528 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:27.979528 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
12:59:27.979528 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
12:59:28.000390 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:28.050274 [debug] [Thread-2  ]: finished collecting timing info
12:59:28.050274 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
12:59:28.058365 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:28.058365 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_HASHDIFF" != stage."CUSTOMER_HASHDIFF"
                OR latest_records."CUSTOMER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:28.058365 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:28.090442 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B652D4610>]}
12:59:28.090442 [info ] [Thread-4  ]: 19 of 36 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 3.60s]
12:59:28.090442 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
12:59:28.090442 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
12:59:28.090442 [info ] [Thread-4  ]: 23 of 36 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
12:59:28.094397 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:28.094397 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
12:59:28.094397 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
12:59:28.121585 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:28.123898 [debug] [Thread-4  ]: finished collecting timing info
12:59:28.123898 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
12:59:28.132889 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:28.132889 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."LINEITEM_PK", current_records."LINEITEM_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."LINEITEM_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."LINEITEM_PK"
                FROM source_data
            ) AS source_records
                ON current_records."LINEITEM_PK" = source_records."LINEITEM_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."LINEITEM_PK" = stage."LINEITEM_PK"
            WHERE latest_records."LINEITEM_HASHDIFF" != stage."LINEITEM_HASHDIFF"
                OR latest_records."LINEITEM_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:28.132889 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:29.515090 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.22 seconds
12:59:29.515090 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:29.515090 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
12:59:29.632246 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:29.632246 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:29.632246 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details
12:59:29.725462 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.09 seconds
12:59:29.725462 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:29.725462 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_NATION_DETAILS"
12:59:29.840945 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:29.840945 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:29.880148 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:29.880148 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
12:59:29.895910 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.07 seconds
12:59:29.911441 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:29.911441 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
12:59:30.008576 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:30.008797 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:30.009404 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
        );
12:59:30.025191 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.11 seconds
12:59:30.025191 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.025191 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details
12:59:30.142330 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:30.150164 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.150164 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_REGION_DETAILS"
12:59:30.240418 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.09 seconds
12:59:30.240418 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.247681 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.247681 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
12:59:30.352844 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:30.352844 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.352844 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
        );
12:59:30.412464 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.4 seconds
12:59:30.412464 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
12:59:30.412464 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
12:59:30.596923 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
12:59:30.596923 [debug] [Thread-3  ]: finished collecting timing info
12:59:30.596923 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
12:59:30.649535 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.3 seconds
12:59:30.649535 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
12:59:30.649535 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
12:59:30.753066 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B656CE160>]}
12:59:30.753066 [info ] [Thread-3  ]: 20 of 36 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 3.57s]
12:59:30.753066 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
12:59:30.757463 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
12:59:30.757463 [info ] [Thread-3  ]: 24 of 36 START incremental model DEMO.sat_order_order_details .................. [RUN]
12:59:30.758997 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:30.758997 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
12:59:30.758997 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
12:59:30.776956 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:30.817003 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:30.819244 [debug] [Thread-1  ]: finished collecting timing info
12:59:30.819244 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
12:59:30.820298 [debug] [Thread-3  ]: finished collecting timing info
12:59:30.820298 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
12:59:30.828397 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:30.828397 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."ORDER_PK", current_records."ORDER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."ORDER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."ORDER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."ORDER_PK" = source_records."ORDER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."ORDER_PK" = stage."ORDER_PK"
            WHERE latest_records."ORDER_HASHDIFF" != stage."ORDER_HASHDIFF"
                OR latest_records."ORDER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:30.828397 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:30.972945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65600100>]}
12:59:30.972945 [info ] [Thread-1  ]: 21 of 36 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 3.20s]
12:59:30.972945 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
12:59:30.972945 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
12:59:30.972945 [info ] [Thread-1  ]: 25 of 36 START incremental model DEMO.hub_nation ............................... [RUN]
12:59:30.980222 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:30.980222 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
12:59:30.980222 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
12:59:30.995834 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
12:59:30.999636 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.94 seconds
12:59:31.004646 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.004838 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
12:59:31.033123 [debug] [Thread-1  ]: finished collecting timing info
12:59:31.033123 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
12:59:31.033123 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:31.033123 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_nation AS d
    ON a."NATION_PK" = d."NATION_PK"
    WHERE d."NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:31.033123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:31.118844 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.11 seconds
12:59:31.118844 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.118844 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details
12:59:31.251173 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.13 seconds
12:59:31.255070 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.255981 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUSTOMER_DETAILS"
12:59:31.343191 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.09 seconds
12:59:31.343191 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.343191 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.343191 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
12:59:31.462824 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:31.462824 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.462824 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
        );
12:59:31.791577 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.33 seconds
12:59:31.791577 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
12:59:31.791577 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
12:59:32.011099 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.22 seconds
12:59:32.015008 [debug] [Thread-2  ]: finished collecting timing info
12:59:32.015008 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
12:59:32.158940 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6570E370>]}
12:59:32.158940 [info ] [Thread-2  ]: 22 of 36 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 4.18s]
12:59:32.169044 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
12:59:32.169044 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_part
12:59:32.169044 [info ] [Thread-2  ]: 26 of 36 START incremental model DEMO.hub_part ................................. [RUN]
12:59:32.169044 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:32.171674 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
12:59:32.172122 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_part
12:59:32.181246 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
12:59:32.181246 [debug] [Thread-2  ]: finished collecting timing info
12:59:32.184909 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
12:59:32.192908 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:32.192908 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_part AS d
    ON a."PART_PK" = d."PART_PK"
    WHERE d."PART_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:32.192908 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:32.819405 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.69 seconds
12:59:32.825468 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:32.826309 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
12:59:32.926306 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.1 seconds
12:59:32.941928 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:32.941928 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details
12:59:33.041652 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.1 seconds
12:59:33.041652 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:33.041652 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_LINEITEM_DETAILS"
12:59:33.142670 [debug] [Thread-4  ]: SQL status: SUCCESS 16 in 0.1 seconds
12:59:33.145751 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:33.168594 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:33.168728 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
12:59:33.295483 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:33.295483 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:33.295483 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
        );
12:59:33.646532 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.35 seconds
12:59:33.646532 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
12:59:33.647588 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
12:59:33.805631 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:33.805631 [debug] [Thread-4  ]: finished collecting timing info
12:59:33.805631 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
12:59:33.868035 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.04 seconds
12:59:33.869835 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:33.875711 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
12:59:33.973876 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65364520>]}
12:59:33.973876 [info ] [Thread-4  ]: 23 of 36 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 5.88s]
12:59:33.973876 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
12:59:33.973876 [debug] [Thread-3  ]: SQL status: SUCCESS 12 in 0.1 seconds
12:59:33.981944 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
12:59:33.981944 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:33.981944 [info ] [Thread-4  ]: 27 of 36 START incremental model DEMO.hub_region ............................... [RUN]
12:59:33.981944 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details
12:59:33.991143 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:33.991944 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
12:59:33.991944 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_region
12:59:34.007548 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
12:59:34.012819 [debug] [Thread-4  ]: finished collecting timing info
12:59:34.012819 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
12:59:34.012819 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:34.012819 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_region AS d
    ON a."REGION_PK" = d."REGION_PK"
    WHERE d."REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:34.012819 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:34.117103 [debug] [Thread-3  ]: SQL status: SUCCESS 12 in 0.13 seconds
12:59:34.125690 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:34.125690 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_ORDER_DETAILS"
12:59:34.207502 [debug] [Thread-3  ]: SQL status: SUCCESS 12 in 0.08 seconds
12:59:34.207502 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:34.207502 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:34.207502 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
12:59:34.363029 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:34.363029 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:34.363029 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
        );
12:59:34.633508 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.27 seconds
12:59:34.634004 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
12:59:34.634004 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
12:59:34.795714 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:34.798209 [debug] [Thread-3  ]: finished collecting timing info
12:59:34.798714 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
12:59:34.941675 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6570E130>]}
12:59:34.941675 [info ] [Thread-3  ]: 24 of 36 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 4.18s]
12:59:34.941675 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
12:59:34.941675 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
12:59:34.951368 [info ] [Thread-3  ]: 28 of 36 START incremental model DEMO.hub_supplier ............................. [RUN]
12:59:34.951368 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:34.953327 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
12:59:34.953664 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
12:59:34.966478 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
12:59:34.966478 [debug] [Thread-3  ]: finished collecting timing info
12:59:34.966478 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
12:59:34.974877 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:34.974877 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_supplier AS d
    ON a."SUPPLIER_PK" = d."SUPPLIER_PK"
    WHERE d."SUPPLIER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:34.974877 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:36.354386 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.16 seconds
12:59:36.354386 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:36.354386 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
12:59:36.448016 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.09 seconds
12:59:36.528914 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:36.528914 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part
12:59:36.640304 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.11 seconds
12:59:36.640304 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:36.640304 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_PART"
12:59:36.744237 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:36.744237 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
12:59:36.744237 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:36.744237 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
12:59:36.868442 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:36.869373 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:36.869433 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: insert into DV_PROTOTYPE_DB.DEMO.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
        );
12:59:37.101563 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.23 seconds
12:59:37.104228 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
12:59:37.105400 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: commit;
12:59:37.277776 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:37.277776 [debug] [Thread-2  ]: finished collecting timing info
12:59:37.277776 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_part: Close
12:59:37.431445 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B653C7550>]}
12:59:37.431445 [info ] [Thread-2  ]: 26 of 36 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 5.26s]
12:59:37.441183 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
12:59:37.441505 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
12:59:37.441957 [info ] [Thread-2  ]: 29 of 36 START incremental model DEMO.link_inventory ........................... [RUN]
12:59:37.442462 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:37.442462 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
12:59:37.442462 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
12:59:37.458150 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
12:59:37.499286 [debug] [Thread-2  ]: finished collecting timing info
12:59:37.499286 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
12:59:37.499286 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:37.499286 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory AS d
    ON a."INVENTORY_PK" = d."INVENTORY_PK"
    WHERE d."INVENTORY_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:37.499286 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:38.018193 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.01 seconds
12:59:38.034337 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.034337 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
12:59:38.134313 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:38.134313 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.134313 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region
12:59:38.234443 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:38.250501 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.250501 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_REGION"
12:59:38.348581 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:38.348581 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
12:59:38.364149 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.364149 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
12:59:38.479056 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:38.479056 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.479056 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: insert into DV_PROTOTYPE_DB.DEMO.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
        );
12:59:38.704275 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.23 seconds
12:59:38.704275 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
12:59:38.704275 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: commit;
12:59:38.882241 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
12:59:38.885168 [debug] [Thread-4  ]: finished collecting timing info
12:59:38.885168 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: Close
12:59:39.025933 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65877400>]}
12:59:39.206032 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.23 seconds
12:59:39.208200 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.208200 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
12:59:39.326618 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
12:59:39.326618 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.326618 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier
12:59:39.432354 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.11 seconds
12:59:39.432354 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.432354 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_SUPPLIER"
12:59:39.527084 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.09 seconds
12:59:39.527084 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.542806 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.542806 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
12:59:39.658533 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:39.658632 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.658632 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: insert into DV_PROTOTYPE_DB.DEMO.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
        );
12:59:39.875127 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.22 seconds
12:59:39.875127 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
12:59:39.875127 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: commit;
12:59:40.042233 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.17 seconds
12:59:40.042233 [debug] [Thread-3  ]: finished collecting timing info
12:59:40.042233 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
12:59:40.192287 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65910400>]}
12:59:40.322736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 9.29 seconds
12:59:40.326609 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.327236 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
12:59:40.424977 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:40.428917 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.428917 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation
12:59:40.498255 [info ] [Thread-4  ]: 27 of 36 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 5.03s]
12:59:40.498255 [info ] [Thread-3  ]: 28 of 36 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 5.24s]
12:59:40.498255 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
12:59:40.498255 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
12:59:40.502784 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
12:59:40.502784 [info ] [Thread-4  ]: 30 of 36 START incremental model DEMO.link_nation_region ....................... [RUN]
12:59:40.502784 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
12:59:40.502784 [info ] [Thread-3  ]: 31 of 36 START incremental model DEMO.link_supplier_nation ..................... [RUN]
12:59:40.502784 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:40.502784 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
12:59:40.502784 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
12:59:40.510890 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:40.510890 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
12:59:40.518816 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
12:59:40.529480 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
12:59:40.529480 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.529480 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_NATION"
12:59:40.545529 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
12:59:40.554920 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:40.591675 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.09 seconds
12:59:40.591675 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:40.600031 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
12:59:40.600281 [debug] [Thread-4  ]: finished collecting timing info
12:59:40.600893 [debug] [Thread-3  ]: finished collecting timing info
12:59:40.600893 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
12:59:40.600893 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
12:59:40.609238 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:40.617478 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:40.617478 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_nation_region AS d
    ON a."NATION_REGION_PK" = d."NATION_REGION_PK"
    WHERE d."NATION_REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:40.617478 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_supplier_nation AS d
    ON a."LINK_SUPPLIER_NATION_PK" = d."LINK_SUPPLIER_NATION_PK"
    WHERE d."LINK_SUPPLIER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:40.617478 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:40.617478 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:40.655004 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
12:59:40.655004 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.655004 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.661694 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
12:59:40.721600 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
12:59:40.725288 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:40.725288 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory
12:59:40.776279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:40.776279 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.776279 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: insert into DV_PROTOTYPE_DB.DEMO.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
        );
12:59:40.834283 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
12:59:40.850876 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:40.850876 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY"
12:59:40.950201 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:40.950201 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
12:59:40.950201 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:40.950201 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
12:59:40.981454 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.21 seconds
12:59:40.981454 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
12:59:40.981454 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: commit;
12:59:41.082288 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
12:59:41.082288 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:41.082288 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: insert into DV_PROTOTYPE_DB.DEMO.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
        );
12:59:41.135277 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.15 seconds
12:59:41.135277 [debug] [Thread-1  ]: finished collecting timing info
12:59:41.135277 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
12:59:41.289374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65733310>]}
12:59:41.289374 [info ] [Thread-1  ]: 25 of 36 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 10.31s]
12:59:41.304913 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
12:59:41.304913 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
12:59:41.304913 [info ] [Thread-1  ]: 32 of 36 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
12:59:41.306826 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:41.306826 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
12:59:41.306826 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
12:59:41.340085 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:41.344160 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.26 seconds
12:59:41.344695 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
12:59:41.345384 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: commit;
12:59:41.370025 [debug] [Thread-1  ]: finished collecting timing info
12:59:41.370025 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
12:59:41.382889 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:41.382982 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."INVENTORY_PK", current_records."INVENTORY_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."INVENTORY_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."INVENTORY_PK"
                FROM source_data
            ) AS source_records
                ON current_records."INVENTORY_PK" = source_records."INVENTORY_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."INVENTORY_PK" = stage."INVENTORY_PK"
            WHERE latest_records."INVENTORY_HASHDIFF" != stage."INVENTORY_HASHDIFF"
                OR latest_records."INVENTORY_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:41.383426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:59:41.505794 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:41.505794 [debug] [Thread-2  ]: finished collecting timing info
12:59:41.505794 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
12:59:41.760050 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B653C72E0>]}
12:59:41.761201 [info ] [Thread-2  ]: 29 of 36 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 4.32s]
12:59:41.762248 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
12:59:41.762248 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
12:59:41.763367 [info ] [Thread-2  ]: 33 of 36 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
12:59:41.764409 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:41.764409 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
12:59:41.765491 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
12:59:41.810489 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:41.818536 [debug] [Thread-2  ]: finished collecting timing info
12:59:41.818536 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
12:59:41.825259 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:41.825259 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."PART_PK", current_records."PART_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."PART_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."PART_PK"
                FROM source_data
            ) AS source_records
                ON current_records."PART_PK" = source_records."PART_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."PART_PK" = stage."PART_PK"
            WHERE latest_records."PART_HASHDIFF" != stage."PART_HASHDIFF"
                OR latest_records."PART_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:41.825259 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:43.375842 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.76 seconds
12:59:43.375842 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.375842 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
12:59:43.488934 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.11 seconds
12:59:43.497530 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.497791 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation
12:59:43.592912 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
12:59:43.608812 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.609075 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_SUPPLIER_NATION"
12:59:43.704270 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
12:59:43.708848 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.711308 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.714150 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
12:59:43.871905 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:43.871905 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:43.871905 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DV_PROTOTYPE_DB.DEMO.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
        );
12:59:44.209367 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.34 seconds
12:59:44.209367 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
12:59:44.209367 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
12:59:44.391975 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
12:59:44.409773 [debug] [Thread-3  ]: finished collecting timing info
12:59:44.410788 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
12:59:44.568138 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B658AAD60>]}
12:59:44.568138 [info ] [Thread-3  ]: 31 of 36 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 4.06s]
12:59:44.568138 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
12:59:44.568138 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
12:59:44.568138 [info ] [Thread-3  ]: 34 of 36 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
12:59:44.583268 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:44.583268 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
12:59:44.583268 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
12:59:44.600333 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:44.643025 [debug] [Thread-3  ]: finished collecting timing info
12:59:44.643572 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
12:59:44.644572 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:44.644572 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:44.644572 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
12:59:45.724764 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.11 seconds
12:59:45.740637 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:45.740637 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
12:59:45.841502 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:45.841502 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:45.841502 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region
12:59:45.958115 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
12:59:45.964332 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:45.964981 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_NATION_REGION"
12:59:46.001812 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.18 seconds
12:59:46.009815 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.009815 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
12:59:46.062667 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
12:59:46.062667 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
12:59:46.102206 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:46.102206 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
12:59:46.117966 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 0.11 seconds
12:59:46.117966 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.117966 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details
12:59:46.209437 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:46.209437 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:46.209437 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: insert into DV_PROTOTYPE_DB.DEMO.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
        );
12:59:46.225502 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 0.11 seconds
12:59:46.241123 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.241123 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_PART_DETAILS"
12:59:46.335371 [debug] [Thread-2  ]: SQL status: SUCCESS 13 in 0.09 seconds
12:59:46.339360 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.340617 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.340617 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
12:59:46.457321 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:46.457321 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.457321 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
        );
12:59:46.481257 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.27 seconds
12:59:46.481450 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
12:59:46.481450 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: commit;
12:59:46.703663 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.22 seconds
12:59:46.703663 [debug] [Thread-4  ]: finished collecting timing info
12:59:46.703663 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
12:59:46.709497 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.25 seconds
12:59:46.709497 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
12:59:46.709497 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
12:59:46.857205 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65615EB0>]}
12:59:46.857205 [info ] [Thread-4  ]: 30 of 36 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 6.35s]
12:59:46.857205 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
12:59:46.864224 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
12:59:46.865035 [info ] [Thread-4  ]: 35 of 36 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
12:59:46.865035 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:46.865035 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
12:59:46.866702 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
12:59:46.883293 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:46.883293 [debug] [Thread-4  ]: finished collecting timing info
12:59:46.883293 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
12:59:46.892675 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:46.892675 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:46.892675 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
12:59:46.901233 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.19 seconds
12:59:46.909802 [debug] [Thread-2  ]: finished collecting timing info
12:59:46.912759 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
12:59:47.075919 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65578B80>]}
12:59:47.075919 [info ] [Thread-2  ]: 33 of 36 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 5.31s]
12:59:47.075919 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
12:59:47.075919 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
12:59:47.075919 [info ] [Thread-2  ]: 36 of 36 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
12:59:47.079666 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:47.079666 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
12:59:47.079666 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
12:59:47.093533 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:47.101555 [debug] [Thread-2  ]: finished collecting timing info
12:59:47.101555 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
12:59:47.109656 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:47.109656 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_HASHDIFF" != stage."SUPPLIER_HASHDIFF"
                OR latest_records."SUPPLIER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
12:59:47.109656 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
12:59:47.548232 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.9 seconds
12:59:47.548232 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.548232 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
12:59:47.659375 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.11 seconds
12:59:47.659375 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.659375 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details
12:59:47.758757 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.1 seconds
12:59:47.770822 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.770822 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_NATION_DETAILS"
12:59:47.861697 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.09 seconds
12:59:47.861697 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.871302 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.871302 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
12:59:47.987529 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:47.987529 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:47.987529 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
        );
12:59:48.267493 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.28 seconds
12:59:48.267493 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
12:59:48.267493 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
12:59:48.424293 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:48.424293 [debug] [Thread-3  ]: finished collecting timing info
12:59:48.424293 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
12:59:48.573504 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B657E0AC0>]}
12:59:48.573504 [info ] [Thread-3  ]: 34 of 36 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 3.99s]
12:59:48.573504 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
12:59:49.862215 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.97 seconds
12:59:49.862215 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:49.862215 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
12:59:49.978073 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 8.59 seconds
12:59:49.978073 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:49.978073 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
12:59:49.978073 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:49.978073 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:49.978073 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details
12:59:50.094858 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:50.094858 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:50.094858 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_REGION_DETAILS"
12:59:50.094858 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.12 seconds
12:59:50.110533 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.110533 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details
12:59:50.210183 [debug] [Thread-4  ]: SQL status: SUCCESS 7 in 0.12 seconds
12:59:50.210183 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:50.223542 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.11 seconds
12:59:50.228314 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.229351 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_INVENTORY_DETAILS"
12:59:50.249418 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:50.249418 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
12:59:50.315560 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.09 seconds
12:59:50.324042 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.324042 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.324042 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
12:59:50.361989 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:50.361989 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:50.361989 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
        );
12:59:50.361989 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.25 seconds
12:59:50.361989 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.361989 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
12:59:50.441719 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
12:59:50.442677 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.443191 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
        );
12:59:50.478298 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.12 seconds
12:59:50.478298 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.478298 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details
12:59:50.576800 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.1 seconds
12:59:50.580659 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.580659 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPPLIER_DETAILS"
12:59:50.610817 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.25 seconds
12:59:50.610817 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
12:59:50.610817 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
12:59:50.685709 [debug] [Thread-2  ]: SQL status: SUCCESS 10 in 0.11 seconds
12:59:50.690000 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.693047 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.25 seconds
12:59:50.693568 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
12:59:50.693568 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
12:59:50.697609 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.697609 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
12:59:50.786300 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
12:59:50.786300 [debug] [Thread-4  ]: finished collecting timing info
12:59:50.786300 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
12:59:50.809067 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
12:59:50.809067 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:50.809067 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
        );
12:59:50.886651 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
12:59:50.887704 [debug] [Thread-1  ]: finished collecting timing info
12:59:50.887704 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
12:59:50.924399 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6571EEE0>]}
12:59:50.940421 [info ] [Thread-4  ]: 35 of 36 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 4.06s]
12:59:50.940421 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
12:59:51.042035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B6572E040>]}
12:59:51.043031 [info ] [Thread-1  ]: 32 of 36 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 9.74s]
12:59:51.043031 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
12:59:51.078657 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.27 seconds
12:59:51.078657 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
12:59:51.078657 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
12:59:51.239227 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.16 seconds
12:59:51.256573 [debug] [Thread-2  ]: finished collecting timing info
12:59:51.256573 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
12:59:51.395105 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fecbc575-e275-4ff0-85ae-6d542b7bd310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B657DA040>]}
12:59:51.395105 [info ] [Thread-2  ]: 36 of 36 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 4.32s]
12:59:51.404835 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
12:59:51.406933 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:59:51.406933 [info ] [MainThread]: 
12:59:51.406933 [info ] [MainThread]: Finished running 11 view models, 25 incremental models in 38.36s.
12:59:51.410009 [debug] [MainThread]: Connection 'master' was properly closed.
12:59:51.410009 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
12:59:51.410403 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
12:59:51.410403 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_inventory_details' was properly closed.
12:59:51.410403 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
12:59:51.410403 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
12:59:51.410403 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
12:59:51.448704 [info ] [MainThread]: 
12:59:51.451073 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
12:59:51.451073 [info ] [MainThread]: 
12:59:51.451073 [error] [MainThread]: [33mDatabase Error in model customer (models\transform\customer.sql)[0m
12:59:51.451073 [error] [MainThread]:   002003 (42S02): SQL compilation error:
12:59:51.451073 [error] [MainThread]:   Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
12:59:51.451073 [error] [MainThread]:   compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\customer.sql
12:59:51.459291 [info ] [MainThread]: 
12:59:51.459563 [error] [MainThread]: [33mDatabase Error in model combined_bookings (models\transform\combined_bookings.sql)[0m
12:59:51.459563 [error] [MainThread]:   001003 (42000): SQL compilation error:
12:59:51.459563 [error] [MainThread]:   syntax error line 14 at position 12 unexpected 'from'.
12:59:51.459563 [error] [MainThread]:   syntax error line 28 at position 12 unexpected 'from'.
12:59:51.459563 [error] [MainThread]:   compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\combined_bookings.sql
12:59:51.459563 [info ] [MainThread]: 
12:59:51.459563 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=2 SKIP=3 TOTAL=36
12:59:51.467619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B64000430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B640002B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B65322A90>]}


============================== 2022-06-15 16:35:07.487655 | b997188e-f1ea-49ad-8630-f8a4ef211df1 ==============================
16:35:07.487655 [info ] [MainThread]: Running with dbt=1.1.0
16:35:07.493147 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a833122\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:35:07.493649 [debug] [MainThread]: Tracking: tracking
16:35:07.494149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE3AB070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE3AB520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE3AB490>]}
16:35:09.524516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:35:09.524516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:35:09.524516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE4490D0>]}
16:35:09.559838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE5602B0>]}
16:35:09.560530 [info ] [MainThread]: Found 36 models, 0 tests, 0 snapshots, 0 analyses, 644 macros, 0 operations, 3 seed files, 8 sources, 0 exposures, 0 metrics
16:35:09.561034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE5600A0>]}
16:35:09.562530 [info ] [MainThread]: 
16:35:09.564972 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:35:09.567186 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB"
16:35:09.585346 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB"
16:35:09.585346 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB"} */

    show terse schemas in database DV_PROTOTYPE_DB
    limit 10000
16:35:09.585346 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:11.008942 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.42 seconds
16:35:11.008942 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB: Close
16:35:11.165917 [debug] [ThreadPool]: Acquiring new snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
16:35:11.167514 [debug] [ThreadPool]: Using snowflake connection "list_DV_PROTOTYPE_DB_DEMO"
16:35:11.167514 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "connection_name": "list_DV_PROTOTYPE_DB_DEMO"} */

    show terse objects in DV_PROTOTYPE_DB.DEMO
16:35:11.167514 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:11.797781 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 0.63 seconds
16:35:11.798064 [debug] [ThreadPool]: On list_DV_PROTOTYPE_DB_DEMO: Close
16:35:11.946597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE45EA30>]}
16:35:11.948161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
16:35:11.949034 [info ] [MainThread]: 
16:35:11.989101 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.combined_bookings
16:35:11.989101 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.customer
16:35:11.992209 [info ] [Thread-1  ]: 1 of 36 START view model DEMO.combined_bookings ................................ [RUN]
16:35:11.992482 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.raw_orders
16:35:11.992482 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_transactions
16:35:11.992984 [info ] [Thread-2  ]: 2 of 36 START view model DEMO.customer ......................................... [RUN]
16:35:11.993516 [info ] [Thread-3  ]: 3 of 36 START view model DEMO.raw_orders ....................................... [RUN]
16:35:11.994237 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
16:35:11.994716 [info ] [Thread-4  ]: 4 of 36 START view model DEMO.raw_transactions ................................. [RUN]
16:35:11.995517 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.combined_bookings
16:35:11.997721 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.customer"
16:35:11.998312 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
16:35:11.998312 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.combined_bookings
16:35:11.998899 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.customer
16:35:11.999281 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
16:35:11.999463 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.raw_orders
16:35:12.019957 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.customer
16:35:12.027958 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
16:35:12.027958 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_transactions
16:35:12.027958 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.raw_orders
16:35:12.027958 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.customer"
16:35:12.027958 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

    describe table DV_PROTOTYPE_DB.DEMO.bookings_1
16:35:12.027958 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_transactions
16:35:12.035944 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_orders"
16:35:12.035944 [debug] [Thread-1  ]: Opening a new connection, currently in state init
16:35:12.044181 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
16:35:12.044181 [debug] [Thread-2  ]: finished collecting timing info
16:35:12.044181 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.customer
16:35:12.070911 [debug] [Thread-4  ]: finished collecting timing info
16:35:12.078617 [debug] [Thread-3  ]: finished collecting timing info
16:35:12.078617 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_transactions
16:35:12.078617 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.customer"
16:35:12.078617 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.raw_orders
16:35:12.078617 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_transactions"
16:35:12.086726 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_orders"
16:35:12.086726 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.customer"
16:35:12.086726 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.customer"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.customer
  
   as (
    SELECT ID 
    , FIRST_NAME
    , LAST_NAME
    , birthdate
FROM DV_PROTOTYPE_DB.DEMO.customers
  );
16:35:12.086726 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:35:12.093470 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_transactions"
16:35:12.093470 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_transactions
  
   as (
    SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS  AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
16:35:12.095303 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_orders"
16:35:12.095303 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:35:12.095303 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.raw_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_orders
  
   as (
    SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY ,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.ORDERS AS b
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.LINEITEM AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER AS c
    ON b.O_CUSTKEY  = c.C_CUSTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON c.C_NATIONKEY  = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY  = e.R_REGIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08')
  );
16:35:12.095303 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:35:12.837314 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f7a3-0000-3bf5-0000-9e95002b4006
16:35:12.837314 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
16:35:12.837314 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f7a3-0000-3bf5-0000-9e95002b400a
16:35:12.837314 [debug] [Thread-2  ]: finished collecting timing info
16:35:12.837314 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'DV_PROTOTYPE_DB.DEMO.BOOKINGS_1' does not exist or not authorized.
16:35:12.837314 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.customer: Close
16:35:12.837314 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
16:35:12.837314 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
16:35:12.837314 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
16:35:12.837314 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

    describe table DV_PROTOTYPE_DB.DEMO.bookings_2
16:35:12.949188 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.85 seconds
16:35:12.949188 [debug] [Thread-4  ]: finished collecting timing info
16:35:12.949188 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_transactions: Close
16:35:12.971945 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f7a3-0000-3b81-0000-9e95002b300a
16:35:12.971945 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Table 'DV_PROTOTYPE_DB.DEMO.BOOKINGS_2' does not exist or not authorized.
16:35:12.971945 [debug] [Thread-1  ]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
16:35:12.971945 [debug] [Thread-1  ]: Snowflake adapter: Rolling back transaction.
16:35:12.971945 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.combined_bookings"
16:35:12.971945 [debug] [Thread-1  ]: finished collecting timing info
16:35:12.971945 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.combined_bookings
16:35:12.971945 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.combined_bookings"
16:35:12.971945 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.combined_bookings"
16:35:12.971945 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.combined_bookings"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.combined_bookings
  
   as (
    

        (
            select

                cast('DV_PROTOTYPE_DB.DEMO.bookings_1' as 
    varchar
) as _dbt_source_relation,
                

            from DV_PROTOTYPE_DB.DEMO.bookings_1
        )

        union all
        

        (
            select

                cast('DV_PROTOTYPE_DB.DEMO.bookings_2' as 
    varchar
) as _dbt_source_relation,
                

            from DV_PROTOTYPE_DB.DEMO.bookings_2
        )

        
  );
16:35:12.989040 [debug] [Thread-2  ]: Database Error in model customer (models\transform\customer.sql)
  002003 (42S02): SQL compilation error:
  Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
  compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\customer.sql
16:35:12.989123 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFAB5310>]}
16:35:12.989123 [error] [Thread-2  ]: 2 of 36 ERROR creating view model DEMO.customer ................................ [[31mERROR[0m in 0.99s]
16:35:12.990491 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.customer
16:35:12.997080 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.9 seconds
16:35:12.997080 [debug] [Thread-3  ]: finished collecting timing info
16:35:12.997080 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.raw_orders: Close
16:35:13.095439 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f7a3-0000-3bee-0000-9e95002b0272
16:35:13.095439 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 12 unexpected 'from'.
syntax error line 28 at position 12 unexpected 'from'.
16:35:13.095439 [debug] [Thread-1  ]: finished collecting timing info
16:35:13.095439 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.combined_bookings: Close
16:35:13.112078 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEF9956D0>]}
16:35:13.112078 [info ] [Thread-4  ]: 4 of 36 OK created view model DEMO.raw_transactions ............................ [[32mSUCCESS 1[0m in 1.11s]
16:35:13.112078 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_transactions
16:35:13.117219 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.v_stg_transactions
16:35:13.117219 [info ] [Thread-2  ]: 5 of 36 START view model DEMO.v_stg_transactions ............................... [RUN]
16:35:13.117725 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.117725 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_transactions
16:35:13.117725 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.v_stg_transactions
16:35:13.143426 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.143426 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
16:35:13.143426 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:13.151476 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEF995580>]}
16:35:13.151552 [info ] [Thread-3  ]: 3 of 36 OK created view model DEMO.raw_orders .................................. [[32mSUCCESS 1[0m in 1.15s]
16:35:13.152754 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.raw_orders
16:35:13.152754 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.raw_inventory
16:35:13.152754 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.v_stg_orders
16:35:13.152754 [info ] [Thread-4  ]: 6 of 36 START view model DEMO.raw_inventory .................................... [RUN]
16:35:13.152754 [info ] [Thread-3  ]: 7 of 36 START view model DEMO.v_stg_orders ..................................... [RUN]
16:35:13.152754 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
16:35:13.156048 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.raw_inventory
16:35:13.156507 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.156724 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.raw_inventory
16:35:13.156724 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_orders
16:35:13.160036 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
16:35:13.160036 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.v_stg_orders
16:35:13.176595 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.176595 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
16:35:13.176595 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:13.176595 [debug] [Thread-4  ]: finished collecting timing info
16:35:13.176595 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.raw_inventory
16:35:13.185126 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.raw_inventory"
16:35:13.226915 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.raw_inventory"
16:35:13.226915 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.raw_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.raw_inventory
  
   as (
    SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PARTSUPP AS a
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.SUPPLIER AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.PART AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.NATION AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.REGION AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN DV_PROTOTYPE_DB.DEMO.raw_orders AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY
  );
16:35:13.226915 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:13.278081 [debug] [Thread-1  ]: Database Error in model combined_bookings (models\transform\combined_bookings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 12 unexpected 'from'.
  syntax error line 28 at position 12 unexpected 'from'.
  compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\combined_bookings.sql
16:35:13.278081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFA2AEE0>]}
16:35:13.278081 [error] [Thread-1  ]: 1 of 36 ERROR creating view model DEMO.combined_bookings ....................... [[31mERROR[0m in 1.28s]
16:35:13.278081 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.combined_bookings
16:35:13.281276 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.prepped_data
16:35:13.281961 [info ] [Thread-1  ]: 8 of 36 SKIP relation DEMO.prepped_data ........................................ [[33mSKIP[0m]
16:35:13.281961 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.prepped_data
16:35:13.281961 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hotel_count_by_day
16:35:13.283778 [info ] [Thread-1  ]: 9 of 36 SKIP relation DEMO.hotel_count_by_day .................................. [[33mSKIP[0m]
16:35:13.283911 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hotel_count_by_day
16:35:13.285000 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.thirty_day_avg_cost
16:35:13.285000 [info ] [Thread-1  ]: 10 of 36 SKIP relation DEMO.thirty_day_avg_cost ................................ [[33mSKIP[0m]
16:35:13.285000 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.thirty_day_avg_cost
16:35:13.587105 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.44 seconds
16:35:13.640358 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.640358 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_transactions
16:35:13.656055 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.48 seconds
16:35:13.682509 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.682509 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_orders
16:35:13.756761 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.12 seconds
16:35:13.803549 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.816726 [debug] [Thread-2  ]: finished collecting timing info
16:35:13.816726 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_transactions
16:35:13.817228 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.817228 [debug] [Thread-3  ]: SQL status: SUCCESS 36 in 0.13 seconds
16:35:13.834030 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_transactions"
16:35:13.834030 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_transactions"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_transactions
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE"

    FROM DV_PROTOTYPE_DB.DEMO.raw_transactions
),

derived_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    'RAW_TRANSACTIONS' AS "RECORD_SOURCE",
    DATEADD(DAY, 1, TRANSACTION_DATE) AS "LOAD_DATE",
    "TRANSACTION_DATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TRANSACTION_NUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "TRANSACTION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDER_ID" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDER_ID",
    "CUSTOMER_ID",
    "ORDER_DATE",
    "TRANSACTION_DATE",
    "TRANSACTION_NUMBER",
    "AMOUNT",
    "TYPE",
    "RECORD_SOURCE",
    "LOAD_DATE",
    "EFFECTIVE_FROM",
    "TRANSACTION_PK",
    "CUSTOMER_PK",
    "ORDER_PK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
16:35:13.932402 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.932402 [debug] [Thread-3  ]: finished collecting timing info
16:35:13.935405 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_orders
16:35:13.935831 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.943595 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_orders"
16:35:13.943595 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_orders"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_orders
  
   as (
    







WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_orders
),

derived_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "CUSTOMER_NATION_KEY" AS "NATION_KEY",
    "CUSTOMER_REGION_KEY" AS "REGION_KEY",
    'TPCH-ORDERS' AS "RECORD_SOURCE",
    "ORDERDATE" AS "EFFECTIVE_FROM"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "CUSTOMER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "ORDER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "ORDER_CUSTOMER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINEITEM_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "LINK_LINEITEM_ORDER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "INVENTORY_ALLOCATION_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ACCBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_MKTSEGMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("CUSTOMER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "CUSTOMER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COMMITDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DISCOUNT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("EXTENDEDPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINE_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINENUMBER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("LINESTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("QUANTITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RECEIPTDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("RETURNFLAG" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPINSTRUCT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPMODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TAX" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "LINEITEM_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("CLERK" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERDATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ORDERSTATUS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SHIPPRIORITY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("TOTALPRICE" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "ORDER_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "ORDERKEY",
    "PARTKEY",
    "SUPPLIERKEY",
    "LINENUMBER",
    "QUANTITY",
    "EXTENDEDPRICE",
    "DISCOUNT",
    "TAX",
    "RETURNFLAG",
    "LINESTATUS",
    "SHIPDATE",
    "COMMITDATE",
    "RECEIPTDATE",
    "SHIPINSTRUCT",
    "SHIPMODE",
    "LINE_COMMENT",
    "CUSTOMERKEY",
    "ORDERSTATUS",
    "TOTALPRICE",
    "ORDERDATE",
    "ORDERPRIORITY",
    "CLERK",
    "SHIPPRIORITY",
    "ORDER_COMMENT",
    "CUSTOMER_NAME",
    "CUSTOMER_ADDRESS",
    "CUSTOMER_NATION_KEY",
    "CUSTOMER_PHONE",
    "CUSTOMER_ACCBAL",
    "CUSTOMER_MKTSEGMENT",
    "CUSTOMER_COMMENT",
    "CUSTOMER_NATION_NAME",
    "CUSTOMER_REGION_KEY",
    "CUSTOMER_NATION_COMMENT",
    "CUSTOMER_REGION_NAME",
    "CUSTOMER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "EFFECTIVE_FROM",
    "CUSTOMER_PK",
    "LINK_CUSTOMER_NATION_PK",
    "CUSTOMER_NATION_PK",
    "CUSTOMER_REGION_PK",
    "NATION_PK",
    "REGION_PK",
    "NATION_REGION_PK",
    "ORDER_PK",
    "ORDER_CUSTOMER_PK",
    "LINEITEM_PK",
    "LINK_LINEITEM_ORDER_PK",
    "PART_PK",
    "SUPPLIER_PK",
    "INVENTORY_PK",
    "INVENTORY_ALLOCATION_PK",
    "CUSTOMER_HASHDIFF",
    "CUSTOMER_NATION_HASHDIFF",
    "CUSTOMER_REGION_HASHDIFF",
    "LINEITEM_HASHDIFF",
    "ORDER_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging
  );
16:35:14.130336 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.3 seconds
16:35:14.130336 [debug] [Thread-2  ]: finished collecting timing info
16:35:14.130336 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.v_stg_transactions: Close
16:35:14.137451 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.91 seconds
16:35:14.137451 [debug] [Thread-4  ]: finished collecting timing info
16:35:14.137451 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.raw_inventory: Close
16:35:14.276886 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC40610>]}
16:35:14.276886 [info ] [Thread-4  ]: 6 of 36 OK created view model DEMO.raw_inventory ............................... [[32mSUCCESS 1[0m in 1.12s]
16:35:14.276886 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.raw_inventory
16:35:14.276886 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.v_stg_inventory
16:35:14.288952 [info ] [Thread-1  ]: 11 of 36 START view model DEMO.v_stg_inventory ................................. [RUN]
16:35:14.290803 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:14.290803 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.v_stg_inventory
16:35:14.291301 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.v_stg_inventory
16:35:14.294421 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:14.294421 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
16:35:14.294421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:14.294421 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFACA5B0>]}
16:35:14.294421 [info ] [Thread-2  ]: 5 of 36 OK created view model DEMO.v_stg_transactions .......................... [[32mSUCCESS 1[0m in 1.18s]
16:35:14.294421 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_transactions
16:35:14.305311 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.36 seconds
16:35:14.306231 [debug] [Thread-3  ]: finished collecting timing info
16:35:14.306231 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.v_stg_orders: Close
16:35:14.306231 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.t_link_transactions
16:35:14.306231 [info ] [Thread-4  ]: 12 of 36 START incremental model DEMO.t_link_transactions ...................... [RUN]
16:35:14.306231 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:14.306231 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.t_link_transactions
16:35:14.311857 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.t_link_transactions
16:35:14.401563 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:14.426754 [debug] [Thread-4  ]: finished collecting timing info
16:35:14.426754 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.t_link_transactions
16:35:14.449719 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:14.449719 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp  as
      (-- Generated by dbtvault.

WITH stage AS (
    SELECT "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_transactions
    WHERE "TRANSACTION_PK" IS NOT NULL
    AND "CUSTOMER_PK" IS NOT NULL
    AND "ORDER_PK" IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg."TRANSACTION_PK", stg."CUSTOMER_PK", stg."ORDER_PK", stg."TRANSACTION_NUMBER", stg."TRANSACTION_DATE", stg."TYPE", stg."AMOUNT", stg."EFFECTIVE_FROM", stg."LOAD_DATE", stg."RECORD_SOURCE"
    FROM stage AS stg
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.t_link_transactions AS tgt
    ON stg."TRANSACTION_PK" = tgt."TRANSACTION_PK"
    WHERE tgt."TRANSACTION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:14.465584 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:14.468658 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFABFA30>]}
16:35:14.468658 [info ] [Thread-3  ]: 7 of 36 OK created view model DEMO.v_stg_orders ................................ [[32mSUCCESS 1[0m in 1.31s]
16:35:14.471675 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_orders
16:35:14.472002 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.hub_customer
16:35:14.472002 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_lineitem
16:35:14.472002 [info ] [Thread-2  ]: 13 of 36 START incremental model DEMO.hub_customer ............................. [RUN]
16:35:14.472002 [info ] [Thread-3  ]: 14 of 36 START incremental model DEMO.hub_lineitem ............................. [RUN]
16:35:14.474206 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:14.474206 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.hub_customer
16:35:14.474972 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:14.474972 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.hub_customer
16:35:14.475214 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_lineitem
16:35:14.483501 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_lineitem
16:35:14.530063 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_customer"
16:35:14.530063 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:14.530063 [debug] [Thread-2  ]: finished collecting timing info
16:35:14.530063 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.hub_customer
16:35:14.538112 [debug] [Thread-3  ]: finished collecting timing info
16:35:14.538112 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:14.538112 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_lineitem
16:35:14.538112 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."CUSTOMER_PK", rr."CUSTOMERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."CUSTOMER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_customer AS d
    ON a."CUSTOMER_PK" = d."CUSTOMER_PK"
    WHERE d."CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:14.544468 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:14.544468 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:14.544468 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINEITEM_PK", rr."LINENUMBER", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINEITEM_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINEITEM_PK", a."LINENUMBER", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_lineitem AS d
    ON a."LINEITEM_PK" = d."LINEITEM_PK"
    WHERE d."LINEITEM_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:14.544468 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:14.808667 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.51 seconds
16:35:14.840113 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:14.840113 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.raw_inventory
16:35:14.956653 [debug] [Thread-1  ]: SQL status: SUCCESS 24 in 0.12 seconds
16:35:15.026461 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:15.026461 [debug] [Thread-1  ]: finished collecting timing info
16:35:15.026461 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.v_stg_inventory
16:35:15.026461 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:15.043404 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.v_stg_inventory"
16:35:15.043404 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.v_stg_inventory"} */

  create or replace  view DV_PROTOTYPE_DB.DEMO.v_stg_inventory
  
   as (
    








WITH staging AS (
-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT"

    FROM DV_PROTOTYPE_DB.DEMO.raw_inventory
),

derived_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "SUPPLIER_NATION_KEY" AS "NATION_KEY",
    "SUPPLIER_REGION_KEY" AS "REGION_KEY",
    'TPCH-INVENTORY' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",

    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "SUPPLIER_REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "REGION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "NATION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "NATION_REGION_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "LINK_SUPPLIER_NATION_PK",
    CAST((MD5_BINARY(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''))) AS BINARY(16)) AS "PART_PK",
    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    ), '^^||^^')) AS BINARY(16)) AS "INVENTORY_PK",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ACCTBAL" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_ADDRESS" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_PHONE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_BRAND" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_CONTAINER" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_MFGR" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_NAME" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_RETAILPRICE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SIZE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_TYPE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "PART_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_REGION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_REGION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_KEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIER_NATION_NAME" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "SUPPLIER_NATION_HASHDIFF",
    CAST(MD5_BINARY(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("AVAILQTY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PART_SUPPLY_COMMENT" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("PARTKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLIERKEY" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("SUPPLYCOST" AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS "INVENTORY_HASHDIFF"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "PARTKEY",
    "SUPPLIERKEY",
    "AVAILQTY",
    "SUPPLYCOST",
    "PART_SUPPLY_COMMENT",
    "SUPPLIER_NAME",
    "SUPPLIER_ADDRESS",
    "SUPPLIER_NATION_KEY",
    "SUPPLIER_PHONE",
    "SUPPLIER_ACCTBAL",
    "SUPPLIER_COMMENT",
    "PART_NAME",
    "PART_MFGR",
    "PART_BRAND",
    "PART_TYPE",
    "PART_SIZE",
    "PART_CONTAINER",
    "PART_RETAILPRICE",
    "PART_COMMENT",
    "SUPPLIER_NATION_NAME",
    "SUPPLIER_NATION_COMMENT",
    "SUPPLIER_REGION_KEY",
    "SUPPLIER_REGION_NAME",
    "SUPPLIER_REGION_COMMENT",
    "NATION_KEY",
    "REGION_KEY",
    "RECORD_SOURCE",
    "SUPPLIER_PK",
    "SUPPLIER_NATION_PK",
    "SUPPLIER_REGION_PK",
    "REGION_PK",
    "NATION_PK",
    "NATION_REGION_PK",
    "LINK_SUPPLIER_NATION_PK",
    "PART_PK",
    "INVENTORY_PK",
    "SUPPLIER_HASHDIFF",
    "PART_HASHDIFF",
    "SUPPLIER_REGION_HASHDIFF",
    "SUPPLIER_NATION_HASHDIFF",
    "INVENTORY_HASHDIFF"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging
  );
16:35:15.410473 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
16:35:15.410473 [debug] [Thread-1  ]: finished collecting timing info
16:35:15.410473 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.v_stg_inventory: Close
16:35:15.560388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFD2EA60>]}
16:35:15.560388 [info ] [Thread-1  ]: 11 of 36 OK created view model DEMO.v_stg_inventory ............................ [[32mSUCCESS 1[0m in 1.27s]
16:35:15.560388 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.v_stg_inventory
16:35:15.560388 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_order
16:35:15.560388 [info ] [Thread-1  ]: 15 of 36 START incremental model DEMO.hub_order ................................ [RUN]
16:35:15.568882 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:15.568882 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_order
16:35:15.568882 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_order
16:35:15.578336 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_order"
16:35:15.618286 [debug] [Thread-1  ]: finished collecting timing info
16:35:15.618899 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_order
16:35:15.618899 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:15.618899 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_PK", rr."ORDERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_PK", a."ORDERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_order AS d
    ON a."ORDER_PK" = d."ORDER_PK"
    WHERE d."ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:15.618899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:18.477947 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.93 seconds
16:35:18.486586 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.486586 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
16:35:18.489488 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.87 seconds
16:35:18.489536 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:18.489536 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
16:35:18.596862 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
16:35:18.596862 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:18.596862 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_order
16:35:18.596862 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:18.604892 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.604892 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_lineitem
16:35:18.711743 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
16:35:18.711743 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:18.720538 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:18.720538 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.720538 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_ORDER"
16:35:18.720538 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_LINEITEM"
16:35:18.825303 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:18.836356 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_order"
16:35:18.841010 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:18.841010 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.846586 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:18.846586 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_order"} */
begin;
16:35:18.846586 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.846586 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_lineitem"} */
begin;
16:35:18.978365 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:18.978365 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:18.978365 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: insert into DV_PROTOTYPE_DB.DEMO.hub_lineitem ("LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINENUMBER", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_lineitem__dbt_tmp
        );
16:35:18.979408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:18.980738 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:18.980738 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: insert into DV_PROTOTYPE_DB.DEMO.hub_order ("ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_order__dbt_tmp
        );
16:35:19.196573 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.22 seconds
16:35:19.196573 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_lineitem"
16:35:19.196573 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: commit;
16:35:19.405698 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.21 seconds
16:35:19.406514 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.43 seconds
16:35:19.410210 [debug] [Thread-3  ]: finished collecting timing info
16:35:19.410309 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_order"
16:35:19.410833 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_lineitem: Close
16:35:19.410943 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: commit;
16:35:19.571858 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFDD3370>]}
16:35:19.571858 [info ] [Thread-3  ]: 14 of 36 OK created incremental model DEMO.hub_lineitem ........................ [[32mSUCCESS 1[0m in 5.10s]
16:35:19.571858 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_lineitem
16:35:19.571858 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_customer_nation
16:35:19.571858 [info ] [Thread-3  ]: 16 of 36 START incremental model DEMO.link_customer_nation ..................... [RUN]
16:35:19.575056 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:19.575056 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_nation
16:35:19.576844 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_customer_nation
16:35:19.603746 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
16:35:19.605458 [debug] [Thread-1  ]: finished collecting timing info
16:35:19.605458 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_order: Close
16:35:19.618535 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:19.655501 [debug] [Thread-3  ]: finished collecting timing info
16:35:19.656004 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_nation
16:35:19.660726 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:19.660726 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_CUSTOMER_NATION_PK", rr."CUSTOMER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_CUSTOMER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_CUSTOMER_NATION_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_CUSTOMER_NATION_PK", a."CUSTOMER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_nation AS d
    ON a."LINK_CUSTOMER_NATION_PK" = d."LINK_CUSTOMER_NATION_PK"
    WHERE d."LINK_CUSTOMER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:19.662084 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:19.768847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFDB7310>]}
16:35:19.768847 [info ] [Thread-1  ]: 15 of 36 OK created incremental model DEMO.hub_order ........................... [[32mSUCCESS 1[0m in 4.20s]
16:35:19.768847 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_order
16:35:19.768847 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_customer_order
16:35:19.768847 [info ] [Thread-1  ]: 17 of 36 START incremental model DEMO.link_customer_order ...................... [RUN]
16:35:19.768847 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:19.768847 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_customer_order
16:35:19.768847 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_customer_order
16:35:19.787342 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
16:35:19.825503 [debug] [Thread-1  ]: finished collecting timing info
16:35:19.826825 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_customer_order
16:35:19.827839 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:19.827839 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."ORDER_CUSTOMER_PK", rr."CUSTOMER_PK", rr."ORDER_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."ORDER_CUSTOMER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."ORDER_CUSTOMER_PK" IS NOT NULL
    AND rr."CUSTOMER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."ORDER_CUSTOMER_PK", a."CUSTOMER_PK", a."ORDER_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_customer_order AS d
    ON a."ORDER_CUSTOMER_PK" = d."ORDER_CUSTOMER_PK"
    WHERE d."ORDER_CUSTOMER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:19.827839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:21.861981 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 7.4 seconds
16:35:21.861981 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:21.861981 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
16:35:21.970247 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.11 seconds
16:35:21.978550 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:21.978550 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table DV_PROTOTYPE_DB.DEMO.t_link_transactions
16:35:22.078561 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.1 seconds
16:35:22.135007 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:22.135007 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."T_LINK_TRANSACTIONS"
16:35:22.252974 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.12 seconds
16:35:22.254141 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:22.258069 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:22.258069 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.t_link_transactions"} */
begin;
16:35:22.320443 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.49 seconds
16:35:22.321652 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.321652 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
16:35:22.372729 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
16:35:22.372729 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:22.372729 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: insert into DV_PROTOTYPE_DB.DEMO.t_link_transactions ("TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "TRANSACTION_PK", "CUSTOMER_PK", "ORDER_PK", "TRANSACTION_NUMBER", "TRANSACTION_DATE", "TYPE", "AMOUNT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.t_link_transactions__dbt_tmp
        );
16:35:22.394286 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.73 seconds
16:35:22.394785 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.394785 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
16:35:22.445149 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:22.445149 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.445149 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_order
16:35:22.481366 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 7.94 seconds
16:35:22.489403 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.489403 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
16:35:22.493929 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:22.502129 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.502129 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_customer_nation
16:35:22.546108 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:22.549469 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.549469 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_ORDER"
16:35:22.593612 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.09 seconds
16:35:22.609239 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.609239 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_CUSTOMER_NATION"
16:35:22.610516 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.12 seconds
16:35:22.611011 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.611011 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_customer
16:35:22.611011 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.24 seconds
16:35:22.611011 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.t_link_transactions"
16:35:22.611011 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: commit;
16:35:22.654244 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:22.654244 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.654244 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.654244 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_order"} */
begin;
16:35:22.715792 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:22.715792 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.715792 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.723809 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_customer_nation"} */
begin;
16:35:22.737451 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.13 seconds
16:35:22.737451 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.737451 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_CUSTOMER"
16:35:22.776220 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:22.776220 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:22.776220 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: insert into DV_PROTOTYPE_DB.DEMO.link_customer_order ("ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_CUSTOMER_PK", "CUSTOMER_PK", "ORDER_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_order__dbt_tmp
        );
16:35:22.803174 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
16:35:22.804572 [debug] [Thread-4  ]: finished collecting timing info
16:35:22.804572 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.t_link_transactions: Close
16:35:22.827511 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.09 seconds
16:35:22.827511 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.840724 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:22.840724 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:22.840724 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: insert into DV_PROTOTYPE_DB.DEMO.link_customer_nation ("LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_CUSTOMER_NATION_PK", "CUSTOMER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_customer_nation__dbt_tmp
        );
16:35:22.874904 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.874904 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_customer"} */
begin;
16:35:22.973164 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFCB2D90>]}
16:35:22.973282 [info ] [Thread-4  ]: 12 of 36 OK created incremental model DEMO.t_link_transactions ................. [[32mSUCCESS 1[0m in 8.67s]
16:35:22.973958 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.t_link_transactions
16:35:22.974702 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_inventory_allocation
16:35:22.975123 [info ] [Thread-4  ]: 18 of 36 START incremental model DEMO.link_inventory_allocation ................ [RUN]
16:35:22.976071 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:22.976188 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory_allocation
16:35:22.976416 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_inventory_allocation
16:35:22.987651 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
16:35:22.987651 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:22.987651 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: insert into DV_PROTOTYPE_DB.DEMO.hub_customer ("CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_customer__dbt_tmp
        );
16:35:22.995497 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:22.998852 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.22 seconds
16:35:23.000222 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_order"
16:35:23.000721 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: commit;
16:35:23.001670 [debug] [Thread-4  ]: finished collecting timing info
16:35:23.001670 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory_allocation
16:35:23.001670 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:23.001670 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_ALLOCATION_PK", rr."PART_PK", rr."SUPPLIER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_ALLOCATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."INVENTORY_ALLOCATION_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_ALLOCATION_PK", a."PART_PK", a."SUPPLIER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory_allocation AS d
    ON a."INVENTORY_ALLOCATION_PK" = d."INVENTORY_ALLOCATION_PK"
    WHERE d."INVENTORY_ALLOCATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:23.001670 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:23.042916 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.2 seconds
16:35:23.043301 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_customer_nation"
16:35:23.043301 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: commit;
16:35:23.160948 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.16 seconds
16:35:23.163526 [debug] [Thread-1  ]: finished collecting timing info
16:35:23.163526 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_customer_order: Close
16:35:23.232047 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.19 seconds
16:35:23.235057 [debug] [Thread-3  ]: finished collecting timing info
16:35:23.235462 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_customer_nation: Close
16:35:23.332937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC49A90>]}
16:35:23.333456 [info ] [Thread-1  ]: 17 of 36 OK created incremental model DEMO.link_customer_order ................. [[32mSUCCESS 1[0m in 3.56s]
16:35:23.333951 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_order
16:35:23.334446 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.link_order_lineitem
16:35:23.334446 [info ] [Thread-1  ]: 19 of 36 START incremental model DEMO.link_order_lineitem ...................... [RUN]
16:35:23.335659 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:23.335852 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.link_order_lineitem
16:35:23.336064 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.link_order_lineitem
16:35:23.353337 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:23.354599 [debug] [Thread-1  ]: finished collecting timing info
16:35:23.354770 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.link_order_lineitem
16:35:23.360550 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:23.361049 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_LINEITEM_ORDER_PK", rr."ORDER_PK", rr."LINEITEM_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_LINEITEM_ORDER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."LINK_LINEITEM_ORDER_PK" IS NOT NULL
    AND rr."ORDER_PK" IS NOT NULL
    AND rr."LINEITEM_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_LINEITEM_ORDER_PK", a."ORDER_PK", a."LINEITEM_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_order_lineitem AS d
    ON a."LINK_LINEITEM_ORDER_PK" = d."LINK_LINEITEM_ORDER_PK"
    WHERE d."LINK_LINEITEM_ORDER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:23.361695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:23.367767 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.38 seconds
16:35:23.367767 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_customer"
16:35:23.368266 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: commit;
16:35:23.387947 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEF9A0FD0>]}
16:35:23.387947 [info ] [Thread-3  ]: 16 of 36 OK created incremental model DEMO.link_customer_nation ................ [[32mSUCCESS 1[0m in 3.81s]
16:35:23.387947 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_customer_nation
16:35:23.387947 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
16:35:23.387947 [info ] [Thread-3  ]: 20 of 36 START incremental model DEMO.sat_order_cust_nation_details ............ [RUN]
16:35:23.393880 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:23.394401 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
16:35:23.394904 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_nation_details
16:35:23.434298 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:23.444978 [debug] [Thread-3  ]: finished collecting timing info
16:35:23.445480 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
16:35:23.454111 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:23.454111 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."CUSTOMER_NATION_NAME", a."CUSTOMER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_NATION_HASHDIFF", stage."CUSTOMER_NATION_NAME", stage."CUSTOMER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_NATION_HASHDIFF" != stage."CUSTOMER_NATION_HASHDIFF"
                OR latest_records."CUSTOMER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:23.454111 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:23.529595 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.16 seconds
16:35:23.529595 [debug] [Thread-2  ]: finished collecting timing info
16:35:23.529595 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.hub_customer: Close
16:35:23.691071 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFE00D00>]}
16:35:23.691071 [info ] [Thread-2  ]: 13 of 36 OK created incremental model DEMO.hub_customer ........................ [[32mSUCCESS 1[0m in 9.22s]
16:35:23.691071 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.hub_customer
16:35:23.706064 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
16:35:23.706954 [info ] [Thread-2  ]: 21 of 36 START incremental model DEMO.sat_order_cust_region_details ............ [RUN]
16:35:23.707800 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:23.707800 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_cust_region_details
16:35:23.708466 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_cust_region_details
16:35:23.733878 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:23.735298 [debug] [Thread-2  ]: finished collecting timing info
16:35:23.735796 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_cust_region_details
16:35:23.740625 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:23.741121 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."CUSTOMER_REGION_NAME", a."CUSTOMER_REGION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_REGION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_REGION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_REGION_HASHDIFF", stage."CUSTOMER_REGION_NAME", stage."CUSTOMER_REGION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_REGION_HASHDIFF" != stage."CUSTOMER_REGION_HASHDIFF"
                OR latest_records."CUSTOMER_REGION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:23.741121 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:25.557092 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.1 seconds
16:35:25.561384 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:25.561384 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
16:35:25.673786 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:25.681026 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:25.681026 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details
16:35:25.780973 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.1 seconds
16:35:25.790900 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:25.790900 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_NATION_DETAILS"
16:35:25.890970 [debug] [Thread-3  ]: SQL status: SUCCESS 7 in 0.1 seconds
16:35:25.894554 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:25.894554 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:25.894554 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"} */
begin;
16:35:26.028615 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:26.028615 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:26.029414 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details ("CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_NATION_HASHDIFF", "CUSTOMER_NATION_NAME", "CUSTOMER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_nation_details__dbt_tmp
        );
16:35:26.267079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.91 seconds
16:35:26.267825 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.27 seconds
16:35:26.268898 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.268898 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.53 seconds
16:35:26.268898 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.268898 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
16:35:26.268898 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.24 seconds
16:35:26.278207 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.278207 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
16:35:26.278207 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_nation_details"
16:35:26.278207 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
16:35:26.280824 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: commit;
16:35:26.395494 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:26.395494 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:26.396953 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.404531 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.405303 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_order_lineitem
16:35:26.406026 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.13 seconds
16:35:26.406026 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details
16:35:26.411294 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.412605 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory_allocation
16:35:26.477962 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.19 seconds
16:35:26.477962 [debug] [Thread-3  ]: finished collecting timing info
16:35:26.485781 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_cust_nation_details: Close
16:35:26.514310 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.1 seconds
16:35:26.514548 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:26.515052 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.522006 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.522006 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY_ALLOCATION"
16:35:26.522006 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_ORDER_LINEITEM"
16:35:26.522006 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:26.528882 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.528882 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUST_REGION_DETAILS"
16:35:26.633188 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.11 seconds
16:35:26.635350 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.637242 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:26.639357 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.639522 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.639522 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory_allocation"} */
begin;
16:35:26.641479 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.642562 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_cust_region_details"} */
begin;
16:35:26.643577 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:26.650664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.650664 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.650664 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_order_lineitem"} */
begin;
16:35:26.658294 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFF090A0>]}
16:35:26.658294 [info ] [Thread-3  ]: 20 of 36 OK created incremental model DEMO.sat_order_cust_nation_details ....... [[32mSUCCESS 1[0m in 3.26s]
16:35:26.658294 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_nation_details
16:35:26.658294 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_order_customer_details
16:35:26.661747 [info ] [Thread-3  ]: 22 of 36 START incremental model DEMO.sat_order_customer_details ............... [RUN]
16:35:26.662914 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:26.663962 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_customer_details
16:35:26.663962 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_order_customer_details
16:35:26.679429 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:26.687469 [debug] [Thread-3  ]: finished collecting timing info
16:35:26.688587 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_customer_details
16:35:26.689077 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:26.689077 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."CUSTOMER_NAME", a."CUSTOMER_ADDRESS", a."CUSTOMER_PHONE", a."CUSTOMER_ACCBAL", a."CUSTOMER_MKTSEGMENT", a."CUSTOMER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."CUSTOMER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."CUSTOMER_PK", a."CUSTOMER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."CUSTOMER_PK", current_records."CUSTOMER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."CUSTOMER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_customer_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."CUSTOMER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."CUSTOMER_PK" = source_records."CUSTOMER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."CUSTOMER_PK", stage."CUSTOMER_HASHDIFF", stage."CUSTOMER_NAME", stage."CUSTOMER_ADDRESS", stage."CUSTOMER_PHONE", stage."CUSTOMER_ACCBAL", stage."CUSTOMER_MKTSEGMENT", stage."CUSTOMER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."CUSTOMER_PK" = stage."CUSTOMER_PK"
            WHERE latest_records."CUSTOMER_HASHDIFF" != stage."CUSTOMER_HASHDIFF"
                OR latest_records."CUSTOMER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:26.689077 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:26.768997 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:26.768997 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.768997 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details ("CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_REGION_HASHDIFF", "CUSTOMER_REGION_NAME", "CUSTOMER_REGION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_cust_region_details__dbt_tmp
        );
16:35:26.768997 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:26.768997 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:26.768997 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: insert into DV_PROTOTYPE_DB.DEMO.link_inventory_allocation ("INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_ALLOCATION_PK", "PART_PK", "SUPPLIER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory_allocation__dbt_tmp
        );
16:35:26.788422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.14 seconds
16:35:26.788422 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:26.788422 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: insert into DV_PROTOTYPE_DB.DEMO.link_order_lineitem ("LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_LINEITEM_ORDER_PK", "ORDER_PK", "LINEITEM_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_order_lineitem__dbt_tmp
        );
16:35:26.995723 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.23 seconds
16:35:26.995723 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_cust_region_details"
16:35:26.995723 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: commit;
16:35:27.011438 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.24 seconds
16:35:27.011438 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory_allocation"
16:35:27.011438 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: commit;
16:35:27.020348 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.23 seconds
16:35:27.020348 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_order_lineitem"
16:35:27.020348 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: commit;
16:35:27.175493 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.18 seconds
16:35:27.176850 [debug] [Thread-2  ]: finished collecting timing info
16:35:27.177393 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_cust_region_details: Close
16:35:27.185010 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:27.186465 [debug] [Thread-4  ]: finished collecting timing info
16:35:27.186974 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_inventory_allocation: Close
16:35:27.207302 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
16:35:27.207302 [debug] [Thread-1  ]: finished collecting timing info
16:35:27.207302 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.link_order_lineitem: Close
16:35:27.328821 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEF995130>]}
16:35:27.328821 [info ] [Thread-2  ]: 21 of 36 OK created incremental model DEMO.sat_order_cust_region_details ....... [[32mSUCCESS 1[0m in 3.62s]
16:35:27.328821 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_cust_region_details
16:35:27.328821 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
16:35:27.328821 [info ] [Thread-2  ]: 23 of 36 START incremental model DEMO.sat_order_lineitem_details ............... [RUN]
16:35:27.328821 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:27.328821 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_lineitem_details
16:35:27.328821 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_order_lineitem_details
16:35:27.356563 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:27.356563 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFF924F0>]}
16:35:27.356563 [info ] [Thread-4  ]: 18 of 36 OK created incremental model DEMO.link_inventory_allocation ........... [[32mSUCCESS 1[0m in 4.38s]
16:35:27.356563 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory_allocation
16:35:27.361018 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_order_order_details
16:35:27.361018 [debug] [Thread-2  ]: finished collecting timing info
16:35:27.361645 [info ] [Thread-4  ]: 24 of 36 START incremental model DEMO.sat_order_order_details .................. [RUN]
16:35:27.361645 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_lineitem_details
16:35:27.367729 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:27.367729 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_order_order_details
16:35:27.367729 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_order_order_details
16:35:27.371174 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:27.378204 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."COMMITDATE", a."DISCOUNT", a."EXTENDEDPRICE", a."LINE_COMMENT", a."QUANTITY", a."RECEIPTDATE", a."RETURNFLAG", a."SHIPDATE", a."SHIPINSTRUCT", a."SHIPMODE", a."TAX", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."LINEITEM_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."LINEITEM_PK", a."LINEITEM_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."LINEITEM_PK", current_records."LINEITEM_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."LINEITEM_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."LINEITEM_PK"
                FROM source_data
            ) AS source_records
                ON current_records."LINEITEM_PK" = source_records."LINEITEM_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."LINEITEM_PK", stage."LINEITEM_HASHDIFF", stage."COMMITDATE", stage."DISCOUNT", stage."EXTENDEDPRICE", stage."LINE_COMMENT", stage."QUANTITY", stage."RECEIPTDATE", stage."RETURNFLAG", stage."SHIPDATE", stage."SHIPINSTRUCT", stage."SHIPMODE", stage."TAX", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."LINEITEM_PK" = stage."LINEITEM_PK"
            WHERE latest_records."LINEITEM_HASHDIFF" != stage."LINEITEM_HASHDIFF"
                OR latest_records."LINEITEM_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:27.378204 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:27.385411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC70FA0>]}
16:35:27.385411 [info ] [Thread-1  ]: 19 of 36 OK created incremental model DEMO.link_order_lineitem ................. [[32mSUCCESS 1[0m in 4.05s]
16:35:27.393481 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.link_order_lineitem
16:35:27.403283 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:27.403283 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_nation
16:35:27.403283 [info ] [Thread-1  ]: 25 of 36 START incremental model DEMO.hub_nation ............................... [RUN]
16:35:27.403283 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:27.403283 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_nation
16:35:27.403283 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_nation
16:35:27.420099 [debug] [Thread-4  ]: finished collecting timing info
16:35:27.421098 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_order_order_details
16:35:27.423008 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:27.423008 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."ORDERSTATUS", a."TOTALPRICE", a."ORDERDATE", a."ORDERPRIORITY", a."CLERK", a."SHIPPRIORITY", a."ORDER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS a
    WHERE a."ORDER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."ORDER_PK", a."ORDER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."ORDER_PK", current_records."ORDER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."ORDER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_order_order_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."ORDER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."ORDER_PK" = source_records."ORDER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."ORDER_PK", stage."ORDER_HASHDIFF", stage."ORDERSTATUS", stage."TOTALPRICE", stage."ORDERDATE", stage."ORDERPRIORITY", stage."CLERK", stage."SHIPPRIORITY", stage."ORDER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."ORDER_PK" = stage."ORDER_PK"
            WHERE latest_records."ORDER_HASHDIFF" != stage."ORDER_HASHDIFF"
                OR latest_records."ORDER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:27.423008 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:27.433828 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_nation"
16:35:27.437024 [debug] [Thread-1  ]: finished collecting timing info
16:35:27.437527 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_nation
16:35:27.438581 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:27.438581 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_PK", rr."NATION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_PK", a."NATION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_nation AS d
    ON a."NATION_PK" = d."NATION_PK"
    WHERE d."NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:27.444380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:28.929021 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.24 seconds
16:35:28.929346 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:28.929346 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
16:35:29.038181 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.11 seconds
16:35:29.042571 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.042571 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_customer_details
16:35:29.234481 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.19 seconds
16:35:29.238679 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.239705 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_CUSTOMER_DETAILS"
16:35:29.335369 [debug] [Thread-3  ]: SQL status: SUCCESS 11 in 0.1 seconds
16:35:29.335369 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.343458 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.343921 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_customer_details"} */
begin;
16:35:29.475858 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:29.476977 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.476977 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_customer_details ("CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "CUSTOMER_PK", "CUSTOMER_HASHDIFF", "CUSTOMER_NAME", "CUSTOMER_ADDRESS", "CUSTOMER_PHONE", "CUSTOMER_ACCBAL", "CUSTOMER_MKTSEGMENT", "CUSTOMER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_customer_details__dbt_tmp
        );
16:35:29.782989 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.31 seconds
16:35:29.782989 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_customer_details"
16:35:29.782989 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: commit;
16:35:30.049151 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.27 seconds
16:35:30.049151 [debug] [Thread-3  ]: finished collecting timing info
16:35:30.049151 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_order_customer_details: Close
16:35:30.193600 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFDB7940>]}
16:35:30.193600 [info ] [Thread-3  ]: 22 of 36 OK created incremental model DEMO.sat_order_customer_details .......... [[32mSUCCESS 1[0m in 3.53s]
16:35:30.193600 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_customer_details
16:35:30.193600 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.hub_part
16:35:30.204144 [info ] [Thread-3  ]: 26 of 36 START incremental model DEMO.hub_part ................................. [RUN]
16:35:30.204741 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:30.204741 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.hub_part
16:35:30.204741 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.hub_part
16:35:30.213666 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_part"
16:35:30.213666 [debug] [Thread-3  ]: finished collecting timing info
16:35:30.213666 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.hub_part
16:35:30.222562 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:30.222562 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."PART_PK", rr."PARTKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."PART_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."PART_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."PART_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."PART_PK", a."PARTKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_part AS d
    ON a."PART_PK" = d."PART_PK"
    WHERE d."PART_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:30.222562 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:30.890437 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.47 seconds
16:35:30.895263 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:30.895263 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
16:35:30.993225 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.1 seconds
16:35:30.993225 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:30.993225 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_order_details
16:35:31.096751 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.1 seconds
16:35:31.103165 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:31.103165 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_ORDER_DETAILS"
16:35:31.220089 [debug] [Thread-4  ]: SQL status: SUCCESS 12 in 0.12 seconds
16:35:31.220955 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:31.260835 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:31.261332 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_order_details"} */
begin;
16:35:31.401864 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.14 seconds
16:35:31.401864 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:31.401864 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_order_details ("ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "ORDER_PK", "ORDER_HASHDIFF", "ORDERSTATUS", "TOTALPRICE", "ORDERDATE", "ORDERPRIORITY", "CLERK", "SHIPPRIORITY", "ORDER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_order_details__dbt_tmp
        );
16:35:31.694917 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.29 seconds
16:35:31.694917 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_order_details"
16:35:31.694917 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: commit;
16:35:31.897015 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
16:35:31.897015 [debug] [Thread-4  ]: finished collecting timing info
16:35:31.897015 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_order_order_details: Close
16:35:32.045987 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC159A0>]}
16:35:32.045987 [info ] [Thread-4  ]: 24 of 36 OK created incremental model DEMO.sat_order_order_details ............. [[32mSUCCESS 1[0m in 4.68s]
16:35:32.045987 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_order_details
16:35:32.049761 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.hub_region
16:35:32.050310 [info ] [Thread-4  ]: 27 of 36 START incremental model DEMO.hub_region ............................... [RUN]
16:35:32.051663 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:32.051937 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.hub_region
16:35:32.052067 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.hub_region
16:35:32.144743 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_region"
16:35:32.188061 [debug] [Thread-4  ]: finished collecting timing info
16:35:32.188061 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.hub_region
16:35:32.188061 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:32.188061 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."REGION_PK", rr."REGION_KEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."REGION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."REGION_PK", a."REGION_KEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_region AS d
    ON a."REGION_PK" = d."REGION_PK"
    WHERE d."REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:32.188061 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:33.262306 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.82 seconds
16:35:33.262306 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.262306 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
16:35:33.374288 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
16:35:33.380723 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.380723 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_nation
16:35:33.479720 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:33.479720 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.479720 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_NATION"
16:35:33.597892 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.12 seconds
16:35:33.597892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.602568 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.602568 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_nation"} */
begin;
16:35:33.722631 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:33.722992 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:33.722992 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: insert into DV_PROTOTYPE_DB.DEMO.hub_nation ("NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_PK", "NATION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_nation__dbt_tmp
        );
16:35:34.031219 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.31 seconds
16:35:34.031219 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_nation"
16:35:34.031219 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: commit;
16:35:34.212564 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
16:35:34.214629 [debug] [Thread-1  ]: finished collecting timing info
16:35:34.214629 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_nation: Close
16:35:34.362355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC5C970>]}
16:35:34.362355 [info ] [Thread-1  ]: 25 of 36 OK created incremental model DEMO.hub_nation .......................... [[32mSUCCESS 1[0m in 6.96s]
16:35:34.362355 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_nation
16:35:34.362355 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.hub_supplier
16:35:34.368611 [info ] [Thread-1  ]: 28 of 36 START incremental model DEMO.hub_supplier ............................. [RUN]
16:35:34.368611 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:34.368611 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.hub_supplier
16:35:34.368611 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.hub_supplier
16:35:34.381695 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
16:35:34.421101 [debug] [Thread-1  ]: finished collecting timing info
16:35:34.421594 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.hub_supplier
16:35:34.427676 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:34.427761 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."SUPPLIER_PK", rr."SUPPLIERKEY", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."SUPPLIER_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."SUPPLIER_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."SUPPLIER_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIERKEY", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.hub_supplier AS d
    ON a."SUPPLIER_PK" = d."SUPPLIER_PK"
    WHERE d."SUPPLIER_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:34.428080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:34.857445 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.63 seconds
16:35:34.857445 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:34.857445 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
16:35:34.975469 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.12 seconds
16:35:34.979137 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:34.979137 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_part
16:35:35.079014 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:35.079014 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:35.079014 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_PART"
16:35:35.173780 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.09 seconds
16:35:35.173780 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_part"
16:35:35.189419 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:35.189419 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_part"} */
begin;
16:35:35.305671 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:35.305671 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:35.305671 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: insert into DV_PROTOTYPE_DB.DEMO.hub_part ("PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PARTKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_part__dbt_tmp
        );
16:35:35.564269 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.26 seconds
16:35:35.564269 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_part"
16:35:35.564269 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: commit;
16:35:35.761636 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.2 seconds
16:35:35.763667 [debug] [Thread-3  ]: finished collecting timing info
16:35:35.763667 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.hub_part: Close
16:35:35.904956 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFBF9940>]}
16:35:35.904956 [info ] [Thread-3  ]: 26 of 36 OK created incremental model DEMO.hub_part ............................ [[32mSUCCESS 1[0m in 5.70s]
16:35:35.904956 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.hub_part
16:35:35.915220 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.link_inventory
16:35:35.915716 [info ] [Thread-3  ]: 29 of 36 START incremental model DEMO.link_inventory ........................... [RUN]
16:35:35.916657 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:35.916996 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.link_inventory
16:35:35.917194 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.link_inventory
16:35:35.926556 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_inventory"
16:35:35.931143 [debug] [Thread-3  ]: finished collecting timing info
16:35:35.931427 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.link_inventory
16:35:35.935878 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:35.935878 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."INVENTORY_PK", rr."SUPPLIER_PK", rr."PART_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."INVENTORY_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."INVENTORY_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."PART_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."INVENTORY_PK", a."SUPPLIER_PK", a."PART_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_inventory AS d
    ON a."INVENTORY_PK" = d."INVENTORY_PK"
    WHERE d."INVENTORY_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:35.935878 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:36.174095 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.99 seconds
16:35:36.182926 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.182926 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
16:35:36.283337 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:36.283337 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.283337 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_region
16:35:36.398820 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.12 seconds
16:35:36.399453 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.399453 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_REGION"
16:35:36.497629 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:36.499057 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_region"
16:35:36.536292 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.536292 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_region"} */
begin;
16:35:36.655056 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:36.655056 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.655056 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: insert into DV_PROTOTYPE_DB.DEMO.hub_region ("REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "REGION_PK", "REGION_KEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_region__dbt_tmp
        );
16:35:36.916288 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.26 seconds
16:35:36.916288 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_region"
16:35:36.916288 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: commit;
16:35:37.117848 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
16:35:37.117848 [debug] [Thread-4  ]: finished collecting timing info
16:35:37.117848 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.hub_region: Close
16:35:37.331508 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFCC7F70>]}
16:35:37.472831 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 10.09 seconds
16:35:37.472831 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.472831 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
16:35:37.580449 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0.11 seconds
16:35:37.580449 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.580449 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details
16:35:37.685135 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0.1 seconds
16:35:37.689154 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.689154 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_ORDER_LINEITEM_DETAILS"
16:35:37.801476 [debug] [Thread-2  ]: SQL status: SUCCESS 16 in 0.11 seconds
16:35:37.803713 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.803713 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.803713 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_order_lineitem_details"} */
begin;
16:35:37.936853 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:37.936853 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:37.937354 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: insert into DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details ("LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINEITEM_PK", "LINEITEM_HASHDIFF", "COMMITDATE", "DISCOUNT", "EXTENDEDPRICE", "LINE_COMMENT", "QUANTITY", "RECEIPTDATE", "RETURNFLAG", "SHIPDATE", "SHIPINSTRUCT", "SHIPMODE", "TAX", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_order_lineitem_details__dbt_tmp
        );
16:35:38.178962 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.24 seconds
16:35:38.178962 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_order_lineitem_details"
16:35:38.178962 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: commit;
16:35:38.354002 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.18 seconds
16:35:38.354002 [debug] [Thread-2  ]: finished collecting timing info
16:35:38.354002 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_order_lineitem_details: Close
16:35:38.354002 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.93 seconds
16:35:38.354002 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.362008 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
16:35:38.465378 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:38.465378 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.465378 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table DV_PROTOTYPE_DB.DEMO.hub_supplier
16:35:38.514235 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFBE82E0>]}
16:35:38.579551 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.11 seconds
16:35:38.582929 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.582929 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."HUB_SUPPLIER"
16:35:38.681497 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.1 seconds
16:35:38.681497 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.681497 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.681497 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.hub_supplier"} */
begin;
16:35:38.707647 [info ] [Thread-4  ]: 27 of 36 OK created incremental model DEMO.hub_region .......................... [[32mSUCCESS 1[0m in 5.28s]
16:35:38.707647 [info ] [Thread-2  ]: 23 of 36 OK created incremental model DEMO.sat_order_lineitem_details .......... [[32mSUCCESS 1[0m in 11.19s]
16:35:38.707647 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.hub_region
16:35:38.707647 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.link_nation_region
16:35:38.711377 [info ] [Thread-4  ]: 30 of 36 START incremental model DEMO.link_nation_region ....................... [RUN]
16:35:38.712224 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_order_lineitem_details
16:35:38.712520 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.link_supplier_nation
16:35:38.712759 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:38.712759 [info ] [Thread-2  ]: 31 of 36 START incremental model DEMO.link_supplier_nation ..................... [RUN]
16:35:38.712759 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.link_nation_region
16:35:38.712759 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.link_nation_region
16:35:38.718841 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:38.720994 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.link_supplier_nation
16:35:38.720994 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.link_supplier_nation
16:35:38.739288 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:38.748246 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
16:35:38.753378 [debug] [Thread-2  ]: finished collecting timing info
16:35:38.753873 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.link_supplier_nation
16:35:38.758619 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:38.758619 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."LINK_SUPPLIER_NATION_PK", rr."SUPPLIER_PK", rr."NATION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."LINK_SUPPLIER_NATION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    WHERE rr."LINK_SUPPLIER_NATION_PK" IS NOT NULL
    AND rr."SUPPLIER_PK" IS NOT NULL
    AND rr."NATION_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."LINK_SUPPLIER_NATION_PK", a."SUPPLIER_PK", a."NATION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_supplier_nation AS d
    ON a."LINK_SUPPLIER_NATION_PK" = d."LINK_SUPPLIER_NATION_PK"
    WHERE d."LINK_SUPPLIER_NATION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:38.758619 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:38.758619 [debug] [Thread-4  ]: finished collecting timing info
16:35:38.762247 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.link_nation_region
16:35:38.768093 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:38.768093 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_orders AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr."NATION_REGION_PK", rr."NATION_PK", rr."REGION_PK", rr."LOAD_DATE", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."NATION_REGION_PK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru."NATION_REGION_PK"
               ORDER BY ru."LOAD_DATE", ru."RECORD_SOURCE" ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru."NATION_REGION_PK" IS NOT NULL
    AND ru."NATION_PK" IS NOT NULL
    AND ru."REGION_PK" IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a."NATION_REGION_PK", a."NATION_PK", a."REGION_PK", a."LOAD_DATE", a."RECORD_SOURCE"
    FROM row_rank_union AS a
    LEFT JOIN DV_PROTOTYPE_DB.DEMO.link_nation_region AS d
    ON a."NATION_REGION_PK" = d."NATION_REGION_PK"
    WHERE d."NATION_REGION_PK" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:38.768093 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:38.812666 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:38.812666 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:38.812666 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: insert into DV_PROTOTYPE_DB.DEMO.hub_supplier ("SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIERKEY", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.hub_supplier__dbt_tmp
        );
16:35:39.090689 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.28 seconds
16:35:39.090689 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.hub_supplier"
16:35:39.090689 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: commit;
16:35:39.258114 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:39.258114 [debug] [Thread-1  ]: finished collecting timing info
16:35:39.258114 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.hub_supplier: Close
16:35:39.366175 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.43 seconds
16:35:39.366175 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.366175 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
16:35:39.397613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC707F0>]}
16:35:39.413575 [info ] [Thread-1  ]: 28 of 36 OK created incremental model DEMO.hub_supplier ........................ [[32mSUCCESS 1[0m in 5.03s]
16:35:39.413575 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.hub_supplier
16:35:39.413575 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
16:35:39.413575 [info ] [Thread-1  ]: 32 of 36 START incremental model DEMO.sat_inv_inventory_details ................ [RUN]
16:35:39.415267 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:39.415267 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_inventory_details
16:35:39.415267 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_inventory_details
16:35:39.433787 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:39.441927 [debug] [Thread-1  ]: finished collecting timing info
16:35:39.441927 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_inventory_details
16:35:39.445870 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:39.445870 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."AVAILQTY", a."SUPPLYCOST", a."PART_SUPPLY_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."INVENTORY_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."INVENTORY_PK", a."INVENTORY_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."INVENTORY_PK", current_records."INVENTORY_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."INVENTORY_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."INVENTORY_PK"
                FROM source_data
            ) AS source_records
                ON current_records."INVENTORY_PK" = source_records."INVENTORY_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."INVENTORY_PK", stage."INVENTORY_HASHDIFF", stage."AVAILQTY", stage."SUPPLYCOST", stage."PART_SUPPLY_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."INVENTORY_PK" = stage."INVENTORY_PK"
            WHERE latest_records."INVENTORY_HASHDIFF" != stage."INVENTORY_HASHDIFF"
                OR latest_records."INVENTORY_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:39.445870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:39.482316 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:39.490323 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.490323 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_inventory
16:35:39.590569 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:39.590569 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.595879 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_INVENTORY"
16:35:39.721965 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.13 seconds
16:35:39.723104 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.752328 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.752328 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_inventory"} */
begin;
16:35:39.883392 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:39.883392 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:39.883392 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: insert into DV_PROTOTYPE_DB.DEMO.link_inventory ("INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "SUPPLIER_PK", "PART_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_inventory__dbt_tmp
        );
16:35:40.098734 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.22 seconds
16:35:40.098734 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_inventory"
16:35:40.098734 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: commit;
16:35:40.283704 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
16:35:40.287004 [debug] [Thread-3  ]: finished collecting timing info
16:35:40.287295 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.link_inventory: Close
16:35:40.446056 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFC56D60>]}
16:35:40.446056 [info ] [Thread-3  ]: 29 of 36 OK created incremental model DEMO.link_inventory ...................... [[32mSUCCESS 1[0m in 4.53s]
16:35:40.446056 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.link_inventory
16:35:40.447596 [debug] [Thread-3  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_part_details
16:35:40.448134 [info ] [Thread-3  ]: 33 of 36 START incremental model DEMO.sat_inv_part_details ..................... [RUN]
16:35:40.448576 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:40.449216 [debug] [Thread-3  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_part_details
16:35:40.449384 [debug] [Thread-3  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_part_details
16:35:40.471989 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:40.509621 [debug] [Thread-3  ]: finished collecting timing info
16:35:40.509977 [debug] [Thread-3  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_part_details
16:35:40.514678 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:40.514678 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."PART_NAME", a."PART_MFGR", a."PART_BRAND", a."PART_TYPE", a."PART_SIZE", a."PART_CONTAINER", a."PART_RETAILPRICE", a."PART_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."PART_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."PART_PK", a."PART_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."PART_PK", current_records."PART_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."PART_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_part_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."PART_PK"
                FROM source_data
            ) AS source_records
                ON current_records."PART_PK" = source_records."PART_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."PART_PK", stage."PART_HASHDIFF", stage."PART_NAME", stage."PART_MFGR", stage."PART_BRAND", stage."PART_TYPE", stage."PART_SIZE", stage."PART_CONTAINER", stage."PART_RETAILPRICE", stage."PART_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."PART_PK" = stage."PART_PK"
            WHERE latest_records."PART_HASHDIFF" != stage."PART_HASHDIFF"
                OR latest_records."PART_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:40.514678 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
16:35:43.665073 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.22 seconds
16:35:43.676087 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:43.676087 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
16:35:43.800909 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.12 seconds
16:35:43.800909 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:43.800909 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details
16:35:43.861466 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.1 seconds
16:35:43.861466 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:43.861466 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
16:35:43.909298 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.11 seconds
16:35:43.918876 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:43.918876 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_INVENTORY_DETAILS"
16:35:43.979647 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:43.979647 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:43.979647 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_supplier_nation
16:35:44.019557 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.1 seconds
16:35:44.023315 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:44.024706 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:44.024706 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_inventory_details"} */
begin;
16:35:44.092436 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:44.097673 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:44.097673 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_SUPPLIER_NATION"
16:35:44.157842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:44.157842 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:44.157842 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details ("INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "INVENTORY_PK", "INVENTORY_HASHDIFF", "AVAILQTY", "SUPPLYCOST", "PART_SUPPLY_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_inventory_details__dbt_tmp
        );
16:35:44.189624 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
16:35:44.205724 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:44.210556 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:44.210833 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_supplier_nation"} */
begin;
16:35:44.318933 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.11 seconds
16:35:44.318933 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:44.318933 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: insert into DV_PROTOTYPE_DB.DEMO.link_supplier_nation ("LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "LINK_SUPPLIER_NATION_PK", "SUPPLIER_PK", "NATION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_supplier_nation__dbt_tmp
        );
16:35:44.347009 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.58 seconds
16:35:44.351181 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.351181 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
16:35:44.409105 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.25 seconds
16:35:44.409574 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_inventory_details"
16:35:44.409722 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: commit;
16:35:44.447871 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.1 seconds
16:35:44.447871 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.447871 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table DV_PROTOTYPE_DB.DEMO.link_nation_region
16:35:44.521577 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.2 seconds
16:35:44.521577 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_supplier_nation"
16:35:44.521577 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: commit;
16:35:44.560203 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.11 seconds
16:35:44.560203 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.560203 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."LINK_NATION_REGION"
16:35:44.577365 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:44.577832 [debug] [Thread-1  ]: finished collecting timing info
16:35:44.577832 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_inventory_details: Close
16:35:44.677676 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.12 seconds
16:35:44.677676 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.697148 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.18 seconds
16:35:44.697665 [debug] [Thread-2  ]: finished collecting timing info
16:35:44.698825 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.link_supplier_nation: Close
16:35:44.710407 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.2 seconds
16:35:44.713893 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:44.713893 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
16:35:44.719113 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.719113 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.link_nation_region"} */
begin;
16:35:44.753983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFEA6280>]}
16:35:44.755482 [info ] [Thread-1  ]: 32 of 36 OK created incremental model DEMO.sat_inv_inventory_details ........... [[32mSUCCESS 1[0m in 5.34s]
16:35:44.756909 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_inventory_details
16:35:44.757308 [debug] [Thread-1  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
16:35:44.757817 [info ] [Thread-1  ]: 34 of 36 START incremental model DEMO.sat_inv_supp_nation_details .............. [RUN]
16:35:44.758858 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:44.759358 [debug] [Thread-1  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
16:35:44.759626 [debug] [Thread-1  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
16:35:44.783314 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:44.783314 [debug] [Thread-1  ]: finished collecting timing info
16:35:44.785872 [debug] [Thread-1  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
16:35:44.787149 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:44.787149 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:44.787149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:44.825591 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.11 seconds
16:35:44.831234 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:44.831234 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_part_details
16:35:44.840681 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:44.840681 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:44.840681 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: insert into DV_PROTOTYPE_DB.DEMO.link_nation_region ("NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "NATION_REGION_PK", "NATION_PK", "REGION_PK", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.link_nation_region__dbt_tmp
        );
16:35:44.840681 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFCC7E20>]}
16:35:44.840681 [info ] [Thread-2  ]: 31 of 36 OK created incremental model DEMO.link_supplier_nation ................ [[32mSUCCESS 1[0m in 6.12s]
16:35:44.846992 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.link_supplier_nation
16:35:44.846992 [debug] [Thread-2  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
16:35:44.848679 [info ] [Thread-2  ]: 35 of 36 START incremental model DEMO.sat_inv_supp_region_details .............. [RUN]
16:35:44.849191 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:44.849191 [debug] [Thread-2  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
16:35:44.849191 [debug] [Thread-2  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supp_region_details
16:35:44.864000 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:44.867992 [debug] [Thread-2  ]: finished collecting timing info
16:35:44.867992 [debug] [Thread-2  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
16:35:44.869490 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:44.869490 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."SUPPLIER_NATION_NAME", a."SUPPLIER_NATION_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_NATION_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_NATION_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_NATION_HASHDIFF", stage."SUPPLIER_NATION_NAME", stage."SUPPLIER_NATION_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_NATION_HASHDIFF" != stage."SUPPLIER_NATION_HASHDIFF"
                OR latest_records."SUPPLIER_NATION_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:44.869490 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:44.942184 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.11 seconds
16:35:44.946987 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:44.947428 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_PART_DETAILS"
16:35:45.044650 [debug] [Thread-3  ]: SQL status: SUCCESS 13 in 0.1 seconds
16:35:45.044650 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:45.090199 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.25 seconds
16:35:45.090199 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.link_nation_region"
16:35:45.090700 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: commit;
16:35:45.096807 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:45.096807 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_part_details"} */
begin;
16:35:45.213242 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:45.213242 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:45.213242 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_part_details ("PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "PART_PK", "PART_HASHDIFF", "PART_NAME", "PART_MFGR", "PART_BRAND", "PART_TYPE", "PART_SIZE", "PART_CONTAINER", "PART_RETAILPRICE", "PART_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_part_details__dbt_tmp
        );
16:35:45.260158 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:45.260158 [debug] [Thread-4  ]: finished collecting timing info
16:35:45.260158 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.link_nation_region: Close
16:35:45.432959 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFAA7EE0>]}
16:35:45.434122 [info ] [Thread-4  ]: 30 of 36 OK created incremental model DEMO.link_nation_region .................. [[32mSUCCESS 1[0m in 6.72s]
16:35:45.434915 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.link_nation_region
16:35:45.435164 [debug] [Thread-4  ]: Began running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
16:35:45.435738 [info ] [Thread-4  ]: 36 of 36 START incremental model DEMO.sat_inv_supplier_details ................. [RUN]
16:35:45.436369 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:45.436538 [debug] [Thread-4  ]: Began compiling node model.dbtvault_snowflake_demo.sat_inv_supplier_details
16:35:45.436538 [debug] [Thread-4  ]: Compiling model.dbtvault_snowflake_demo.sat_inv_supplier_details
16:35:45.447829 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.23 seconds
16:35:45.449545 [debug] [Thread-3  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_part_details"
16:35:45.451146 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: commit;
16:35:45.468538 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:45.470601 [debug] [Thread-4  ]: finished collecting timing info
16:35:45.471120 [debug] [Thread-4  ]: Began executing node model.dbtvault_snowflake_demo.sat_inv_supplier_details
16:35:45.471120 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:45.471120 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    

      create or replace temporary table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp  as
      (-- Generated by dbtvault.

WITH source_data AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."SUPPLIER_ADDRESS", a."SUPPLIER_PHONE", a."SUPPLIER_ACCTBAL", a."SUPPLIER_NAME", a."SUPPLIER_COMMENT", a.EFFECTIVE_FROM, a."LOAD_DATE", a."RECORD_SOURCE"
    FROM DV_PROTOTYPE_DB.DEMO.v_stg_inventory AS a
    WHERE a."SUPPLIER_PK" IS NOT NULL
),

latest_records AS (
    SELECT a."SUPPLIER_PK", a."SUPPLIER_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."SUPPLIER_PK", current_records."SUPPLIER_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
                PARTITION BY current_records."SUPPLIER_PK"
                ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details AS current_records
            JOIN (
                SELECT DISTINCT source_data."SUPPLIER_PK"
                FROM source_data
            ) AS source_records
                ON current_records."SUPPLIER_PK" = source_records."SUPPLIER_PK"
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage."SUPPLIER_PK", stage."SUPPLIER_HASHDIFF", stage."SUPPLIER_ADDRESS", stage."SUPPLIER_PHONE", stage."SUPPLIER_ACCTBAL", stage."SUPPLIER_NAME", stage."SUPPLIER_COMMENT", stage.EFFECTIVE_FROM, stage."LOAD_DATE", stage."RECORD_SOURCE"
    FROM source_data AS stage
        LEFT JOIN latest_records
            ON latest_records."SUPPLIER_PK" = stage."SUPPLIER_PK"
            WHERE latest_records."SUPPLIER_HASHDIFF" != stage."SUPPLIER_HASHDIFF"
                OR latest_records."SUPPLIER_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert
      );
16:35:45.479281 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
16:35:45.629616 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:45.629616 [debug] [Thread-3  ]: finished collecting timing info
16:35:45.629616 [debug] [Thread-3  ]: On model.dbtvault_snowflake_demo.sat_inv_part_details: Close
16:35:45.783261 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFECCB80>]}
16:35:45.783261 [info ] [Thread-3  ]: 33 of 36 OK created incremental model DEMO.sat_inv_part_details ................ [[32mSUCCESS 1[0m in 5.33s]
16:35:45.783261 [debug] [Thread-3  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_part_details
16:35:48.044530 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.18 seconds
16:35:48.044530 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.044530 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
16:35:48.136723 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.35 seconds
16:35:48.140861 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.141343 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
16:35:48.155910 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:48.155910 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.155910 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details
16:35:48.253137 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:48.253137 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.253137 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details
16:35:48.273493 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.12 seconds
16:35:48.278786 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.279296 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_REGION_DETAILS"
16:35:48.358420 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:48.368848 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.368848 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPP_NATION_DETAILS"
16:35:48.371667 [debug] [Thread-2  ]: SQL status: SUCCESS 7 in 0.09 seconds
16:35:48.374807 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.409192 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.411285 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"} */
begin;
16:35:48.475820 [debug] [Thread-1  ]: SQL status: SUCCESS 7 in 0.11 seconds
16:35:48.475820 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.482364 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.482444 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"} */
begin;
16:35:48.528331 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:48.528331 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.528331 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_region_details__dbt_tmp
        );
16:35:48.607491 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
16:35:48.607491 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.607491 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details ("SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_NATION_HASHDIFF", "SUPPLIER_NATION_NAME", "SUPPLIER_NATION_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supp_nation_details__dbt_tmp
        );
16:35:48.695631 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.22 seconds
16:35:48.695631 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:48.695631 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
16:35:48.745140 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.22 seconds
16:35:48.745140 [debug] [Thread-2  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_region_details"
16:35:48.745140 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: commit;
16:35:48.791773 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.1 seconds
16:35:48.791773 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:48.807514 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details
16:35:48.846032 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.24 seconds
16:35:48.847126 [debug] [Thread-1  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supp_nation_details"
16:35:48.848125 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: commit;
16:35:48.912702 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.11 seconds
16:35:48.912702 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:48.912702 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */

    describe table "DV_PROTOTYPE_DB"."DEMO"."SAT_INV_SUPPLIER_DETAILS"
16:35:48.912702 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:48.928679 [debug] [Thread-2  ]: finished collecting timing info
16:35:48.928679 [debug] [Thread-2  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_region_details: Close
16:35:49.023154 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
16:35:49.025581 [debug] [Thread-1  ]: finished collecting timing info
16:35:49.025581 [debug] [Thread-1  ]: On model.dbtvault_snowflake_demo.sat_inv_supp_nation_details: Close
16:35:49.035396 [debug] [Thread-4  ]: SQL status: SUCCESS 10 in 0.12 seconds
16:35:49.037994 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:49.040487 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:49.041084 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "dbtvault_snowflake_demo", "target_name": "dev", "node_id": "model.dbtvault_snowflake_demo.sat_inv_supplier_details"} */
begin;
16:35:49.081169 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFE0C070>]}
16:35:49.083753 [info ] [Thread-2  ]: 35 of 36 OK created incremental model DEMO.sat_inv_supp_region_details ......... [[32mSUCCESS 1[0m in 4.23s]
16:35:49.083753 [debug] [Thread-2  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_region_details
16:35:49.163571 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
16:35:49.163571 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:49.163571 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: insert into DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details ("SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE")
        (
            select "SUPPLIER_PK", "SUPPLIER_HASHDIFF", "SUPPLIER_ADDRESS", "SUPPLIER_PHONE", "SUPPLIER_ACCTBAL", "SUPPLIER_NAME", "SUPPLIER_COMMENT", "EFFECTIVE_FROM", "LOAD_DATE", "RECORD_SOURCE"
            from DV_PROTOTYPE_DB.DEMO.sat_inv_supplier_details__dbt_tmp
        );
16:35:49.173048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFBF92E0>]}
16:35:49.173227 [info ] [Thread-1  ]: 34 of 36 OK created incremental model DEMO.sat_inv_supp_nation_details ......... [[32mSUCCESS 1[0m in 4.41s]
16:35:49.174358 [debug] [Thread-1  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supp_nation_details
16:35:49.379910 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.22 seconds
16:35:49.379910 [debug] [Thread-4  ]: Using snowflake connection "model.dbtvault_snowflake_demo.sat_inv_supplier_details"
16:35:49.379910 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: commit;
16:35:49.543007 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
16:35:49.543007 [debug] [Thread-4  ]: finished collecting timing info
16:35:49.543007 [debug] [Thread-4  ]: On model.dbtvault_snowflake_demo.sat_inv_supplier_details: Close
16:35:49.693173 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997188e-f1ea-49ad-8630-f8a4ef211df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFA83250>]}
16:35:49.693173 [info ] [Thread-4  ]: 36 of 36 OK created incremental model DEMO.sat_inv_supplier_details ............ [[32mSUCCESS 1[0m in 4.26s]
16:35:49.693173 [debug] [Thread-4  ]: Finished running node model.dbtvault_snowflake_demo.sat_inv_supplier_details
16:35:49.707155 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:35:49.707155 [info ] [MainThread]: 
16:35:49.707155 [info ] [MainThread]: Finished running 11 view models, 25 incremental models in 40.14s.
16:35:49.707155 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:49.710222 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB' was properly closed.
16:35:49.710222 [debug] [MainThread]: Connection 'list_DV_PROTOTYPE_DB_DEMO' was properly closed.
16:35:49.710527 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_nation_details' was properly closed.
16:35:49.710731 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supp_region_details' was properly closed.
16:35:49.710731 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_part_details' was properly closed.
16:35:49.710731 [debug] [MainThread]: Connection 'model.dbtvault_snowflake_demo.sat_inv_supplier_details' was properly closed.
16:35:49.805774 [info ] [MainThread]: 
16:35:49.805774 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
16:35:49.805774 [info ] [MainThread]: 
16:35:49.809296 [error] [MainThread]: [33mDatabase Error in model customer (models\transform\customer.sql)[0m
16:35:49.810044 [error] [MainThread]:   002003 (42S02): SQL compilation error:
16:35:49.810540 [error] [MainThread]:   Object 'DV_PROTOTYPE_DB.DEMO.CUSTOMERS' does not exist or not authorized.
16:35:49.811344 [error] [MainThread]:   compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\customer.sql
16:35:49.811986 [info ] [MainThread]: 
16:35:49.812405 [error] [MainThread]: [33mDatabase Error in model combined_bookings (models\transform\combined_bookings.sql)[0m
16:35:49.813255 [error] [MainThread]:   001003 (42000): SQL compilation error:
16:35:49.813788 [error] [MainThread]:   syntax error line 14 at position 12 unexpected 'from'.
16:35:49.813788 [error] [MainThread]:   syntax error line 28 at position 12 unexpected 'from'.
16:35:49.813788 [error] [MainThread]:   compiled SQL at target\run\dbtvault_snowflake_demo\models\transform\combined_bookings.sql
16:35:49.813788 [info ] [MainThread]: 
16:35:49.816539 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=2 SKIP=3 TOTAL=36
16:35:49.817220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEE560220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFEFCB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACEFEFC2B0>]}
